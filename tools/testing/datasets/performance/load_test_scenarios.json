{
  "metadata": {
    "name": "性能负载测试数据集",
    "version": "1.0.0",
    "description": "用于压力测试、并发测试和延迟测试的综合性能测试数据集",
    "created_at": "2025-01-21",
    "test_types": ["load", "stress", "spike", "volume", "endurance"],
    "target_components": ["api", "database", "cache", "voice", "rag"]
  },
  "load_test_scenarios": [
    {
      "id": "load_001",
      "name": "API基础负载测试",
      "type": "load",
      "target": "chat_api",
      "duration": "10m",
      "ramp_up": "2m",
      "users": 100,
      "requests_per_second": 50,
      "endpoints": [
        {
          "path": "/api/v1/chat/send",
          "method": "POST",
          "weight": 70,
          "payload": {
            "message": "你好，我想了解产品功能",
            "conversation_id": "{{conversation_id}}",
            "user_id": "{{user_id}}"
          }
        },
        {
          "path": "/api/v1/conversations",
          "method": "POST",
          "weight": 20,
          "payload": {
            "user_id": "{{user_id}}",
            "channel": "web"
          }
        },
        {
          "path": "/api/v1/conversations/{{conversation_id}}/messages",
          "method": "GET",
          "weight": 10
        }
      ],
      "success_criteria": {
        "response_time_p95": "<200ms",
        "error_rate": "<1%",
        "throughput": ">45 RPS"
      }
    },
    {
      "id": "stress_001",
      "name": "API压力测试",
      "type": "stress",
      "target": "chat_api",
      "duration": "15m",
      "ramp_up": "5m",
      "users": 500,
      "requests_per_second": 200,
      "description": "测试系统在高负载下的表现和恢复能力",
      "success_criteria": {
        "response_time_p95": "<500ms",
        "error_rate": "<5%",
        "system_recovery": "within 2m after load reduction"
      }
    },
    {
      "id": "spike_001",
      "name": "流量突增测试",
      "type": "spike",
      "target": "chat_api",
      "duration": "20m",
      "pattern": [
        {"time": "0-5m", "users": 50},
        {"time": "5-7m", "users": 500},
        {"time": "7-15m", "users": 50},
        {"time": "15-17m", "users": 800},
        {"time": "17-20m", "users": 50}
      ],
      "description": "模拟突发流量对系统的冲击",
      "success_criteria": {
        "spike_handling": "no service degradation during spikes",
        "recovery_time": "<30s",
        "error_rate_during_spike": "<10%"
      }
    }
  ],
  "voice_performance_tests": [
    {
      "id": "voice_load_001",
      "name": "语音服务负载测试",
      "type": "load",
      "target": "voice_api",
      "concurrent_sessions": 50,
      "duration": "10m",
      "test_scenarios": [
        {
          "scenario": "asr_only",
          "weight": 40,
          "audio_duration": "5s",
          "audio_format": "wav"
        },
        {
          "scenario": "tts_only",
          "weight": 30,
          "text_length": "50-100 chars"
        },
        {
          "scenario": "full_conversation",
          "weight": 30,
          "turns": 3,
          "avg_turn_duration": "3s"
        }
      ],
      "success_criteria": {
        "asr_latency_p95": "<200ms",
        "tts_latency_p95": "<300ms",
        "concurrent_sessions": ">45",
        "audio_quality": "no degradation"
      }
    }
  ],
  "database_performance_tests": [
    {
      "id": "db_load_001",
      "name": "数据库查询负载测试",
      "type": "load",
      "target": "postgresql",
      "concurrent_connections": 100,
      "duration": "15m",
      "query_mix": [
        {
          "type": "conversation_insert",
          "weight": 20,
          "query": "INSERT INTO conversations (user_id, channel, created_at) VALUES ($1, $2, NOW())"
        },
        {
          "type": "message_insert",
          "weight": 30,
          "query": "INSERT INTO messages (conversation_id, content, sender, created_at) VALUES ($1, $2, $3, NOW())"
        },
        {
          "type": "conversation_history",
          "weight": 40,
          "query": "SELECT * FROM messages WHERE conversation_id = $1 ORDER BY created_at DESC LIMIT 20"
        },
        {
          "type": "user_stats",
          "weight": 10,
          "query": "SELECT COUNT(*) FROM conversations WHERE user_id = $1 AND created_at > NOW() - INTERVAL '30 days'"
        }
      ],
      "success_criteria": {
        "query_time_p95": "<50ms",
        "connection_pool_utilization": "<80%",
        "deadlocks": "0",
        "cpu_usage": "<70%"
      }
    }
  ],
  "cache_performance_tests": [
    {
      "id": "cache_load_001",
      "name": "Redis缓存负载测试",
      "type": "load",
      "target": "redis",
      "concurrent_clients": 200,
      "duration": "10m",
      "operations": [
        {
          "type": "set",
          "weight": 30,
          "key_pattern": "session:{{user_id}}",
          "value_size": "1KB"
        },
        {
          "type": "get",
          "weight": 50,
          "key_pattern": "session:{{user_id}}"
        },
        {
          "type": "expire",
          "weight": 10,
          "key_pattern": "session:{{user_id}}",
          "ttl": 3600
        },
        {
          "type": "delete",
          "weight": 10,
          "key_pattern": "session:{{user_id}}"
        }
      ],
      "success_criteria": {
        "response_time_p95": "<5ms",
        "throughput": ">10000 ops/sec",
        "memory_usage": "<80%",
        "hit_rate": ">90%"
      }
    }
  ],
  "rag_performance_tests": [
    {
      "id": "rag_load_001",
      "name": "RAG检索负载测试",
      "type": "load",
      "target": "rag_service",
      "concurrent_queries": 50,
      "duration": "10m",
      "query_types": [
        {
          "type": "simple_factual",
          "weight": 40,
          "example": "产品支持哪些语言？"
        },
        {
          "type": "complex_analytical",
          "weight": 30,
          "example": "比较不同版本的功能差异"
        },
        {
          "type": "multi_document",
          "weight": 20,
          "example": "整合多个文档的信息回答问题"
        },
        {
          "type": "edge_case",
          "weight": 10,
          "example": "处理模糊或不完整的查询"
        }
      ],
      "success_criteria": {
        "retrieval_time_p95": "<100ms",
        "generation_time_p95": "<2s",
        "relevance_score": ">0.8",
        "concurrent_capacity": ">45"
      }
    }
  ],
  "endurance_tests": [
    {
      "id": "endurance_001",
      "name": "24小时稳定性测试",
      "type": "endurance",
      "target": "full_system",
      "duration": "24h",
      "load_pattern": "constant",
      "users": 100,
      "requests_per_second": 20,
      "monitoring_intervals": "5m",
      "success_criteria": {
        "uptime": ">99.9%",
        "memory_leak": "no significant increase",
        "response_time_degradation": "<10%",
        "error_rate": "<0.5%"
      }
    }
  ],
  "data_generators": {
    "user_data": {
      "total_users": 10000,
      "user_id_pattern": "user_{{random_int(1,10000)}}",
      "user_types": ["free", "premium", "enterprise"],
      "distribution": [70, 25, 5]
    },
    "conversation_data": {
      "conversation_id_pattern": "conv_{{uuid}}",
      "message_templates": [
        "你好，我想了解{{product_feature}}",
        "请问{{question_type}}？",
        "我遇到了{{problem_type}}问题",
        "能帮我{{action_type}}吗？"
      ],
      "variables": {
        "product_feature": ["语音功能", "API集成", "数据分析", "安全性"],
        "question_type": ["价格", "功能", "技术支持", "集成方式"],
        "problem_type": ["登录", "性能", "配置", "权限"],
        "action_type": ["设置账户", "导出数据", "重置密码", "升级版本"]
      }
    },
    "audio_data": {
      "sample_files": [
        "test_audio_1.wav",
        "test_audio_2.wav",
        "test_audio_3.wav"
      ],
      "durations": ["2s", "5s", "10s"],
      "quality_levels": ["16kHz_16bit", "44kHz_16bit", "48kHz_24bit"]
    }
  },
  "monitoring_metrics": {
    "system_metrics": [
      "cpu_usage_percent",
      "memory_usage_percent",
      "disk_io_ops_per_sec",
      "network_bytes_per_sec"
    ],
    "application_metrics": [
      "response_time_ms",
      "requests_per_second",
      "error_rate_percent",
      "active_connections"
    ],
    "business_metrics": [
      "successful_conversations",
      "user_satisfaction_score",
      "feature_usage_rate",
      "conversion_rate"
    ]
  },
  "alert_thresholds": {
    "critical": {
      "response_time_p95": ">1000ms",
      "error_rate": ">5%",
      "cpu_usage": ">90%",
      "memory_usage": ">95%"
    },
    "warning": {
      "response_time_p95": ">500ms",
      "error_rate": ">2%",
      "cpu_usage": ">80%",
      "memory_usage": ">85%"
    }
  },
  "test_execution_protocol": {
    "pre_test": [
      "1. 验证系统健康状态",
      "2. 清理测试数据",
      "3. 重启相关服务",
      "4. 预热系统缓存",
      "5. 设置监控和告警"
    ],
    "during_test": [
      "1. 实时监控关键指标",
      "2. 记录异常和错误",
      "3. 调整负载如需要",
      "4. 收集性能数据",
      "5. 截图系统状态"
    ],
    "post_test": [
      "1. 等待系统恢复",
      "2. 收集所有日志",
      "3. 分析性能数据",
      "4. 生成测试报告",
      "5. 清理测试数据"
    ]
  }
}
