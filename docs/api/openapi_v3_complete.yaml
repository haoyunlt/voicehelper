openapi: 3.0.3
info:
  title: VoiceHelper AI æ™ºèƒ½å®¢æœç³»ç»Ÿ API
  description: |
    VoiceHelper AI æ˜¯ä¸€ä¸ªä¼ä¸šçº§æ™ºèƒ½å®¢æœç³»ç»Ÿï¼Œæä¾›å¤šæ¨¡æ€å¯¹è¯ã€è¯­éŸ³äº¤äº’ã€çŸ¥è¯†æ£€ç´¢ç­‰åŠŸèƒ½ã€‚
    
    ## æ ¸å¿ƒç‰¹æ€§
    - ğŸ¤ **è¯­éŸ³äº¤äº’**: 150msè¶…ä½å»¶è¿Ÿè¯­éŸ³å¤„ç†
    - ğŸ§  **æ™ºèƒ½å¯¹è¯**: GraphRAG + Agentæ¶æ„
    - ğŸ”— **æœåŠ¡é›†æˆ**: 500+ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆ
    - ğŸ“± **å¤šå¹³å°**: Web/ç§»åŠ¨ç«¯/æ¡Œé¢ç«¯å…¨è¦†ç›–
    - ğŸ”’ **ä¼ä¸šå®‰å…¨**: ç«¯åˆ°ç«¯åŠ å¯†ï¼Œåˆè§„è®¤è¯
    
    ## è®¤è¯æ–¹å¼
    æ”¯æŒå¤šç§è®¤è¯æ–¹å¼ï¼š
    - API Key è®¤è¯ (æ¨è)
    - OAuth 2.0
    - JWT Token
    
    ## é€Ÿç‡é™åˆ¶
    - å…è´¹ç‰ˆ: 100 requests/hour
    - ä¸“ä¸šç‰ˆ: 1000 requests/hour  
    - ä¼ä¸šç‰ˆ: 10000 requests/hour
    
  version: 1.9.0
  contact:
    name: VoiceHelper API Support
    url: https://voicehelper.ai/support
    email: api-support@voicehelper.ai
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: https://voicehelper.ai/terms

servers:
  - url: https://api.voicehelper.ai/v1
    description: ç”Ÿäº§ç¯å¢ƒ
  - url: https://api-staging.voicehelper.ai/v1
    description: æµ‹è¯•ç¯å¢ƒ
  - url: http://localhost:8080/v1
    description: æœ¬åœ°å¼€å‘ç¯å¢ƒ

security:
  - ApiKeyAuth: []
  - OAuth2: [read, write]
  - BearerAuth: []

paths:
  # ==================== å¯¹è¯æ¥å£ ====================
  /chat/completions:
    post:
      tags:
        - Chat
      summary: åˆ›å»ºå¯¹è¯å®Œæˆ
      description: å‘é€æ¶ˆæ¯å¹¶è·å¾—AIå›å¤ï¼Œæ”¯æŒæµå¼å’Œéæµå¼å“åº”
      operationId: createChatCompletion
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChatCompletionRequest'
            examples:
              simple_chat:
                summary: ç®€å•å¯¹è¯
                value:
                  messages:
                    - role: user
                      content: ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ çš„åŠŸèƒ½
                  model: gpt-4
                  temperature: 0.7
              multimodal_chat:
                summary: å¤šæ¨¡æ€å¯¹è¯
                value:
                  messages:
                    - role: user
                      content: 
                        - type: text
                          text: è¿™å¼ å›¾ç‰‡é‡Œæœ‰ä»€ä¹ˆï¼Ÿ
                        - type: image_url
                          image_url:
                            url: https://example.com/image.jpg
                  model: gpt-4-vision
      responses:
        '200':
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatCompletionResponse'
            text/event-stream:
              schema:
                $ref: '#/components/schemas/ChatCompletionStreamResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/RateLimited'

  /chat/conversations:
    get:
      tags:
        - Chat
      summary: è·å–å¯¹è¯åˆ—è¡¨
      description: è·å–ç”¨æˆ·çš„å¯¹è¯å†å²åˆ—è¡¨
      operationId: listConversations
      parameters:
        - name: limit
          in: query
          description: è¿”å›æ•°é‡é™åˆ¶
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: offset
          in: query
          description: åç§»é‡
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: status
          in: query
          description: å¯¹è¯çŠ¶æ€è¿‡æ»¤
          schema:
            type: string
            enum: [active, archived, deleted]
      responses:
        '200':
          description: å¯¹è¯åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConversationList'

    post:
      tags:
        - Chat
      summary: åˆ›å»ºæ–°å¯¹è¯
      description: åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è¯ä¼šè¯
      operationId: createConversation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateConversationRequest'
      responses:
        '201':
          description: å¯¹è¯åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'

  /chat/conversations/{conversationId}:
    get:
      tags:
        - Chat
      summary: è·å–å¯¹è¯è¯¦æƒ…
      description: è·å–æŒ‡å®šå¯¹è¯çš„è¯¦ç»†ä¿¡æ¯å’Œæ¶ˆæ¯å†å²
      operationId: getConversation
      parameters:
        - $ref: '#/components/parameters/ConversationId'
      responses:
        '200':
          description: å¯¹è¯è¯¦æƒ…
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConversationDetail'
        '404':
          $ref: '#/components/responses/NotFound'

    delete:
      tags:
        - Chat
      summary: åˆ é™¤å¯¹è¯
      description: åˆ é™¤æŒ‡å®šçš„å¯¹è¯
      operationId: deleteConversation
      parameters:
        - $ref: '#/components/parameters/ConversationId'
      responses:
        '204':
          description: åˆ é™¤æˆåŠŸ
        '404':
          $ref: '#/components/responses/NotFound'

  # ==================== è¯­éŸ³æ¥å£ ====================
  /voice/transcribe:
    post:
      tags:
        - Voice
      summary: è¯­éŸ³è½¬æ–‡å­—
      description: å°†éŸ³é¢‘æ–‡ä»¶è½¬æ¢ä¸ºæ–‡å­—
      operationId: transcribeAudio
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: éŸ³é¢‘æ–‡ä»¶ (æ”¯æŒ mp3, wav, m4a, ogg)
                model:
                  type: string
                  enum: [whisper-1, funasr-zh, funasr-en]
                  default: whisper-1
                language:
                  type: string
                  description: è¯­è¨€ä»£ç  (å¦‚ zh, en, ja)
                response_format:
                  type: string
                  enum: [json, text, srt, verbose_json]
                  default: json
              required:
                - file
      responses:
        '200':
          description: è½¬å½•æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TranscriptionResponse'

  /voice/synthesize:
    post:
      tags:
        - Voice
      summary: æ–‡å­—è½¬è¯­éŸ³
      description: å°†æ–‡å­—è½¬æ¢ä¸ºè¯­éŸ³
      operationId: synthesizeText
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SynthesisRequest'
      responses:
        '200':
          description: åˆæˆæˆåŠŸ
          content:
            audio/mpeg:
              schema:
                type: string
                format: binary
            audio/wav:
              schema:
                type: string
                format: binary

  /voice/realtime:
    get:
      tags:
        - Voice
      summary: å®æ—¶è¯­éŸ³å¯¹è¯
      description: å»ºç«‹WebSocketè¿æ¥è¿›è¡Œå®æ—¶è¯­éŸ³å¯¹è¯
      operationId: realtimeVoiceChat
      parameters:
        - name: model
          in: query
          description: ä½¿ç”¨çš„æ¨¡å‹
          schema:
            type: string
            default: gpt-4-voice
        - name: voice
          in: query
          description: è¯­éŸ³ç±»å‹
          schema:
            type: string
            enum: [alloy, echo, fable, onyx, nova, shimmer]
            default: alloy
      responses:
        '101':
          description: WebSocketè¿æ¥å»ºç«‹
        '400':
          $ref: '#/components/responses/BadRequest'

  # ==================== çŸ¥è¯†åº“æ¥å£ ====================
  /knowledge/datasets:
    get:
      tags:
        - Knowledge
      summary: è·å–æ•°æ®é›†åˆ—è¡¨
      description: è·å–ç”¨æˆ·çš„çŸ¥è¯†åº“æ•°æ®é›†åˆ—è¡¨
      operationId: listDatasets
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        '200':
          description: æ•°æ®é›†åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DatasetList'

    post:
      tags:
        - Knowledge
      summary: åˆ›å»ºæ•°æ®é›†
      description: åˆ›å»ºæ–°çš„çŸ¥è¯†åº“æ•°æ®é›†
      operationId: createDataset
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDatasetRequest'
      responses:
        '201':
          description: æ•°æ®é›†åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Dataset'

  /knowledge/datasets/{datasetId}/documents:
    post:
      tags:
        - Knowledge
      summary: ä¸Šä¼ æ–‡æ¡£
      description: å‘æ•°æ®é›†ä¸Šä¼ æ–‡æ¡£
      operationId: uploadDocument
      parameters:
        - $ref: '#/components/parameters/DatasetId'
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                metadata:
                  type: object
                  additionalProperties: true
      responses:
        '201':
          description: æ–‡æ¡£ä¸Šä¼ æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Document'

  /knowledge/search:
    post:
      tags:
        - Knowledge
      summary: çŸ¥è¯†æ£€ç´¢
      description: åœ¨çŸ¥è¯†åº“ä¸­æœç´¢ç›¸å…³å†…å®¹
      operationId: searchKnowledge
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SearchRequest'
      responses:
        '200':
          description: æœç´¢ç»“æœ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResponse'

  # ==================== æœåŠ¡é›†æˆæ¥å£ ====================
  /integrations/services:
    get:
      tags:
        - Integrations
      summary: è·å–å¯ç”¨æœåŠ¡åˆ—è¡¨
      description: è·å–æ‰€æœ‰å¯é›†æˆçš„ç¬¬ä¸‰æ–¹æœåŠ¡åˆ—è¡¨
      operationId: listAvailableServices
      parameters:
        - name: category
          in: query
          description: æœåŠ¡åˆ†ç±»è¿‡æ»¤
          schema:
            type: string
            enum: [office_suite, development, social_platform, ecommerce, cloud_service, ai_ml]
        - name: status
          in: query
          description: æœåŠ¡çŠ¶æ€è¿‡æ»¤
          schema:
            type: string
            enum: [active, beta, deprecated]
      responses:
        '200':
          description: æœåŠ¡åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceList'

  /integrations/connections:
    get:
      tags:
        - Integrations
      summary: è·å–å·²è¿æ¥æœåŠ¡
      description: è·å–ç”¨æˆ·å·²è¿æ¥çš„æœåŠ¡åˆ—è¡¨
      operationId: listConnections
      responses:
        '200':
          description: è¿æ¥åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConnectionList'

    post:
      tags:
        - Integrations
      summary: åˆ›å»ºæœåŠ¡è¿æ¥
      description: è¿æ¥åˆ°ç¬¬ä¸‰æ–¹æœåŠ¡
      operationId: createConnection
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateConnectionRequest'
      responses:
        '201':
          description: è¿æ¥åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Connection'

  /integrations/connections/{connectionId}/execute:
    post:
      tags:
        - Integrations
      summary: æ‰§è¡ŒæœåŠ¡æ“ä½œ
      description: é€šè¿‡è¿æ¥æ‰§è¡Œç¬¬ä¸‰æ–¹æœåŠ¡æ“ä½œ
      operationId: executeServiceOperation
      parameters:
        - $ref: '#/components/parameters/ConnectionId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExecuteOperationRequest'
      responses:
        '200':
          description: æ“ä½œæ‰§è¡ŒæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OperationResponse'

  # ==================== ç”¨æˆ·ç®¡ç†æ¥å£ ====================
  /users/profile:
    get:
      tags:
        - Users
      summary: è·å–ç”¨æˆ·èµ„æ–™
      description: è·å–å½“å‰ç”¨æˆ·çš„èµ„æ–™ä¿¡æ¯
      operationId: getUserProfile
      responses:
        '200':
          description: ç”¨æˆ·èµ„æ–™
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfile'

    put:
      tags:
        - Users
      summary: æ›´æ–°ç”¨æˆ·èµ„æ–™
      description: æ›´æ–°ç”¨æˆ·èµ„æ–™ä¿¡æ¯
      operationId: updateUserProfile
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserProfileRequest'
      responses:
        '200':
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfile'

  /users/usage:
    get:
      tags:
        - Users
      summary: è·å–ä½¿ç”¨ç»Ÿè®¡
      description: è·å–ç”¨æˆ·çš„APIä½¿ç”¨ç»Ÿè®¡
      operationId: getUserUsage
      parameters:
        - name: start_date
          in: query
          description: å¼€å§‹æ—¥æœŸ
          schema:
            type: string
            format: date
        - name: end_date
          in: query
          description: ç»“æŸæ—¥æœŸ
          schema:
            type: string
            format: date
      responses:
        '200':
          description: ä½¿ç”¨ç»Ÿè®¡
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UsageStats'

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: APIå¯†é’¥è®¤è¯
    
    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://auth.voicehelper.ai/oauth/authorize
          tokenUrl: https://auth.voicehelper.ai/oauth/token
          scopes:
            read: è¯»å–æƒé™
            write: å†™å…¥æƒé™
            admin: ç®¡ç†æƒé™
    
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  parameters:
    ConversationId:
      name: conversationId
      in: path
      required: true
      description: å¯¹è¯ID
      schema:
        type: string
        format: uuid
    
    DatasetId:
      name: datasetId
      in: path
      required: true
      description: æ•°æ®é›†ID
      schema:
        type: string
        format: uuid
    
    ConnectionId:
      name: connectionId
      in: path
      required: true
      description: è¿æ¥ID
      schema:
        type: string
        format: uuid

  schemas:
    # ==================== å¯¹è¯ç›¸å…³ ====================
    ChatCompletionRequest:
      type: object
      required:
        - messages
      properties:
        messages:
          type: array
          items:
            $ref: '#/components/schemas/Message'
          description: å¯¹è¯æ¶ˆæ¯åˆ—è¡¨
        model:
          type: string
          enum: [gpt-4, gpt-4-turbo, gpt-3.5-turbo, claude-3, ernie-4.0]
          default: gpt-4
          description: ä½¿ç”¨çš„æ¨¡å‹
        temperature:
          type: number
          minimum: 0
          maximum: 2
          default: 0.7
          description: éšæœºæ€§æ§åˆ¶
        max_tokens:
          type: integer
          minimum: 1
          maximum: 4096
          description: æœ€å¤§ç”Ÿæˆtokenæ•°
        stream:
          type: boolean
          default: false
          description: æ˜¯å¦æµå¼è¿”å›
        tools:
          type: array
          items:
            $ref: '#/components/schemas/Tool'
          description: å¯ç”¨å·¥å…·åˆ—è¡¨
        tool_choice:
          oneOf:
            - type: string
              enum: [none, auto]
            - $ref: '#/components/schemas/ToolChoice'
          description: å·¥å…·é€‰æ‹©ç­–ç•¥

    Message:
      type: object
      required:
        - role
        - content
      properties:
        role:
          type: string
          enum: [system, user, assistant, tool]
          description: æ¶ˆæ¯è§’è‰²
        content:
          oneOf:
            - type: string
            - type: array
              items:
                $ref: '#/components/schemas/ContentPart'
          description: æ¶ˆæ¯å†…å®¹
        name:
          type: string
          description: æ¶ˆæ¯å‘é€è€…åç§°
        tool_calls:
          type: array
          items:
            $ref: '#/components/schemas/ToolCall'
          description: å·¥å…·è°ƒç”¨åˆ—è¡¨
        tool_call_id:
          type: string
          description: å·¥å…·è°ƒç”¨ID

    ContentPart:
      oneOf:
        - $ref: '#/components/schemas/TextContent'
        - $ref: '#/components/schemas/ImageContent'
        - $ref: '#/components/schemas/AudioContent'

    TextContent:
      type: object
      required:
        - type
        - text
      properties:
        type:
          type: string
          enum: [text]
        text:
          type: string

    ImageContent:
      type: object
      required:
        - type
        - image_url
      properties:
        type:
          type: string
          enum: [image_url]
        image_url:
          type: object
          required:
            - url
          properties:
            url:
              type: string
              format: uri
            detail:
              type: string
              enum: [low, high, auto]
              default: auto

    AudioContent:
      type: object
      required:
        - type
        - audio_url
      properties:
        type:
          type: string
          enum: [audio_url]
        audio_url:
          type: object
          required:
            - url
          properties:
            url:
              type: string
              format: uri
            format:
              type: string
              enum: [mp3, wav, ogg, m4a]

    ChatCompletionResponse:
      type: object
      required:
        - id
        - object
        - created
        - model
        - choices
      properties:
        id:
          type: string
          description: å“åº”ID
        object:
          type: string
          enum: [chat.completion]
        created:
          type: integer
          description: åˆ›å»ºæ—¶é—´æˆ³
        model:
          type: string
          description: ä½¿ç”¨çš„æ¨¡å‹
        choices:
          type: array
          items:
            $ref: '#/components/schemas/Choice'
        usage:
          $ref: '#/components/schemas/Usage'

    Choice:
      type: object
      required:
        - index
        - message
        - finish_reason
      properties:
        index:
          type: integer
        message:
          $ref: '#/components/schemas/Message'
        finish_reason:
          type: string
          enum: [stop, length, tool_calls, content_filter]

    Usage:
      type: object
      required:
        - prompt_tokens
        - completion_tokens
        - total_tokens
      properties:
        prompt_tokens:
          type: integer
        completion_tokens:
          type: integer
        total_tokens:
          type: integer

    # ==================== è¯­éŸ³ç›¸å…³ ====================
    TranscriptionResponse:
      type: object
      required:
        - text
      properties:
        text:
          type: string
          description: è½¬å½•æ–‡æœ¬
        language:
          type: string
          description: æ£€æµ‹åˆ°çš„è¯­è¨€
        duration:
          type: number
          description: éŸ³é¢‘æ—¶é•¿(ç§’)
        segments:
          type: array
          items:
            $ref: '#/components/schemas/TranscriptionSegment'

    TranscriptionSegment:
      type: object
      properties:
        id:
          type: integer
        start:
          type: number
        end:
          type: number
        text:
          type: string
        confidence:
          type: number

    SynthesisRequest:
      type: object
      required:
        - text
      properties:
        text:
          type: string
          maxLength: 4096
          description: è¦åˆæˆçš„æ–‡æœ¬
        voice:
          type: string
          enum: [alloy, echo, fable, onyx, nova, shimmer, zh-female-1, zh-male-1]
          default: alloy
          description: è¯­éŸ³ç±»å‹
        response_format:
          type: string
          enum: [mp3, opus, aac, flac, wav, pcm]
          default: mp3
          description: éŸ³é¢‘æ ¼å¼
        speed:
          type: number
          minimum: 0.25
          maximum: 4.0
          default: 1.0
          description: è¯­é€Ÿ
        emotion:
          type: string
          enum: [neutral, happy, sad, angry, excited, calm]
          default: neutral
          description: æƒ…æ„Ÿç±»å‹

    # ==================== å·¥å…·ç›¸å…³ ====================
    Tool:
      type: object
      required:
        - type
        - function
      properties:
        type:
          type: string
          enum: [function]
        function:
          $ref: '#/components/schemas/Function'

    Function:
      type: object
      required:
        - name
        - description
        - parameters
      properties:
        name:
          type: string
          description: å‡½æ•°åç§°
        description:
          type: string
          description: å‡½æ•°æè¿°
        parameters:
          type: object
          description: å‡½æ•°å‚æ•°JSON Schema

    ToolCall:
      type: object
      required:
        - id
        - type
        - function
      properties:
        id:
          type: string
        type:
          type: string
          enum: [function]
        function:
          type: object
          required:
            - name
            - arguments
          properties:
            name:
              type: string
            arguments:
              type: string

    ToolChoice:
      type: object
      required:
        - type
        - function
      properties:
        type:
          type: string
          enum: [function]
        function:
          type: object
          required:
            - name
          properties:
            name:
              type: string

    # ==================== å…¶ä»–æ¨¡å‹ ====================
    Error:
      type: object
      required:
        - error
      properties:
        error:
          type: object
          required:
            - message
            - type
            - code
          properties:
            message:
              type: string
              description: é”™è¯¯æ¶ˆæ¯
            type:
              type: string
              description: é”™è¯¯ç±»å‹
            code:
              type: string
              description: é”™è¯¯ä»£ç 
            param:
              type: string
              description: ç›¸å…³å‚æ•°

    # å…¶ä»–å¿…è¦çš„schemaå®šä¹‰...
    Conversation:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        status:
          type: string
          enum: [active, archived, deleted]

    ConversationList:
      type: object
      properties:
        conversations:
          type: array
          items:
            $ref: '#/components/schemas/Conversation'
        total:
          type: integer
        has_more:
          type: boolean

    CreateConversationRequest:
      type: object
      properties:
        title:
          type: string
        initial_message:
          type: string

    ConversationDetail:
      allOf:
        - $ref: '#/components/schemas/Conversation'
        - type: object
          properties:
            messages:
              type: array
              items:
                $ref: '#/components/schemas/Message'

    Dataset:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        created_at:
          type: string
          format: date-time
        document_count:
          type: integer

    DatasetList:
      type: object
      properties:
        datasets:
          type: array
          items:
            $ref: '#/components/schemas/Dataset'
        total:
          type: integer

    CreateDatasetRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        description:
          type: string

    Document:
      type: object
      properties:
        id:
          type: string
          format: uuid
        filename:
          type: string
        content_type:
          type: string
        size:
          type: integer
        uploaded_at:
          type: string
          format: date-time

    SearchRequest:
      type: object
      required:
        - query
      properties:
        query:
          type: string
        datasets:
          type: array
          items:
            type: string
            format: uuid
        limit:
          type: integer
          default: 10

    SearchResponse:
      type: object
      properties:
        results:
          type: array
          items:
            type: object
            properties:
              content:
                type: string
              score:
                type: number
              metadata:
                type: object

    ServiceList:
      type: object
      properties:
        services:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
              category:
                type: string
              description:
                type: string
              status:
                type: string

    ConnectionList:
      type: object
      properties:
        connections:
          type: array
          items:
            $ref: '#/components/schemas/Connection'

    Connection:
      type: object
      properties:
        id:
          type: string
          format: uuid
        service_id:
          type: string
        name:
          type: string
        status:
          type: string
          enum: [active, inactive, error]
        created_at:
          type: string
          format: date-time

    CreateConnectionRequest:
      type: object
      required:
        - service_id
        - config
      properties:
        service_id:
          type: string
        name:
          type: string
        config:
          type: object

    ExecuteOperationRequest:
      type: object
      required:
        - operation
      properties:
        operation:
          type: string
        parameters:
          type: object

    OperationResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object
        error:
          type: string

    UserProfile:
      type: object
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
          format: email
        name:
          type: string
        avatar_url:
          type: string
          format: uri
        plan:
          type: string
          enum: [free, pro, enterprise]
        created_at:
          type: string
          format: date-time

    UpdateUserProfileRequest:
      type: object
      properties:
        name:
          type: string
        avatar_url:
          type: string
          format: uri

    UsageStats:
      type: object
      properties:
        period:
          type: object
          properties:
            start:
              type: string
              format: date
            end:
              type: string
              format: date
        requests:
          type: object
          properties:
            total:
              type: integer
            by_endpoint:
              type: object
              additionalProperties:
                type: integer
        tokens:
          type: object
          properties:
            input:
              type: integer
            output:
              type: integer
            total:
              type: integer

    ChatCompletionStreamResponse:
      type: object
      properties:
        id:
          type: string
        object:
          type: string
          enum: [chat.completion.chunk]
        created:
          type: integer
        model:
          type: string
        choices:
          type: array
          items:
            type: object
            properties:
              index:
                type: integer
              delta:
                type: object
                properties:
                  role:
                    type: string
                  content:
                    type: string
                  tool_calls:
                    type: array
                    items:
                      $ref: '#/components/schemas/ToolCall'
              finish_reason:
                type: string
                enum: [stop, length, tool_calls, content_filter]

  responses:
    BadRequest:
      description: è¯·æ±‚å‚æ•°é”™è¯¯
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              message: "Invalid request parameters"
              type: "invalid_request_error"
              code: "invalid_parameter"

    Unauthorized:
      description: è®¤è¯å¤±è´¥
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              message: "Invalid API key"
              type: "authentication_error"
              code: "invalid_api_key"

    NotFound:
      description: èµ„æºä¸å­˜åœ¨
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              message: "Resource not found"
              type: "not_found_error"
              code: "resource_not_found"

    RateLimited:
      description: è¯·æ±‚é¢‘ç‡è¶…é™
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              message: "Rate limit exceeded"
              type: "rate_limit_error"
              code: "rate_limit_exceeded"
      headers:
        X-RateLimit-Limit:
          schema:
            type: integer
          description: é€Ÿç‡é™åˆ¶
        X-RateLimit-Remaining:
          schema:
            type: integer
          description: å‰©ä½™è¯·æ±‚æ•°
        X-RateLimit-Reset:
          schema:
            type: integer
          description: é‡ç½®æ—¶é—´æˆ³

tags:
  - name: Chat
    description: å¯¹è¯ç›¸å…³æ¥å£
  - name: Voice
    description: è¯­éŸ³å¤„ç†æ¥å£
  - name: Knowledge
    description: çŸ¥è¯†åº“ç®¡ç†æ¥å£
  - name: Integrations
    description: ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆæ¥å£
  - name: Users
    description: ç”¨æˆ·ç®¡ç†æ¥å£

externalDocs:
  description: å®Œæ•´å¼€å‘æ–‡æ¡£
  url: https://docs.voicehelper.ai
