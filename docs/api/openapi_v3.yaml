openapi: 3.0.3
info:
  title: æ™ºèƒ½èŠå¤©æœºå™¨äººç³»ç»Ÿ API
  description: |
    v1.9.0 å¼€å‘è€…å¹³å°API - æ”¯æŒå¤šæ¨¡æ€äº¤äº’ã€è¯­éŸ³å¤„ç†ã€å›¾åƒç†è§£ç­‰åŠŸèƒ½
    
    ## æ ¸å¿ƒç‰¹æ€§
    - ğŸ¯ **å¤šæ¨¡æ€äº¤äº’**: æ”¯æŒæ–‡æœ¬ã€è¯­éŸ³ã€å›¾åƒã€è§†é¢‘ã€ç»“æ„åŒ–æ•°æ®
    - ğŸš€ **è¶…ä½å»¶è¿Ÿ**: è¯­éŸ³å¤„ç†150mså†…å“åº”
    - ğŸ§  **æ™ºèƒ½ç†è§£**: 95%å›¾åƒè¯†åˆ«å‡†ç¡®ç‡ï¼Œ92%å¤šæ¨¡æ€èåˆå‡†ç¡®ç‡
    - ğŸ”§ **500+æœåŠ¡é›†æˆ**: åŠå…¬å¥—ä»¶ã€å¼€å‘å·¥å…·ã€ç¤¾äº¤å¹³å°ç­‰
    - ğŸ›¡ï¸ **ä¼ä¸šçº§å®‰å…¨**: é›¶ä¿¡ä»»æ¶æ„ï¼Œç«¯åˆ°ç«¯åŠ å¯†
    
    ## è®¤è¯æ–¹å¼
    æ”¯æŒå¤šç§è®¤è¯æ–¹å¼ï¼š
    - API Keyè®¤è¯ (æ¨è)
    - OAuth 2.0
    - JWT Token
    
  version: 1.9.0
  contact:
    name: API Support
    email: api-support@voicehelper.com
    url: https://docs.voicehelper.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://api.voicehelper.com/v1
    description: ç”Ÿäº§ç¯å¢ƒ
  - url: https://api-staging.voicehelper.com/v1
    description: æµ‹è¯•ç¯å¢ƒ
  - url: http://localhost:8080/v1
    description: æœ¬åœ°å¼€å‘ç¯å¢ƒ

security:
  - ApiKeyAuth: []
  - OAuth2: [read, write]
  - BearerAuth: []

paths:
  # ==================== èŠå¤©å¯¹è¯ API ====================
  /chat/completions:
    post:
      tags:
        - Chat
      summary: åˆ›å»ºèŠå¤©å®Œæˆ
      description: |
        å‘é€æ¶ˆæ¯å¹¶è·å–AIå›å¤ï¼Œæ”¯æŒå¤šæ¨¡æ€è¾“å…¥å’Œæµå¼å“åº”
        
        ### æ”¯æŒçš„æ¨¡æ€
        - æ–‡æœ¬æ¶ˆæ¯
        - å›¾åƒåˆ†æ
        - è¯­éŸ³è¾“å…¥
        - æ–‡ä»¶ä¸Šä¼ 
        
      operationId: createChatCompletion
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChatCompletionRequest'
            examples:
              text_only:
                summary: çº¯æ–‡æœ¬å¯¹è¯
                value:
                  messages:
                    - role: user
                      content: "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ çš„åŠŸèƒ½"
                  model: "gpt-4-turbo"
                  stream: false
              multimodal:
                summary: å¤šæ¨¡æ€è¾“å…¥
                value:
                  messages:
                    - role: user
                      content: "åˆ†æè¿™å¼ å›¾ç‰‡"
                      attachments:
                        - type: image
                          url: "https://example.com/image.jpg"
                  model: "gpt-4-vision"
                  multimodal_config:
                    enable_vision: true
                    enable_emotion_detection: true
      responses:
        '200':
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatCompletionResponse'
            text/event-stream:
              schema:
                $ref: '#/components/schemas/ChatCompletionStreamResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'

  /chat/conversations:
    get:
      tags:
        - Chat
      summary: è·å–å¯¹è¯åˆ—è¡¨
      description: è·å–ç”¨æˆ·çš„å¯¹è¯å†å²åˆ—è¡¨
      operationId: getConversations
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
            maximum: 100
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
        - name: filter
          in: query
          schema:
            type: string
            enum: [all, active, archived]
            default: all
      responses:
        '200':
          description: å¯¹è¯åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConversationList'

  /chat/conversations/{conversationId}:
    get:
      tags:
        - Chat
      summary: è·å–å¯¹è¯è¯¦æƒ…
      operationId: getConversation
      parameters:
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: å¯¹è¯è¯¦æƒ…
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '404':
          $ref: '#/components/responses/NotFound'

  # ==================== è¯­éŸ³å¤„ç† API ====================
  /voice/synthesize:
    post:
      tags:
        - Voice
      summary: è¯­éŸ³åˆæˆ
      description: |
        å°†æ–‡æœ¬è½¬æ¢ä¸ºè¯­éŸ³ï¼Œæ”¯æŒæƒ…æ„ŸåŒ–TTSå’Œå¤šç§è¯­éŸ³é£æ ¼
        
        ### v1.8.0 å¢å¼ºåŠŸèƒ½
        - 150msè¶…ä½å»¶è¿Ÿ
        - 6ç§æƒ…æ„Ÿè¡¨è¾¾
        - å¤šè¯­è¨€æ”¯æŒ
        - æµå¼åˆæˆ
        
      operationId: synthesizeVoice
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VoiceSynthesisRequest'
      responses:
        '200':
          description: åˆæˆæˆåŠŸ
          content:
            audio/wav:
              schema:
                type: string
                format: binary
            application/json:
              schema:
                $ref: '#/components/schemas/VoiceSynthesisResponse'

  /voice/recognize:
    post:
      tags:
        - Voice
      summary: è¯­éŸ³è¯†åˆ«
      description: |
        å°†è¯­éŸ³è½¬æ¢ä¸ºæ–‡æœ¬ï¼Œæ”¯æŒå®æ—¶æµå¼è¯†åˆ«
        
        ### ç‰¹æ€§
        - å¤šè¯­è¨€è¯†åˆ«
        - å™ªå£°æŠ‘åˆ¶
        - è¯´è¯äººåˆ†ç¦»
        - æƒ…æ„Ÿæ£€æµ‹
        
      operationId: recognizeVoice
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                audio:
                  type: string
                  format: binary
                  description: éŸ³é¢‘æ–‡ä»¶
                config:
                  $ref: '#/components/schemas/VoiceRecognitionConfig'
      responses:
        '200':
          description: è¯†åˆ«ç»“æœ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VoiceRecognitionResponse'

  # ==================== å›¾åƒç†è§£ API ====================
  /vision/analyze:
    post:
      tags:
        - Vision
      summary: å›¾åƒåˆ†æ
      description: |
        v1.8.0 å¢å¼ºå›¾åƒç†è§£ - æ”¯æŒ12ç§å›¾åƒç±»å‹ï¼Œ95%å‡†ç¡®ç‡
        
        ### æ”¯æŒçš„åˆ†æç±»å‹
        - ç‰©ä½“æ£€æµ‹
        - æ–‡å­—æå– (OCR)
        - åœºæ™¯åˆ†æ
        - æƒ…æ„Ÿæ£€æµ‹
        - å“ç‰Œè¯†åˆ«
        - è´¨é‡è¯„ä¼°
        
      operationId: analyzeImage
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                image:
                  type: string
                  format: binary
                  description: å›¾åƒæ–‡ä»¶
                tasks:
                  type: array
                  items:
                    type: string
                    enum: [description, object_detection, text_extraction, scene_analysis, emotion_detection, brand_recognition]
                query:
                  type: string
                  description: ç”¨æˆ·æŸ¥è¯¢
      responses:
        '200':
          description: åˆ†æç»“æœ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VisionAnalysisResponse'

  # ==================== å¤šæ¨¡æ€èåˆ API ====================
  /multimodal/fuse:
    post:
      tags:
        - Multimodal
      summary: å¤šæ¨¡æ€èåˆ
      description: |
        v1.8.0 å¢å¼ºå¤šæ¨¡æ€èåˆ - 92%èåˆå‡†ç¡®ç‡ï¼Œæ”¯æŒ5ç§æ¨¡æ€
        
        ### èåˆç­–ç•¥
        - å±‚æ¬¡åŒ–èåˆ
        - è·¨æ¨¡æ€æ³¨æ„åŠ›
        - è‡ªé€‚åº”æƒé‡
        - åŠ¨æ€è°ƒæ•´
        
      operationId: fuseModalities
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MultimodalFusionRequest'
      responses:
        '200':
          description: èåˆç»“æœ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MultimodalFusionResponse'

  # ==================== MCPæœåŠ¡é›†æˆ API ====================
  /mcp/services:
    get:
      tags:
        - MCP
      summary: è·å–å¯ç”¨æœåŠ¡åˆ—è¡¨
      description: |
        v1.9.0 MCPç”Ÿæ€ç³»ç»Ÿ - 500+æœåŠ¡é›†æˆ
        
        ### æœåŠ¡åˆ†ç±»
        - åŠå…¬å¥—ä»¶ (Google Workspace, Office 365)
        - å¼€å‘å·¥å…· (GitHub, GitLab, Jira)
        - ç¤¾äº¤å¹³å° (é’‰é’‰, ä¼ä¸šå¾®ä¿¡, Slack)
        - ç”µå•†å¹³å° (æ·˜å®, äº¬ä¸œ)
        - äº‘æœåŠ¡ç­‰
        
      operationId: getServices
      parameters:
        - name: category
          in: query
          schema:
            type: string
            enum: [office_suite, development, social_platform, ecommerce, cloud_service, database, monitoring, security, ai_ml]
        - name: status
          in: query
          schema:
            type: string
            enum: [active, inactive, beta, maintenance]
            default: active
      responses:
        '200':
          description: æœåŠ¡åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceList'

  /mcp/services/{serviceName}/call:
    post:
      tags:
        - MCP
      summary: è°ƒç”¨MCPæœåŠ¡
      description: è°ƒç”¨æŒ‡å®šçš„MCPæœåŠ¡æ‰§è¡Œæ“ä½œ
      operationId: callMCPService
      parameters:
        - name: serviceName
          in: path
          required: true
          schema:
            type: string
          example: github
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MCPServiceCallRequest'
      responses:
        '200':
          description: æœåŠ¡è°ƒç”¨ç»“æœ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MCPServiceCallResponse'

  # ==================== æ•°æ®é›†ç®¡ç† API ====================
  /datasets:
    get:
      tags:
        - Datasets
      summary: è·å–æ•°æ®é›†åˆ—è¡¨
      operationId: getDatasets
      responses:
        '200':
          description: æ•°æ®é›†åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DatasetList'
    post:
      tags:
        - Datasets
      summary: åˆ›å»ºæ•°æ®é›†
      operationId: createDataset
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDatasetRequest'
      responses:
        '201':
          description: æ•°æ®é›†åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Dataset'

  /datasets/{datasetId}/ingest:
    post:
      tags:
        - Datasets
      summary: æ•°æ®æ‘„å–
      description: å‘æ•°æ®é›†ä¸­æ·»åŠ æ–‡æ¡£æˆ–æ•°æ®
      operationId: ingestData
      parameters:
        - name: datasetId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
                metadata:
                  type: object
      responses:
        '200':
          description: æ‘„å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IngestResponse'

  # ==================== ç³»ç»Ÿç›‘æ§ API ====================
  /system/health:
    get:
      tags:
        - System
      summary: ç³»ç»Ÿå¥åº·æ£€æŸ¥
      description: è·å–ç³»ç»Ÿå„ç»„ä»¶çš„å¥åº·çŠ¶æ€
      operationId: getSystemHealth
      responses:
        '200':
          description: ç³»ç»Ÿå¥åº·çŠ¶æ€
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemHealth'

  /system/metrics:
    get:
      tags:
        - System
      summary: ç³»ç»ŸæŒ‡æ ‡
      description: è·å–ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡å’Œç»Ÿè®¡ä¿¡æ¯
      operationId: getSystemMetrics
      responses:
        '200':
          description: ç³»ç»ŸæŒ‡æ ‡
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemMetrics'

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://auth.voicehelper.com/oauth/authorize
          tokenUrl: https://auth.voicehelper.com/oauth/token
          scopes:
            read: è¯»å–æƒé™
            write: å†™å…¥æƒé™
            admin: ç®¡ç†å‘˜æƒé™
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    # ==================== èŠå¤©ç›¸å…³ ====================
    ChatCompletionRequest:
      type: object
      required:
        - messages
      properties:
        messages:
          type: array
          items:
            $ref: '#/components/schemas/Message'
        model:
          type: string
          enum: [gpt-4-turbo, gpt-4-vision, claude-3-opus, doubao-pro]
          default: gpt-4-turbo
        stream:
          type: boolean
          default: false
        max_tokens:
          type: integer
          minimum: 1
          maximum: 4096
          default: 1000
        temperature:
          type: number
          minimum: 0
          maximum: 2
          default: 0.7
        multimodal_config:
          $ref: '#/components/schemas/MultimodalConfig'

    Message:
      type: object
      required:
        - role
        - content
      properties:
        role:
          type: string
          enum: [system, user, assistant]
        content:
          type: string
        attachments:
          type: array
          items:
            $ref: '#/components/schemas/Attachment'

    Attachment:
      type: object
      required:
        - type
      properties:
        type:
          type: string
          enum: [image, audio, video, file]
        url:
          type: string
          format: uri
        data:
          type: string
          format: base64
        metadata:
          type: object

    MultimodalConfig:
      type: object
      properties:
        enable_vision:
          type: boolean
          default: true
        enable_audio:
          type: boolean
          default: true
        enable_emotion_detection:
          type: boolean
          default: false
        fusion_strategy:
          type: string
          enum: [hierarchical, adaptive_attention, cross_transformer]
          default: hierarchical

    ChatCompletionResponse:
      type: object
      properties:
        id:
          type: string
        object:
          type: string
          enum: [chat.completion]
        created:
          type: integer
        model:
          type: string
        choices:
          type: array
          items:
            $ref: '#/components/schemas/Choice'
        usage:
          $ref: '#/components/schemas/Usage'
        processing_metrics:
          $ref: '#/components/schemas/ProcessingMetrics'

    Choice:
      type: object
      properties:
        index:
          type: integer
        message:
          $ref: '#/components/schemas/Message'
        finish_reason:
          type: string
          enum: [stop, length, content_filter]

    Usage:
      type: object
      properties:
        prompt_tokens:
          type: integer
        completion_tokens:
          type: integer
        total_tokens:
          type: integer

    ProcessingMetrics:
      type: object
      properties:
        total_time_ms:
          type: number
        voice_processing_time_ms:
          type: number
        vision_processing_time_ms:
          type: number
        fusion_time_ms:
          type: number
        model_inference_time_ms:
          type: number

    # ==================== è¯­éŸ³ç›¸å…³ ====================
    VoiceSynthesisRequest:
      type: object
      required:
        - text
      properties:
        text:
          type: string
          maxLength: 5000
        voice:
          type: string
          enum: [alloy, echo, fable, onyx, nova, shimmer]
          default: alloy
        emotion:
          type: string
          enum: [neutral, happy, sad, angry, excited, calm]
          default: neutral
        speed:
          type: number
          minimum: 0.25
          maximum: 4.0
          default: 1.0
        language:
          type: string
          enum: [zh-CN, en-US, ja-JP, ko-KR]
          default: zh-CN
        streaming:
          type: boolean
          default: false

    VoiceSynthesisResponse:
      type: object
      properties:
        audio_url:
          type: string
          format: uri
        duration_ms:
          type: integer
        synthesis_time_ms:
          type: number
        quality_score:
          type: number
          minimum: 0
          maximum: 1
        emotion_applied:
          type: string

    VoiceRecognitionConfig:
      type: object
      properties:
        language:
          type: string
          default: zh-CN
        enable_emotion_detection:
          type: boolean
          default: false
        enable_speaker_separation:
          type: boolean
          default: false
        noise_reduction:
          type: boolean
          default: true

    VoiceRecognitionResponse:
      type: object
      properties:
        text:
          type: string
        confidence:
          type: number
          minimum: 0
          maximum: 1
        language_detected:
          type: string
        processing_time_ms:
          type: number
        emotions:
          type: array
          items:
            $ref: '#/components/schemas/EmotionScore'
        speakers:
          type: array
          items:
            $ref: '#/components/schemas/SpeakerSegment'

    # ==================== è§†è§‰ç›¸å…³ ====================
    VisionAnalysisResponse:
      type: object
      properties:
        image_type:
          type: string
        description:
          type: string
        objects:
          type: array
          items:
            $ref: '#/components/schemas/DetectedObject'
        texts:
          type: array
          items:
            $ref: '#/components/schemas/ExtractedText'
        emotions:
          type: array
          items:
            $ref: '#/components/schemas/EmotionScore'
        brands:
          type: array
          items:
            $ref: '#/components/schemas/DetectedBrand'
        quality_metrics:
          $ref: '#/components/schemas/ImageQualityMetrics'
        processing_time_ms:
          type: number
        accuracy_estimate:
          type: number

    DetectedObject:
      type: object
      properties:
        label:
          type: string
        confidence:
          type: number
        bbox:
          type: array
          items:
            type: number
          minItems: 4
          maxItems: 4
        attributes:
          type: object

    ExtractedText:
      type: object
      properties:
        text:
          type: string
        confidence:
          type: number
        bbox:
          type: array
          items:
            type: number
        language:
          type: string

    DetectedBrand:
      type: object
      properties:
        brand:
          type: string
        confidence:
          type: number
        bbox:
          type: array
          items:
            type: number
        category:
          type: string

    ImageQualityMetrics:
      type: object
      properties:
        sharpness:
          type: number
        brightness:
          type: number
        contrast:
          type: number
        noise_level:
          type: number
        overall_quality:
          type: number

    # ==================== å¤šæ¨¡æ€èåˆ ====================
    MultimodalFusionRequest:
      type: object
      required:
        - modality_inputs
      properties:
        modality_inputs:
          type: array
          items:
            $ref: '#/components/schemas/ModalityInput'
        fusion_strategy:
          type: string
          enum: [hierarchical, adaptive_attention, cross_transformer, dynamic_weighting]
          default: hierarchical
        context:
          type: object

    ModalityInput:
      type: object
      required:
        - modality
        - data
      properties:
        modality:
          type: string
          enum: [text, image, audio, video, structured]
        data:
          oneOf:
            - type: string
            - type: object
        confidence:
          type: number
          default: 1.0
        quality_score:
          type: number
          default: 1.0
        metadata:
          type: object

    MultimodalFusionResponse:
      type: object
      properties:
        fused_representation:
          type: array
          items:
            type: number
        confidence:
          type: number
        modality_contributions:
          type: object
        fusion_strategy_used:
          type: string
        processing_time_ms:
          type: number
        quality_metrics:
          type: object
        uncertainty_estimate:
          type: number

    # ==================== MCPæœåŠ¡ ====================
    ServiceList:
      type: object
      properties:
        services:
          type: array
          items:
            $ref: '#/components/schemas/ServiceInfo'
        total_count:
          type: integer
        categories:
          type: object

    ServiceInfo:
      type: object
      properties:
        name:
          type: string
        category:
          type: string
        version:
          type: string
        description:
          type: string
        provider:
          type: string
        status:
          type: string
        supported_operations:
          type: array
          items:
            type: string
        reliability_score:
          type: number
        response_time_ms:
          type: integer

    MCPServiceCallRequest:
      type: object
      required:
        - operation
        - params
      properties:
        operation:
          type: string
        params:
          type: object

    MCPServiceCallResponse:
      type: object
      properties:
        success:
          type: boolean
        result:
          type: object
        service:
          type: string
        operation:
          type: string
        response_time_ms:
          type: number
        error:
          type: string

    # ==================== é€šç”¨ç»„ä»¶ ====================
    EmotionScore:
      type: object
      properties:
        emotion:
          type: string
        confidence:
          type: number
        intensity:
          type: number
        modality:
          type: string

    SpeakerSegment:
      type: object
      properties:
        speaker_id:
          type: string
        start_time:
          type: number
        end_time:
          type: number
        text:
          type: string
        confidence:
          type: number

    # ==================== æ•°æ®é›†ç›¸å…³ ====================
    DatasetList:
      type: object
      properties:
        datasets:
          type: array
          items:
            $ref: '#/components/schemas/Dataset'
        total_count:
          type: integer

    Dataset:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        document_count:
          type: integer
        size_bytes:
          type: integer
        status:
          type: string
          enum: [active, processing, error]

    CreateDatasetRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        description:
          type: string
        config:
          type: object

    IngestResponse:
      type: object
      properties:
        ingested_documents:
          type: integer
        failed_documents:
          type: integer
        processing_time_ms:
          type: number
        errors:
          type: array
          items:
            type: string

    # ==================== ç³»ç»Ÿç›‘æ§ ====================
    SystemHealth:
      type: object
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        components:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/ComponentHealth'
        timestamp:
          type: string
          format: date-time

    ComponentHealth:
      type: object
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        response_time_ms:
          type: number
        error_rate:
          type: number
        last_check:
          type: string
          format: date-time

    SystemMetrics:
      type: object
      properties:
        version:
          type: string
        uptime_seconds:
          type: integer
        requests_per_minute:
          type: number
        average_response_time_ms:
          type: number
        error_rate:
          type: number
        active_connections:
          type: integer
        memory_usage_mb:
          type: number
        cpu_usage_percent:
          type: number
        performance_metrics:
          $ref: '#/components/schemas/PerformanceMetrics'

    PerformanceMetrics:
      type: object
      properties:
        voice_processing:
          $ref: '#/components/schemas/VoiceMetrics'
        vision_processing:
          $ref: '#/components/schemas/VisionMetrics'
        multimodal_fusion:
          $ref: '#/components/schemas/FusionMetrics'
        mcp_services:
          $ref: '#/components/schemas/MCPMetrics'

    VoiceMetrics:
      type: object
      properties:
        average_synthesis_time_ms:
          type: number
        average_recognition_time_ms:
          type: number
        success_rate:
          type: number
        target_achievement_rate:
          type: number

    VisionMetrics:
      type: object
      properties:
        average_processing_time_ms:
          type: number
        average_accuracy:
          type: number
        supported_image_types:
          type: integer
        success_rate:
          type: number

    FusionMetrics:
      type: object
      properties:
        average_fusion_time_ms:
          type: number
        average_accuracy:
          type: number
        supported_modalities:
          type: integer
        success_rate:
          type: number

    MCPMetrics:
      type: object
      properties:
        total_services:
          type: integer
        active_services:
          type: integer
        average_response_time_ms:
          type: number
        success_rate:
          type: number

    # ==================== å¯¹è¯ç›¸å…³ ====================
    ConversationList:
      type: object
      properties:
        conversations:
          type: array
          items:
            $ref: '#/components/schemas/ConversationSummary'
        total_count:
          type: integer
        has_more:
          type: boolean

    ConversationSummary:
      type: object
      properties:
        id:
          type: string
        title:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        message_count:
          type: integer
        status:
          type: string
          enum: [active, archived]

    Conversation:
      type: object
      properties:
        id:
          type: string
        title:
          type: string
        messages:
          type: array
          items:
            $ref: '#/components/schemas/Message'
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        metadata:
          type: object

    # ==================== æµå¼å“åº” ====================
    ChatCompletionStreamResponse:
      type: object
      properties:
        id:
          type: string
        object:
          type: string
          enum: [chat.completion.chunk]
        created:
          type: integer
        model:
          type: string
        choices:
          type: array
          items:
            $ref: '#/components/schemas/StreamChoice'

    StreamChoice:
      type: object
      properties:
        index:
          type: integer
        delta:
          $ref: '#/components/schemas/MessageDelta'
        finish_reason:
          type: string
          enum: [stop, length, content_filter]

    MessageDelta:
      type: object
      properties:
        role:
          type: string
        content:
          type: string

    # ==================== é”™è¯¯å“åº” ====================
    Error:
      type: object
      properties:
        error:
          type: object
          properties:
            code:
              type: string
            message:
              type: string
            type:
              type: string
            details:
              type: object

  responses:
    BadRequest:
      description: è¯·æ±‚å‚æ•°é”™è¯¯
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: invalid_request
              message: è¯·æ±‚å‚æ•°ä¸æ­£ç¡®
              type: invalid_request_error

    Unauthorized:
      description: æœªæˆæƒè®¿é—®
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: unauthorized
              message: APIå¯†é’¥æ— æ•ˆæˆ–å·²è¿‡æœŸ
              type: authentication_error

    NotFound:
      description: èµ„æºæœªæ‰¾åˆ°
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: not_found
              message: è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨
              type: not_found_error

    RateLimitExceeded:
      description: è¯·æ±‚é¢‘ç‡è¶…é™
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: rate_limit_exceeded
              message: è¯·æ±‚é¢‘ç‡è¶…è¿‡é™åˆ¶ï¼Œè¯·ç¨åé‡è¯•
              type: rate_limit_error
      headers:
        Retry-After:
          schema:
            type: integer
          description: å»ºè®®é‡è¯•çš„ç§’æ•°

tags:
  - name: Chat
    description: èŠå¤©å¯¹è¯ç›¸å…³API
  - name: Voice
    description: è¯­éŸ³å¤„ç†ç›¸å…³API
  - name: Vision
    description: å›¾åƒç†è§£ç›¸å…³API
  - name: Multimodal
    description: å¤šæ¨¡æ€èåˆç›¸å…³API
  - name: MCP
    description: MCPæœåŠ¡é›†æˆç›¸å…³API
  - name: Datasets
    description: æ•°æ®é›†ç®¡ç†ç›¸å…³API
  - name: System
    description: ç³»ç»Ÿç›‘æ§ç›¸å…³API
