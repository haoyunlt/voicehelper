# VoiceHelper AI - Docker Compose éƒ¨ç½²æ–¹æ¡ˆæ€»ç»“

## ğŸ‰ éƒ¨ç½²æ–¹æ¡ˆå®ŒæˆçŠ¶æ€

### âœ… å·²å®Œæˆçš„åŠŸèƒ½

#### 1. å®Œæ•´çš„ Docker Compose æ¶æ„
- **ä¸»é…ç½®æ–‡ä»¶**: `docker-compose.yml` - å®Œæ•´çš„ç”Ÿäº§çº§é…ç½®
- **å¼€å‘ç¯å¢ƒ**: `docker-compose.dev.yml` - æ”¯æŒçƒ­é‡è½½å’Œè°ƒè¯•
- **ç”Ÿäº§ç¯å¢ƒ**: `docker-compose.prod.yml` - æ€§èƒ½ä¼˜åŒ–å’Œå®‰å…¨é…ç½®
- **æœ¬åœ°ç¯å¢ƒ**: `docker-compose.local.yml` - å¿«é€Ÿä½“éªŒé…ç½®

#### 2. ä¼˜åŒ–çš„ Dockerfile
- **Go ç½‘å…³æœåŠ¡**: å¤šé˜¶æ®µæ„å»ºï¼Œæœ€å°åŒ–é•œåƒå¤§å°
- **Python ç®—æ³•æœåŠ¡**: åˆ†å±‚æ„å»ºï¼Œæ”¯æŒç¼“å­˜ä¼˜åŒ–
- **Next.js å‰ç«¯**: ç”Ÿäº§çº§æ„å»ºï¼Œæ€§èƒ½ä¼˜åŒ–
- **ç®¡ç†åå°**: è½»é‡çº§ Flask åº”ç”¨

#### 3. å®Œæ•´çš„ç¬¬ä¸‰æ–¹è½¯ä»¶æ”¯æŒ
- **æ•°æ®åº“**: PostgreSQL 15 (ä¸»æ•°æ®åº“)
- **ç¼“å­˜**: Redis 7 (ä¼šè¯å’Œç¼“å­˜)
- **å‘é‡æ•°æ®åº“**: Milvus 2.3.3 (AI å‘é‡æœç´¢)
- **å›¾æ•°æ®åº“**: Neo4j 5.15 (çŸ¥è¯†å›¾è°±)
- **æ¶ˆæ¯é˜Ÿåˆ—**: NATS (äº‹ä»¶é©±åŠ¨)
- **å¯¹è±¡å­˜å‚¨**: MinIO (Milvus ä¾èµ–)
- **åè°ƒæœåŠ¡**: etcd (Milvus ä¾èµ–)

#### 4. ç›‘æ§å’Œç®¡ç†å·¥å…·
- **æŒ‡æ ‡ç›‘æ§**: Prometheus + Grafana
- **é“¾è·¯è¿½è¸ª**: Jaeger
- **æ•°æ®åº“ç®¡ç†**: pgAdmin
- **Redis ç®¡ç†**: Redis Commander
- **å‘é‡æ•°æ®åº“ç®¡ç†**: Attu
- **API æ–‡æ¡£**: Swagger UI
- **é‚®ä»¶æµ‹è¯•**: Mailhog

#### 5. è´Ÿè½½å‡è¡¡å’Œåå‘ä»£ç†
- **å¼€å‘ç¯å¢ƒ**: Nginx åå‘ä»£ç†
- **ç”Ÿäº§ç¯å¢ƒ**: HAProxy è´Ÿè½½å‡è¡¡
- **SSL ç»ˆæ­¢**: æ”¯æŒ HTTPS é…ç½®
- **å¥åº·æ£€æŸ¥**: è‡ªåŠ¨æ•…éšœè½¬ç§»

#### 6. éƒ¨ç½²å’Œç®¡ç†è„šæœ¬
- **ä¸»éƒ¨ç½²è„šæœ¬**: `deploy.sh` - åŠŸèƒ½å®Œæ•´çš„éƒ¨ç½²å·¥å…·
- **å¿«é€Ÿå¯åŠ¨**: `quick-start.sh` - ä¸€é”®å¯åŠ¨å‘å¯¼
- **é…ç½®æµ‹è¯•**: `test-config.sh` - é…ç½®æ–‡ä»¶éªŒè¯
- **Makefile**: ç®€åŒ–å¸¸ç”¨æ“ä½œ

#### 7. æœåŠ¡å‘ç°å’Œå¥åº·æ£€æŸ¥
- **å†…éƒ¨æœåŠ¡å‘ç°**: Docker ç½‘ç»œè‡ªåŠ¨è§£æ
- **å¥åº·æ£€æŸ¥**: æ‰€æœ‰æœåŠ¡éƒ½é…ç½®äº†å¥åº·æ£€æŸ¥
- **ä¾èµ–ç®¡ç†**: æœåŠ¡å¯åŠ¨é¡ºåºå’Œä¾èµ–å…³ç³»
- **æ•…éšœæ¢å¤**: è‡ªåŠ¨é‡å¯å’Œæ•…éšœè½¬ç§»

#### 8. ç½‘ç»œå’Œå®‰å…¨é…ç½®
- **éš”ç¦»ç½‘ç»œ**: ä¸“ç”¨ Docker ç½‘ç»œ
- **ç«¯å£æ˜ å°„**: åˆç†çš„ç«¯å£åˆ†é…
- **å®‰å…¨é…ç½®**: ç”Ÿäº§çº§å®‰å…¨è®¾ç½®
- **èµ„æºé™åˆ¶**: CPU å’Œå†…å­˜é™åˆ¶

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä¸€é”®å¯åŠ¨
```bash
# æ–¹å¼1: ä½¿ç”¨å¿«é€Ÿå¯åŠ¨è„šæœ¬
./quick-start.sh

# æ–¹å¼2: ä½¿ç”¨ Makefile
make quick-start

# æ–¹å¼3: æ‰‹åŠ¨å¯åŠ¨
cp env.unified .env
./deploy.sh -e dev up -d
```

### ç¯å¢ƒé€‰æ‹©
```bash
# å¼€å‘ç¯å¢ƒ (æ¨èç”¨äºå¼€å‘å’Œè°ƒè¯•)
./deploy.sh -e dev up -d
make dev

# ç”Ÿäº§ç¯å¢ƒ (æ¨èç”¨äºç”Ÿäº§éƒ¨ç½²)
./deploy.sh -e prod up -d
make prod

# æœ¬åœ°ç¯å¢ƒ (æ¨èç”¨äºå¿«é€Ÿä½“éªŒ)
./deploy.sh -e local up -d
make local
```

### æœåŠ¡é…ç½®
```bash
# ä»…å¯åŠ¨æ ¸å¿ƒæœåŠ¡
./deploy.sh -p core up -d
make core

# ä»…å¯åŠ¨ç›‘æ§æœåŠ¡
./deploy.sh -p monitoring up -d
make monitoring

# ä»…å¯åŠ¨å¼€å‘å·¥å…·
./deploy.sh -p tools up -d
make tools
```

## ğŸ“Š æœåŠ¡æ¶æ„

### åº”ç”¨æœåŠ¡å±‚
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸŒ Web Frontend (Next.js)     :3000                       â”‚
â”‚  ğŸšª API Gateway (Go)           :8080                       â”‚
â”‚  ğŸ¤– AI Algorithm Service (Python) :8000                    â”‚
â”‚  ğŸ¤ Voice Service (Python)     :8001                       â”‚
â”‚  âš™ï¸  Admin Panel (Flask)        :5001                       â”‚
â”‚  ğŸ”§ Developer Portal (Next.js) :3002                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®å­˜å‚¨å±‚
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—„ï¸  PostgreSQL               :5432                         â”‚
â”‚  ğŸ”´ Redis                     :6379                         â”‚
â”‚  ğŸ” Milvus Vector DB          :19530                        â”‚
â”‚  ğŸ“Š Neo4j Graph DB            :7474, :7687                  â”‚
â”‚  ğŸ“¨ NATS Message Queue        :4222                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›‘æ§å’Œç®¡ç†å±‚
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ˆ Grafana                   :3004                         â”‚
â”‚  ğŸ“Š Prometheus                :9090                         â”‚
â”‚  ğŸ” Jaeger                    :16686                        â”‚
â”‚  ğŸ—„ï¸  pgAdmin                   :5050                         â”‚
â”‚  ğŸ”´ Redis Commander           :8081                         â”‚
â”‚  ğŸ” Attu (Milvus UI)          :3001                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ ç®¡ç†å‘½ä»¤

### åŸºç¡€æ“ä½œ
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./deploy.sh status
make status

# æŸ¥çœ‹æ—¥å¿—
./deploy.sh logs
make logs

# å¥åº·æ£€æŸ¥
./deploy.sh health
make health

# é‡å¯æœåŠ¡
./deploy.sh restart
make restart

# åœæ­¢æœåŠ¡
./deploy.sh down
make stop
```

### æ•°æ®ç®¡ç†
```bash
# å¤‡ä»½æ•°æ®
./deploy.sh backup
make backup

# æ¢å¤æ•°æ®
./deploy.sh restore /path/to/backup
make restore BACKUP_DIR=/path/to/backup

# æ¸…ç†èµ„æº
./deploy.sh -f clean
make clean
```

### æ‰©ç¼©å®¹
```bash
# æ‰©å®¹ç®—æ³•æœåŠ¡
./deploy.sh scale algo-service=3
make scale-algo REPLICAS=3

# æ‰©å®¹ç½‘å…³æœåŠ¡
./deploy.sh scale gateway=2
make scale-gateway REPLICAS=2
```

## ğŸ”‘ é…ç½®è¦ç‚¹

### API å¯†é’¥é…ç½®
ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®ä»¥ä¸‹å…³é”®å‚æ•°ï¼š
```bash
# AI æ¨¡å‹ API å¯†é’¥
ARK_API_KEY=your-ark-api-key-here      # è±†åŒ…å¤§æ¨¡å‹
GLM_API_KEY=your-glm-api-key-here      # GLM-4

# è¯­éŸ³æœåŠ¡ API å¯†é’¥
AZURE_SPEECH_KEY=your-azure-speech-key-here
AZURE_SPEECH_REGION=eastus

# æ•°æ®åº“é…ç½®
POSTGRES_PASSWORD=your-secure-password
REDIS_PASSWORD=your-secure-password

# JWT å®‰å…¨é…ç½®
JWT_SECRET=your-jwt-secret-key
```

### è·å– API å¯†é’¥
1. **è±†åŒ… API**: https://console.volcengine.com/
2. **GLM-4 API**: https://open.bigmodel.cn/
3. **Azure è¯­éŸ³**: https://portal.azure.com/

## ğŸ¯ è®¿é—®åœ°å€

### å¼€å‘ç¯å¢ƒ
- **Web åº”ç”¨**: http://localhost:3000
- **API ç½‘å…³**: http://localhost:8080
- **ç®—æ³•æœåŠ¡**: http://localhost:8000
- **è¯­éŸ³æœåŠ¡**: http://localhost:8001
- **ç®¡ç†åå°**: http://localhost:5001
- **å¼€å‘è€…é—¨æˆ·**: http://localhost:3002

### ç®¡ç†å·¥å…·
- **Grafana**: http://localhost:3004 (admin/admin123)
- **Prometheus**: http://localhost:9090
- **pgAdmin**: http://localhost:5050 (admin@voicehelper.ai/admin123)
- **Redis ç®¡ç†**: http://localhost:8081
- **Milvus ç®¡ç†**: http://localhost:3001
- **API æ–‡æ¡£**: http://localhost:8082
- **é‚®ä»¶æµ‹è¯•**: http://localhost:8025

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜è§£å†³

#### 1. ç«¯å£å†²çª
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
lsof -i :3000
netstat -tulpn | grep :3000

# ä¿®æ”¹ç«¯å£é…ç½®æˆ–åœæ­¢å†²çªæœåŠ¡
```

#### 2. å†…å­˜ä¸è¶³
```bash
# æ£€æŸ¥å†…å­˜ä½¿ç”¨
free -h
docker system df

# æ¸…ç†èµ„æº
docker system prune -f
```

#### 3. æœåŠ¡å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
./deploy.sh logs -s <service-name>

# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose restart <service-name>
```

#### 4. é…ç½®æ–‡ä»¶é”™è¯¯
```bash
# éªŒè¯é…ç½®æ–‡ä»¶
./test-config.sh

# æ£€æŸ¥ç¯å¢ƒå˜é‡
cat .env
```

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
./deploy.sh logs

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
./deploy.sh -s gateway logs

# å®æ—¶è·Ÿè¸ªæ—¥å¿—
./deploy.sh logs -f
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### èµ„æºé…ç½®å»ºè®®

#### æœ€ä½é…ç½®
- **CPU**: 4 æ ¸å¿ƒ
- **å†…å­˜**: 8GB
- **å­˜å‚¨**: 20GB SSD

#### æ¨èé…ç½®
- **CPU**: 8 æ ¸å¿ƒ
- **å†…å­˜**: 16GB
- **å­˜å‚¨**: 50GB SSD

#### ç”Ÿäº§é…ç½®
- **CPU**: 16 æ ¸å¿ƒ
- **å†…å­˜**: 32GB
- **å­˜å‚¨**: 100GB SSD

### æ‰©å®¹ç­–ç•¥
```bash
# æ°´å¹³æ‰©å®¹
./deploy.sh scale gateway=3
./deploy.sh scale algo-service=2

# å‚ç›´æ‰©å®¹ (ä¿®æ”¹ docker-compose.prod.yml)
resources:
  limits:
    memory: 4G
    cpus: '2'
```

## ğŸ”’ å®‰å…¨é…ç½®

### ç”Ÿäº§ç¯å¢ƒå®‰å…¨å»ºè®®
1. **ä¿®æ”¹é»˜è®¤å¯†ç **
2. **å¯ç”¨ HTTPS**
3. **é…ç½®é˜²ç«å¢™**
4. **å®šæœŸæ›´æ–°é•œåƒ**
5. **ç›‘æ§å¼‚å¸¸è®¿é—®**

### ç½‘ç»œå®‰å…¨
```bash
# ä»…æš´éœ²å¿…è¦ç«¯å£
ports:
  - "80:80"    # HTTP
  - "443:443"  # HTTPS

# ä½¿ç”¨å†…éƒ¨ç½‘ç»œé€šä¿¡
networks:
  - voicehelper-network
```

## ğŸ“ æ›´æ–°å’Œç»´æŠ¤

### ç‰ˆæœ¬æ›´æ–°æµç¨‹
```bash
# 1. å¤‡ä»½æ•°æ®
./deploy.sh backup

# 2. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# 3. æ›´æ–°é•œåƒ
./deploy.sh pull

# 4. é‡æ–°éƒ¨ç½²
./deploy.sh restart

# 5. éªŒè¯æ›´æ–°
./deploy.sh health
```

### å®šæœŸç»´æŠ¤ä»»åŠ¡
- **æ¯å‘¨**: å¤‡ä»½æ•°æ®ã€æ¸…ç†æ—¥å¿—
- **æ¯æœˆ**: æ›´æ–°é•œåƒã€æ£€æŸ¥å®‰å…¨
- **æ¯å­£åº¦**: æ€§èƒ½è¯„ä¼°ã€å®¹é‡è§„åˆ’

## ğŸ‰ éƒ¨ç½²æˆåŠŸæ ‡å¿—

å½“æ‚¨çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºæ—¶ï¼Œè¯´æ˜éƒ¨ç½²æˆåŠŸï¼š

```bash
âœ… æ‰€æœ‰æœåŠ¡è¿è¡Œæ­£å¸¸
ğŸŒ Web åº”ç”¨: http://localhost:3000
ğŸ”§ API ç½‘å…³: http://localhost:8080
ğŸ¤– ç®—æ³•æœåŠ¡: http://localhost:8000
ğŸ“Š ç›‘æ§é¢æ¿: http://localhost:3004
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è·å–å¸®åŠ©
- **é¡¹ç›®æ–‡æ¡£**: [DEPLOYMENT.md](./DEPLOYMENT.md)
- **é…ç½®æŒ‡å—**: [docs/](./docs/)
- **é—®é¢˜åé¦ˆ**: GitHub Issues
- **æŠ€æœ¯è®¨è®º**: GitHub Discussions

### è”ç³»æ–¹å¼
- **é‚®ç®±**: support@voicehelper.ai
- **å®˜ç½‘**: https://voicehelper.ai
- **æ–‡æ¡£**: https://docs.voicehelper.ai

---

## ğŸ† æ€»ç»“

VoiceHelper AI çš„ Docker Compose éƒ¨ç½²æ–¹æ¡ˆå·²ç»å®Œæˆï¼Œæä¾›äº†ï¼š

âœ… **å®Œæ•´çš„æœåŠ¡æ¶æ„** - åŒ…å«æ‰€æœ‰å¿…è¦çš„åº”ç”¨æœåŠ¡å’Œç¬¬ä¸‰æ–¹ä¾èµ–
âœ… **å¤šç¯å¢ƒæ”¯æŒ** - å¼€å‘ã€ç”Ÿäº§ã€æœ¬åœ°ä¸‰ç§ç¯å¢ƒé…ç½®
âœ… **ä¸€é”®éƒ¨ç½²** - ç®€åŒ–çš„å¯åŠ¨æµç¨‹å’Œç®¡ç†å·¥å…·
âœ… **å®Œå–„çš„ç›‘æ§** - å…¨é¢çš„ç›‘æ§å’Œç®¡ç†ç•Œé¢
âœ… **ç”Ÿäº§å°±ç»ª** - æ€§èƒ½ä¼˜åŒ–å’Œå®‰å…¨é…ç½®
âœ… **æ˜“äºç»´æŠ¤** - å®Œæ•´çš„æ–‡æ¡£å’Œæ•…éšœæ’é™¤æŒ‡å—

ç°åœ¨æ‚¨å¯ä»¥ä½¿ç”¨ `./quick-start.sh` ä¸€é”®å¯åŠ¨å®Œæ•´çš„ VoiceHelper AI ç³»ç»Ÿï¼

ğŸ¯ **ç«‹å³å¼€å§‹**: `./quick-start.sh`
