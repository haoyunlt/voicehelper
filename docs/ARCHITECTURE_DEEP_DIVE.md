# VoiceHelperæ™ºèƒ½è¯­éŸ³åŠ©æ‰‹ç³»ç»Ÿæ¶æ„æŠ€æœ¯æ–‡æ¡£

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»VoiceHelperæ™ºèƒ½è¯­éŸ³åŠ©æ‰‹ç³»ç»Ÿçš„æ¶æ„è®¾è®¡ä¸æŠ€æœ¯å®ç°ï¼Œæ¶µç›–å¾®æœåŠ¡æ¶æ„ã€AIç®—æ³•å¼•æ“ç­‰æ ¸å¿ƒæŠ€æœ¯ç»„ä»¶çš„è®¾è®¡åŸç†å’Œå®ç°æ–¹æ¡ˆ

## æ–‡ç« ç›®å½•

- [VoiceHelperæ™ºèƒ½è¯­éŸ³åŠ©æ‰‹ç³»ç»Ÿæ¶æ„æŠ€æœ¯æ–‡æ¡£](#voicehelperæ™ºèƒ½è¯­éŸ³åŠ©æ‰‹ç³»ç»Ÿæ¶æ„æŠ€æœ¯æ–‡æ¡£)
  - [æ–‡ç« ç›®å½•](#æ–‡ç« ç›®å½•)
  - [æ¦‚è¿°](#æ¦‚è¿°)
  - [1. VoiceHelperæ•´ä½“æ¶æ„è®¾è®¡](#1-voicehelperæ•´ä½“æ¶æ„è®¾è®¡)
    - [1.1 ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ](#11-ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ)
  - [12. ç‰ˆæœ¬è¿­ä»£å†ç¨‹ä¸æœªæ¥è§„åˆ’](#12-ç‰ˆæœ¬è¿­ä»£å†ç¨‹ä¸æœªæ¥è§„åˆ’)
    - [12.1 å·²å‘å¸ƒç‰ˆæœ¬åŠŸèƒ½æ¸…å•](#121-å·²å‘å¸ƒç‰ˆæœ¬åŠŸèƒ½æ¸…å•)
      - [12.1.1 ğŸš€ v1.8.0 ä½“éªŒå‡çº§ç‰ˆï¼ˆå·²å®Œæˆï¼‰](#1211--v180-ä½“éªŒå‡çº§ç‰ˆå·²å®Œæˆ)
      - [12.1.2 ğŸŒŸ v1.9.0 ç”Ÿæ€å»ºè®¾ç‰ˆï¼ˆå·²å®Œæˆï¼‰](#1212--v190-ç”Ÿæ€å»ºè®¾ç‰ˆå·²å®Œæˆ)
    - [12.2 ğŸš€ æœªæ¥ç‰ˆæœ¬è¿­ä»£è§„åˆ’](#122--æœªæ¥ç‰ˆæœ¬è¿­ä»£è§„åˆ’)
      - [12.2.1 v2.0.0 ä¼ä¸šå®Œå–„ç‰ˆï¼ˆè®¡åˆ’ä¸­ï¼‰](#1221-v200-ä¼ä¸šå®Œå–„ç‰ˆè®¡åˆ’ä¸­)
      - [12.2.2 v2.1.0 æ™ºèƒ½åŒ–å‡çº§ç‰ˆï¼ˆè§„åˆ’ä¸­ï¼‰](#1222-v210-æ™ºèƒ½åŒ–å‡çº§ç‰ˆè§„åˆ’ä¸­)
      - [12.2.3 v3.0.0 ç”Ÿæ€å¹³å°ç‰ˆï¼ˆè¿œæœŸè§„åˆ’ï¼‰](#1223-v300-ç”Ÿæ€å¹³å°ç‰ˆè¿œæœŸè§„åˆ’)
    - [12.3 ç‰ˆæœ¬è¿­ä»£æ—¶é—´çº¿](#123-ç‰ˆæœ¬è¿­ä»£æ—¶é—´çº¿)
    - [12.4 æŠ€æœ¯æ¼”è¿›è·¯å¾„](#124-æŠ€æœ¯æ¼”è¿›è·¯å¾„)
      - [12.4.1 AIèƒ½åŠ›æ¼”è¿›](#1241-aièƒ½åŠ›æ¼”è¿›)
      - [12.4.2 æ¶æ„æ¼”è¿›è·¯å¾„](#1242-æ¶æ„æ¼”è¿›è·¯å¾„)
    - [12.5 å•†ä¸šä»·å€¼å®ç°è·¯å¾„](#125-å•†ä¸šä»·å€¼å®ç°è·¯å¾„)
      - [12.5.1 æŠ€æœ¯æŠ¤åŸæ²³å»ºè®¾](#1251-æŠ€æœ¯æŠ¤åŸæ²³å»ºè®¾)
      - [12.5.2 å¸‚åœºç«äº‰åœ°ä½](#1252-å¸‚åœºç«äº‰åœ°ä½)
  - [13. ä¸šç•Œç«äº‰åŠ›åˆ†æä¸å¸‚åœºå®šä½](#13-ä¸šç•Œç«äº‰åŠ›åˆ†æä¸å¸‚åœºå®šä½)
    - [13.1 ğŸ† ä¸šç•Œä¸»æµäº§å“å¯¹æ¯”åˆ†æ](#131--ä¸šç•Œä¸»æµäº§å“å¯¹æ¯”åˆ†æ)
      - [13.1.1 OpenAI ChatGPTç³»åˆ—å¯¹æ¯”](#1311-openai-chatgptç³»åˆ—å¯¹æ¯”)
      - [13.1.2 Anthropic Claude 3.5 Sonnetå¯¹æ¯”](#1312-anthropic-claude-35-sonnetå¯¹æ¯”)
      - [13.1.3 Google Gemini Liveå¯¹æ¯”](#1313-google-gemini-liveå¯¹æ¯”)
    - [13.2 ğŸ¯ VoiceHelperç«äº‰ä¼˜åŠ¿åˆ†æ](#132--voicehelperç«äº‰ä¼˜åŠ¿åˆ†æ)
      - [13.2.1 æ ¸å¿ƒæŠ€æœ¯ä¼˜åŠ¿ï¼ˆå·²å®ç°ï¼‰](#1321-æ ¸å¿ƒæŠ€æœ¯ä¼˜åŠ¿å·²å®ç°)
      - [13.2.2 ç”Ÿæ€å»ºè®¾ç°çŠ¶](#1322-ç”Ÿæ€å»ºè®¾ç°çŠ¶)
      - [13.2.3 æ€§èƒ½æŒ‡æ ‡å¯¹æ¯”](#1323-æ€§èƒ½æŒ‡æ ‡å¯¹æ¯”)
    - [13.3 ğŸš€ ç«äº‰åŠ›æå‡è·¯å¾„](#133--ç«äº‰åŠ›æå‡è·¯å¾„)
      - [13.3.1 v2.0.0ä¼ä¸šå®Œå–„ç‰ˆç«äº‰åŠ›æå‡](#1331-v200ä¼ä¸šå®Œå–„ç‰ˆç«äº‰åŠ›æå‡)
      - [13.3.2 é•¿æœŸç«äº‰æˆ˜ç•¥ï¼ˆv2.1.0-v3.0.0ï¼‰](#1332-é•¿æœŸç«äº‰æˆ˜ç•¥v210-v300)
    - [13.4 é£é™©åˆ†æä¸åº”å¯¹ç­–ç•¥](#134-é£é™©åˆ†æä¸åº”å¯¹ç­–ç•¥)
      - [13.4.1 ç«äº‰é£é™©è¯†åˆ«](#1341-ç«äº‰é£é™©è¯†åˆ«)
      - [13.4.2 åº”å¯¹ç­–ç•¥](#1342-åº”å¯¹ç­–ç•¥)
    - [13.5 æ€»ç»“ä¸å±•æœ›](#135-æ€»ç»“ä¸å±•æœ›)
      - [13.5.1 ç«äº‰åœ°ä½æ€»ç»“](#1351-ç«äº‰åœ°ä½æ€»ç»“)
      - [13.5.2 å‘å±•å»ºè®®](#1352-å‘å±•å»ºè®®)
  - [14. ç³»ç»ŸAPIæ¥å£æ¸…å•ä¸è°ƒç”¨é“¾åˆ†æ](#14-ç³»ç»Ÿapiæ¥å£æ¸…å•ä¸è°ƒç”¨é“¾åˆ†æ)
    - [14.1 æ¨¡å—APIæ¥å£æ€»è§ˆ](#141-æ¨¡å—apiæ¥å£æ€»è§ˆ)
      - [14.1.1 å‰ç«¯åº”ç”¨æ¨¡å— (Frontend)](#1411-å‰ç«¯åº”ç”¨æ¨¡å—-frontend)
      - [14.1.2 åç«¯æœåŠ¡æ¨¡å— (Backend Go)](#1412-åç«¯æœåŠ¡æ¨¡å—-backend-go)
      - [14.1.3 ç®—æ³•æœåŠ¡æ¨¡å— (Python FastAPI)](#1413-ç®—æ³•æœåŠ¡æ¨¡å—-python-fastapi)
      - [14.1.4 æ•°æ®å­˜å‚¨æœåŠ¡](#1414-æ•°æ®å­˜å‚¨æœåŠ¡)
    - [14.2 APIè°ƒç”¨é“¾è·¯åˆ†æ](#142-apiè°ƒç”¨é“¾è·¯åˆ†æ)
      - [14.2.1 å¯¹è¯å®Œæˆè°ƒç”¨é“¾](#1421-å¯¹è¯å®Œæˆè°ƒç”¨é“¾)
      - [14.2.2 è¯­éŸ³å¤„ç†è°ƒç”¨é“¾](#1422-è¯­éŸ³å¤„ç†è°ƒç”¨é“¾)
      - [14.2.3 æœåŠ¡é›†æˆè°ƒç”¨é“¾](#1423-æœåŠ¡é›†æˆè°ƒç”¨é“¾)
    - [14.3 ç³»ç»Ÿäº¤äº’æ—¶åºå›¾](#143-ç³»ç»Ÿäº¤äº’æ—¶åºå›¾)
      - [14.3.1 ç”¨æˆ·å¯¹è¯å®Œæ•´æ—¶åºå›¾](#1431-ç”¨æˆ·å¯¹è¯å®Œæ•´æ—¶åºå›¾)
      - [14.3.2 è¯­éŸ³äº¤äº’æ—¶åºå›¾](#1432-è¯­éŸ³äº¤äº’æ—¶åºå›¾)
      - [14.3.3 æœåŠ¡é›†æˆæ—¶åºå›¾](#1433-æœåŠ¡é›†æˆæ—¶åºå›¾)
      - [14.3.4 æ–‡æ¡£å…¥åº“æ—¶åºå›¾](#1434-æ–‡æ¡£å…¥åº“æ—¶åºå›¾)
    - [14.4 å…³é”®APIæ€§èƒ½æŒ‡æ ‡](#144-å…³é”®apiæ€§èƒ½æŒ‡æ ‡)
      - [14.4.1 å“åº”æ—¶é—´æŒ‡æ ‡](#1441-å“åº”æ—¶é—´æŒ‡æ ‡)
      - [14.4.2 å¹¶å‘å¤„ç†èƒ½åŠ›](#1442-å¹¶å‘å¤„ç†èƒ½åŠ›)

## æ¦‚è¿°

VoiceHelperæ˜¯ä¸€ä¸ªåŸºäºå¾®æœåŠ¡æ¶æ„çš„æ™ºèƒ½è¯­éŸ³åŠ©æ‰‹ç³»ç»Ÿï¼Œé›†æˆäº†RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æŠ€æœ¯ã€å¤šæ¨¡æ€èåˆã€å®æ—¶è¯­éŸ³å¤„ç†ç­‰æŠ€æœ¯ç»„ä»¶ã€‚ç³»ç»Ÿé‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œæ”¯æŒå¤šå¹³å°éƒ¨ç½²å’Œæ¨ªå‘æ‰©å±•ã€‚æœ¬æ–‡æ¡£ä»‹ç»ç³»ç»Ÿçš„æ¶æ„è®¾è®¡ã€æ ¸å¿ƒç®—æ³•å®ç°å’Œå…³é”®æŠ€æœ¯ç»„ä»¶ã€‚

## 1. VoiceHelperæ•´ä½“æ¶æ„è®¾è®¡

### 1.1 ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

```mermaid
graph TB
    subgraph "ç”¨æˆ·æ¥å…¥å±‚"
        WEB[Webå‰ç«¯<br/>Next.js + React<br/>- å®æ—¶è¯­éŸ³äº¤äº’<br/>- å“åº”å¼è®¾è®¡<br/>- PWAæ”¯æŒ]
        MOBILE[ç§»åŠ¨ç«¯<br/>React Native<br/>- åŸç”Ÿè¯­éŸ³API<br/>- ç¦»çº¿ç¼“å­˜<br/>- æ¨é€é€šçŸ¥]
        DESKTOP[æ¡Œé¢ç«¯<br/>Electron<br/>- ç³»ç»Ÿé›†æˆ<br/>- å¿«æ·é”®æ”¯æŒ<br/>- æœ¬åœ°å­˜å‚¨]
        MINIAPP[å°ç¨‹åº<br/>å¾®ä¿¡å°ç¨‹åº<br/>- è½»é‡åŒ–äº¤äº’<br/>- ç¤¾äº¤åˆ†äº«<br/>- å¿«é€Ÿå¯åŠ¨]
        EXTENSION[æµè§ˆå™¨æ’ä»¶<br/>Chrome Extension<br/>- é¡µé¢å†…å®¹åˆ†æ<br/>- å¿«é€ŸæŸ¥è¯¢<br/>- ä¸Šä¸‹æ–‡æ„ŸçŸ¥]
    end

    subgraph "APIç½‘å…³å±‚"
        GATEWAY[API Gateway<br/>Go + Gin<br/>- è·¯ç”±åˆ†å‘<br/>- è®¤è¯æˆæƒ<br/>- é™æµç†”æ–­<br/>- ç›‘æ§æ—¥å¿—]
        LB[è´Ÿè½½å‡è¡¡<br/>- å¥åº·æ£€æŸ¥<br/>- æ•…éšœè½¬ç§»<br/>- æµé‡åˆ†å‘]
    end

    subgraph "æ ¸å¿ƒæœåŠ¡å±‚"
        subgraph "ä¸šåŠ¡æœåŠ¡"
            CHAT[å¯¹è¯æœåŠ¡<br/>Go Service<br/>- ä¼šè¯ç®¡ç†<br/>- ä¸Šä¸‹æ–‡ç»´æŠ¤<br/>- å¤šè½®å¯¹è¯<br/>- æ„å›¾è¯†åˆ«]
            USER[ç”¨æˆ·æœåŠ¡<br/>Go Service<br/>- ç”¨æˆ·ç®¡ç†<br/>- æƒé™æ§åˆ¶<br/>- ä¸ªæ€§åŒ–é…ç½®<br/>- ä½¿ç”¨ç»Ÿè®¡]
            DATASET[æ•°æ®é›†æœåŠ¡<br/>Go Service<br/>- çŸ¥è¯†åº“ç®¡ç†<br/>- æ–‡æ¡£å¤„ç†<br/>- ç‰ˆæœ¬æ§åˆ¶<br/>- è´¨é‡è¯„ä¼°]
        end
        
        subgraph "AIç®—æ³•å¼•æ“"
            RAG[RAGå¼•æ“<br/>Python + FastAPI<br/>- æ–‡æ¡£æ£€ç´¢<br/>- å‘é‡æœç´¢<br/>- é‡æ’åº<br/>- ç­”æ¡ˆç”Ÿæˆ]
            VOICE[è¯­éŸ³å¤„ç†<br/>Python Service<br/>- è¯­éŸ³è¯†åˆ«<br/>- è¯­éŸ³åˆæˆ<br/>- æƒ…æ„Ÿåˆ†æ<br/>- è¯­éŸ³å¢å¼º]
            MULTIMODAL[å¤šæ¨¡æ€èåˆ<br/>Python Service<br/>- å›¾åƒç†è§£<br/>- è§†é¢‘åˆ†æ<br/>- æ–‡æ¡£è§£æ<br/>- è·¨æ¨¡æ€æ£€ç´¢]
        end
        
        subgraph "æ™ºèƒ½è·¯ç”±"
            ROUTER[æ¨¡å‹è·¯ç”±å™¨<br/>Python Service<br/>- æ™ºèƒ½åˆ†å‘<br/>- è´Ÿè½½å‡è¡¡<br/>- æˆæœ¬ä¼˜åŒ–<br/>- æ€§èƒ½ç›‘æ§]
            BATCH[æ‰¹å¤„ç†æœåŠ¡<br/>Python Service<br/>- è¯·æ±‚åˆå¹¶<br/>- å¼‚æ­¥å¤„ç†<br/>- ä¼˜å…ˆçº§è°ƒåº¦<br/>- èµ„æºä¼˜åŒ–]
        end
    end

    subgraph "æ•°æ®å­˜å‚¨å±‚"
        subgraph "å…³ç³»å‹æ•°æ®åº“"
            POSTGRES[(PostgreSQL<br/>ä¸»æ•°æ®åº“<br/>- ç”¨æˆ·æ•°æ®<br/>- ä¼šè¯è®°å½•<br/>- ç³»ç»Ÿé…ç½®<br/>- å®¡è®¡æ—¥å¿—)]
        end
        
        subgraph "ç¼“å­˜å±‚"
            REDIS[(Redis<br/>ç¼“å­˜æ•°æ®åº“<br/>- ä¼šè¯ç¼“å­˜<br/>- çƒ­ç‚¹æ•°æ®<br/>- åˆ†å¸ƒå¼é”<br/>- æ¶ˆæ¯é˜Ÿåˆ—)]
        end
        
        subgraph "å‘é‡æ•°æ®åº“"
            MILVUS[(Milvus<br/>å‘é‡æ•°æ®åº“<br/>- æ–‡æ¡£å‘é‡<br/>- è¯­ä¹‰æœç´¢<br/>- ç›¸ä¼¼åº¦è®¡ç®—<br/>- ç´¢å¼•ä¼˜åŒ–)]
        end
        
        subgraph "å›¾æ•°æ®åº“"
            NEO4J[(Neo4j<br/>å›¾æ•°æ®åº“<br/>- çŸ¥è¯†å›¾è°±<br/>- å…³ç³»æ¨ç†<br/>- è·¯å¾„æŸ¥è¯¢<br/>- å›¾ç®—æ³•)]
        end
        
        subgraph "å¯¹è±¡å­˜å‚¨"
            MINIO[(MinIO<br/>å¯¹è±¡å­˜å‚¨<br/>- æ–‡ä»¶å­˜å‚¨<br/>- å¤šåª’ä½“èµ„æº<br/>- å¤‡ä»½å½’æ¡£<br/>- CDNåŠ é€Ÿ)]
        end
    end

    subgraph "å¤–éƒ¨æœåŠ¡é›†æˆ"
        subgraph "AIæ¨¡å‹æœåŠ¡"
            ARK[è±†åŒ…å¤§æ¨¡å‹<br/>Ark API<br/>- å¯¹è¯ç”Ÿæˆ<br/>- æ–‡æœ¬åµŒå…¥<br/>- å¤šè½®å¯¹è¯<br/>- å‡½æ•°è°ƒç”¨]
            OPENAI[OpenAI<br/>å¤‡ç”¨æ¨¡å‹<br/>- GPTç³»åˆ—<br/>- åµŒå…¥æ¨¡å‹<br/>- å›¾åƒç”Ÿæˆ<br/>- ä»£ç ç”Ÿæˆ]
        end
        
        subgraph "åŸºç¡€è®¾æ–½"
            WECHAT[å¾®ä¿¡ç”Ÿæ€<br/>- å°ç¨‹åºAPI<br/>- æ”¯ä»˜æ¥å£<br/>- ç”¨æˆ·æˆæƒ<br/>- æ¶ˆæ¯æ¨é€]
            OSS[äº‘å­˜å‚¨<br/>- æ–‡ä»¶ä¸Šä¼ <br/>- CDNåˆ†å‘<br/>- å¤‡ä»½åŒæ­¥<br/>- å®‰å…¨è®¿é—®]
        end
    end

    subgraph "ç›‘æ§è¿ç»´å±‚"
        subgraph "ç›‘æ§ç³»ç»Ÿ"
            PROMETHEUS[Prometheus<br/>æŒ‡æ ‡æ”¶é›†<br/>- ç³»ç»ŸæŒ‡æ ‡<br/>- ä¸šåŠ¡æŒ‡æ ‡<br/>- å‘Šè­¦è§„åˆ™<br/>- æ•°æ®æŒä¹…åŒ–]
            GRAFANA[Grafana<br/>å¯è§†åŒ–é¢æ¿<br/>- å®æ—¶ç›‘æ§<br/>- å‘Šè­¦é€šçŸ¥<br/>- è¶‹åŠ¿åˆ†æ<br/>- æŠ¥è¡¨ç”Ÿæˆ]
        end
        
        subgraph "æ—¥å¿—ç³»ç»Ÿ"
            ELK[ELK Stack<br/>- Elasticsearch<br/>- Logstash<br/>- Kibana<br/>- æ—¥å¿—åˆ†æ]
        end
        
        subgraph "é“¾è·¯è¿½è¸ª"
            JAEGER[Jaeger<br/>åˆ†å¸ƒå¼è¿½è¸ª<br/>- è¯·æ±‚é“¾è·¯<br/>- æ€§èƒ½åˆ†æ<br/>- é”™è¯¯å®šä½<br/>- ä¾èµ–å…³ç³»]
        end
    end

    %% è¿æ¥å…³ç³»
    WEB --> GATEWAY
    MOBILE --> GATEWAY
    DESKTOP --> GATEWAY
    MINIAPP --> GATEWAY
    EXTENSION --> GATEWAY
    
    GATEWAY --> LB
    LB --> CHAT
    LB --> USER
    LB --> DATASET
    
    CHAT --> RAG
    CHAT --> VOICE
    CHAT --> MULTIMODAL
    
    RAG --> ROUTER
    VOICE --> ROUTER
    MULTIMODAL --> ROUTER
    
    ROUTER --> BATCH
    BATCH --> ARK
    BATCH --> OPENAI
    
    CHAT --> POSTGRES
    CHAT --> REDIS
    RAG --> MILVUS
    RAG --> NEO4J
    DATASET --> MINIO
    
    PROMETHEUS --> GRAFANA
    ELK --> KIBANA
    JAEGER --> TRACE_UI

    %% æ ·å¼å®šä¹‰
    classDef frontend fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef gateway fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef service fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef ai fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef storage fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    classDef external fill:#e0f2f1,stroke:#00695c,stroke-width:2px
    classDef monitor fill:#f1f8e9,stroke:#558b2f,stroke-width:2px

    class WEB,MOBILE,DESKTOP,MINIAPP,EXTENSION frontend
    class GATEWAY,LB gateway
    class CHAT,USER,DATASET service
    class RAG,VOICE,MULTIMODAL,ROUTER,BATCH ai
    class POSTGRES,REDIS,MILVUS,NEO4J,MINIO storage
    class ARK,OPENAI,WECHAT,OSS external
    class PROMETHEUS,GRAFANA,ELK,JAEGER monitor
```text

### 1.2 æ ¸å¿ƒæ•°æ®ç»“æ„

#### 1.2.1 å¯¹è¯æœåŠ¡æ ¸å¿ƒç»“æ„

```go
// å¯¹è¯æœåŠ¡ä¸»ç»“æ„ä½“
// æ–‡ä»¶è·¯å¾„: backend/internal/service/chat.go
type ChatService struct {
    // æ•°æ®åº“è¿æ¥
    db     *sql.DB
    cache  *redis.Client
    
    // AIæœåŠ¡å®¢æˆ·ç«¯
    ragClient    *rag.Client
    voiceClient  *voice.Client
    
    // é…ç½®å‚æ•°
    config *ChatConfig
    
    // ä¼šè¯ç®¡ç†å™¨
    sessionManager *SessionManager
    
    // æ¶ˆæ¯é˜Ÿåˆ—
    messageQueue chan *Message
    
    // ä¸Šä¸‹æ–‡ç®¡ç†
    contextManager *ContextManager
}

// ä¼šè¯ä¿¡æ¯ç»“æ„ä½“
type Session struct {
    ID          string                 `json:"id"`
    UserID      string                 `json:"user_id"`
    CreatedAt   time.Time             `json:"created_at"`
    UpdatedAt   time.Time             `json:"updated_at"`
    Context     map[string]interface{} `json:"context"`
    Messages    []*Message            `json:"messages"`
    Status      SessionStatus         `json:"status"`
    Metadata    *SessionMetadata      `json:"metadata"`
}

// æ¶ˆæ¯ç»“æ„ä½“
type Message struct {
    ID          string      `json:"id"`
    SessionID   string      `json:"session_id"`
    Role        MessageRole `json:"role"`
    Content     string      `json:"content"`
    ContentType ContentType `json:"content_type"`
    Timestamp   time.Time   `json:"timestamp"`
    Metadata    *MessageMetadata `json:"metadata"`
}

// RAGæ£€ç´¢ç»“æœ
type RetrievalResult struct {
    Documents   []*Document `json:"documents"`
    Scores      []float64   `json:"scores"`
    Query       string      `json:"query"`
    TotalTime   time.Duration `json:"total_time"`
    RetrievalTime time.Duration `json:"retrieval_time"`
    RerankTime    time.Duration `json:"rerank_time"`
}
```text

#### 1.2.2 RAGå¼•æ“æ ¸å¿ƒç»“æ„

```python
# RAGå¼•æ“ä¸»ç±»
# æ–‡ä»¶è·¯å¾„: algo/core/retrieve.py
class RetrieveService:
    """RAGæ£€ç´¢æœåŠ¡æ ¸å¿ƒå®ç°"""
    
    def __init__(self):
        self.embeddings = get_embeddings()
        self.milvus = Milvus(
            embedding_function=self.embeddings,
            collection_name=config.DEFAULT_COLLECTION_NAME,
            connection_args={
                "host": config.MILVUS_HOST,
                "port": config.MILVUS_PORT,
                "user": config.MILVUS_USER,
                "password": config.MILVUS_PASSWORD,
            }
        )
        self.reranker = CrossEncoder('BAAI/bge-reranker-m3')
        self.llm_client = ArkClient(
            api_key=config.ARK_API_KEY,
            base_url=config.ARK_BASE_URL
        )
    
    async def stream_query(self, request: QueryRequest) -> AsyncGenerator[str, None]:
        """æµå¼æŸ¥è¯¢å¤„ç†ä¸»æµç¨‹"""
        try:
            # 1. æå–ç”¨æˆ·æŸ¥è¯¢
            user_query = self._extract_user_query(request.messages)
            
            # 2. æ£€ç´¢ç›¸å…³æ–‡æ¡£
            references = await self._retrieve_documents(
                user_query, 
                request.top_k,
                request.filters
            )
            
            # 3. é‡æ’åºä¼˜åŒ–
            if references and len(references) > 1:
                references = await self._rerank_documents(user_query, references)
            
            # 4. æ„å»ºæç¤ºè¯
            prompt = self._build_prompt(request.messages, references)
            
            # 5. è°ƒç”¨å¤§æ¨¡å‹æµå¼ç”Ÿæˆ
            async for response in self._stream_llm_response(prompt, request):
                yield response
                
        except Exception as e:
            logger.error(f"Stream query error: {e}")
            yield self._format_error_response(str(e))

# æ–‡æ¡£ç»“æ„ä½“
@dataclass
class Document:
    """æ–‡æ¡£ä¿¡æ¯ç»“æ„"""
    chunk_id: str
    source: str
    content: str
    metadata: Dict[str, Any]
    score: float = 0.0
    embedding: Optional[List[float]] = None

# æŸ¥è¯¢è¯·æ±‚ç»“æ„ä½“
@dataclass
class QueryRequest:
    """æŸ¥è¯¢è¯·æ±‚ç»“æ„"""
    messages: List[Message]
    top_k: int = 5
    temperature: float = 0.7
    max_tokens: int = 2000
    filters: Optional[Dict[str, Any]] = None
    stream: bool = True
```text

## 2. å‰ç«¯æ¨¡å—æ·±åº¦è§£æ

### 2.1 Next.jsåº”ç”¨æ¶æ„

```typescript
// å‰ç«¯åº”ç”¨ä¸»å…¥å£
// æ–‡ä»¶è·¯å¾„: frontend/app/layout.tsx
export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="zh-CN">
      <body className={inter.className}>
        <Providers>
          <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
            <Header />
            <main className="container mx-auto px-4 py-8">
              {children}
            </main>
            <Footer />
          </div>
          <Toaster />
        </Providers>
      </body>
    </html>
  )
}

// å®æ—¶é€šä¿¡Hook
// æ–‡ä»¶è·¯å¾„: frontend/hooks/useWebSocket.ts
export function useWebSocket(url: string) {
  const [socket, setSocket] = useState<WebSocket | null>(null)
  const [connectionStatus, setConnectionStatus] = useState<ConnectionStatus>('Disconnected')
  const [messageHistory, setMessageHistory] = useState<MessageEvent[]>([])

  const sendMessage = useCallback((message: any) => {
    if (socket && socket.readyState === WebSocket.OPEN) {
      socket.send(JSON.stringify(message))
    }
  }, [socket])

  useEffect(() => {
    const ws = new WebSocket(url)
    
    ws.onopen = () => {
      setConnectionStatus('Connected')
      setSocket(ws)
    }
    
    ws.onmessage = (event) => {
      const message = JSON.parse(event.data)
      setMessageHistory(prev => [...prev, message])
    }
    
    ws.onclose = () => {
      setConnectionStatus('Disconnected')
      setSocket(null)
    }
    
    return () => {
      ws.close()
    }
  }, [url])

  return { socket, connectionStatus, messageHistory, sendMessage }
}
```text

### 2.2 å®æ—¶é€šä¿¡æœºåˆ¶

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant Frontend as å‰ç«¯åº”ç”¨
    participant Gateway as APIç½‘å…³
    participant ChatService as å¯¹è¯æœåŠ¡
    participant RAGEngine as RAGå¼•æ“
    participant LLM as å¤§æ¨¡å‹

    User->>Frontend: å‘é€è¯­éŸ³/æ–‡æœ¬æ¶ˆæ¯
    Frontend->>Frontend: é¢„å¤„ç†(è¯­éŸ³è½¬æ–‡å­—/æ ¼å¼åŒ–)
    Frontend->>Gateway: WebSocketè¿æ¥å»ºç«‹
    Gateway->>ChatService: è½¬å‘æ¶ˆæ¯
    
    ChatService->>ChatService: ä¼šè¯ç®¡ç†
    ChatService->>RAGEngine: å‘èµ·æ£€ç´¢è¯·æ±‚
    
    RAGEngine->>RAGEngine: å‘é‡æ£€ç´¢
    RAGEngine->>RAGEngine: æ–‡æ¡£é‡æ’åº
    RAGEngine->>LLM: æ„å»ºæç¤ºè¯
    
    LLM-->>RAGEngine: æµå¼å“åº”å¼€å§‹
    RAGEngine-->>ChatService: è½¬å‘æµå¼æ•°æ®
    ChatService-->>Gateway: WebSocketæ¨é€
    Gateway-->>Frontend: å®æ—¶æ›´æ–°UI
    Frontend-->>User: æ˜¾ç¤ºå›ç­”å†…å®¹
    
    loop æµå¼å“åº”
        LLM-->>RAGEngine: ç»§ç»­ç”Ÿæˆå†…å®¹
        RAGEngine-->>ChatService: è½¬å‘æ•°æ®å—
        ChatService-->>Gateway: WebSocketæ¨é€
        Gateway-->>Frontend: æ›´æ–°æ˜¾ç¤º
    end
    
    LLM-->>RAGEngine: å“åº”ç»“æŸ
    RAGEngine->>ChatService: ä¿å­˜ä¼šè¯è®°å½•
    ChatService->>ChatService: æ›´æ–°ä¸Šä¸‹æ–‡
```text

### 2.3 å¤šç«¯é€‚é…ç­–ç•¥

```typescript
// å¤šç«¯é€‚é…é…ç½®
// æ–‡ä»¶è·¯å¾„: frontend/lib/platform.ts
export class PlatformAdapter {
  private platform: Platform
  
  constructor() {
    this.platform = this.detectPlatform()
  }
  
  detectPlatform(): Platform {
    if (typeof window === 'undefined') return 'server'
    
    const userAgent = window.navigator.userAgent
    
    if (/MicroMessenger/i.test(userAgent)) return 'wechat'
    if (/Mobile|Android|iPhone|iPad/i.test(userAgent)) return 'mobile'
    if (/Electron/i.test(userAgent)) return 'desktop'
    
    return 'web'
  }
  
  getApiConfig(): ApiConfig {
    const baseConfigs = {
      web: {
        baseURL: process.env.NEXT_PUBLIC_API_URL,
        timeout: 30000,
        enableWebSocket: true,
      },
      mobile: {
        baseURL: process.env.NEXT_PUBLIC_API_URL,
        timeout: 15000,
        enableWebSocket: true,
      },
      wechat: {
        baseURL: process.env.NEXT_PUBLIC_API_URL,
        timeout: 10000,
        enableWebSocket: false, // å¾®ä¿¡å°ç¨‹åºä½¿ç”¨è½®è¯¢
      },
      desktop: {
        baseURL: 'http://localhost:8080',
        timeout: 60000,
        enableWebSocket: true,
      }
    }
    
    return baseConfigs[this.platform] || baseConfigs.web
  }
}
```text

## 3. åç«¯æœåŠ¡æ ¸å¿ƒå®ç°

### 3.1 Goå¾®æœåŠ¡æ¶æ„

```go
// æœåŠ¡å¯åŠ¨ä¸»æµç¨‹
// æ–‡ä»¶è·¯å¾„: backend/cmd/server/main.go
func main() {
    // 1. åŠ è½½é…ç½®
    config := loadConfig()
    
    // 2. åˆå§‹åŒ–æ—¥å¿—
    setupLogger(config.LogLevel)
    
    // 3. åˆå§‹åŒ–æ•°æ®åº“è¿æ¥
    db, err := database.NewConnection(config.DatabaseURL)
    if err != nil {
        log.Fatal("Failed to connect database:", err)
    }
    defer db.Close()
    
    // 4. åˆå§‹åŒ–Redisè¿æ¥
    rdb := redis.NewClient(&redis.Options{
        Addr:     config.RedisAddr,
        Password: config.RedisPassword,
        DB:       config.RedisDB,
    })
    defer rdb.Close()
    
    // 5. åˆå§‹åŒ–æœåŠ¡å±‚
    services := &service.Services{
        Chat:    service.NewChatService(db, rdb),
        User:    service.NewUserService(db, rdb),
        Dataset: service.NewDatasetService(db, rdb),
    }
    
    // 6. åˆå§‹åŒ–å¤„ç†å™¨
    handlers := handler.NewHandlers(services)
    
    // 7. è®¾ç½®è·¯ç”±
    router := setupRouter(config, handlers)
    
    // 8. å¯åŠ¨æœåŠ¡å™¨
    server := &http.Server{
        Addr:    ":" + config.Port,
        Handler: router,
    }
    
    // 9. ä¼˜é›…å…³é—­
    gracefulShutdown(server)
}

// ä¸­é—´ä»¶é“¾è·¯è®¾è®¡
// æ–‡ä»¶è·¯å¾„: backend/pkg/middleware/chain.go
type MiddlewareChain struct {
    middlewares []Middleware
}

func NewMiddlewareChain() *MiddlewareChain {
    return &MiddlewareChain{
        middlewares: make([]Middleware, 0),
    }
}

func (mc *MiddlewareChain) Use(middleware Middleware) *MiddlewareChain {
    mc.middlewares = append(mc.middlewares, middleware)
    return mc
}

func (mc *MiddlewareChain) Build() gin.HandlerFunc {
    return gin.HandlerFunc(func(c *gin.Context) {
        // æ„å»ºä¸­é—´ä»¶è°ƒç”¨é“¾
        var handler gin.HandlerFunc = func(c *gin.Context) {
            c.Next()
        }
        
        // åå‘éå†ï¼Œæ„å»ºæ´‹è‘±æ¨¡å‹
        for i := len(mc.middlewares) - 1; i >= 0; i-- {
            middleware := mc.middlewares[i]
            next := handler
            handler = func(c *gin.Context) {
                middleware(c, next)
            }
        }
        
        handler(c)
    })
}
```text

### 3.2 APIç½‘å…³è®¾è®¡

```go
// APIç½‘å…³æ ¸å¿ƒå®ç°
// æ–‡ä»¶è·¯å¾„: backend/internal/handler/handler.go
type Handler struct {
    services *service.Services
    config   *Config
    
    // é™æµå™¨
    rateLimiter *rate.Limiter
    
    // ç†”æ–­å™¨
    circuitBreaker *hystrix.CircuitBreaker
    
    // ç›‘æ§æŒ‡æ ‡
    metrics *prometheus.Registry
}

// ç»Ÿä¸€è¯·æ±‚å¤„ç†
func (h *Handler) HandleRequest(c *gin.Context) {
    // 1. è¯·æ±‚é¢„å¤„ç†
    requestID := generateRequestID()
    c.Set("request_id", requestID)
    
    // 2. è®¤è¯æˆæƒ
    if err := h.authenticate(c); err != nil {
        c.JSON(http.StatusUnauthorized, gin.H{"error": err.Error()})
        return
    }
    
    // 3. é™æµæ£€æŸ¥
    if !h.rateLimiter.Allow() {
        c.JSON(http.StatusTooManyRequests, gin.H{"error": "Rate limit exceeded"})
        return
    }
    
    // 4. è·¯ç”±åˆ†å‘
    switch c.Request.URL.Path {
    case "/api/v1/chat":
        h.handleChat(c)
    case "/api/v1/voice":
        h.handleVoice(c)
    case "/api/v1/dataset":
        h.handleDataset(c)
    default:
        c.JSON(http.StatusNotFound, gin.H{"error": "Endpoint not found"})
    }
}

// WebSocketå¤„ç†
func (h *Handler) HandleWebSocket(c *gin.Context) {
    // å‡çº§ä¸ºWebSocketè¿æ¥
    conn, err := upgrader.Upgrade(c.Writer, c.Request, nil)
    if err != nil {
        log.Error("WebSocket upgrade failed:", err)
        return
    }
    defer conn.Close()
    
    // åˆ›å»ºä¼šè¯
    session := &WebSocketSession{
        ID:         generateSessionID(),
        Connection: conn,
        UserID:     c.GetString("user_id"),
        CreatedAt:  time.Now(),
    }
    
    // å¯åŠ¨æ¶ˆæ¯å¤„ç†åç¨‹
    go h.handleWebSocketMessages(session)
    
    // ä¿æŒè¿æ¥
    h.keepWebSocketAlive(session)
}
```text

### 3.3 ä¸­é—´ä»¶é“¾è·¯

```go
// è®¤è¯ä¸­é—´ä»¶
// æ–‡ä»¶è·¯å¾„: backend/pkg/middleware/auth.go
func AuthMiddleware(jwtSecret string) gin.HandlerFunc {
    return gin.HandlerFunc(func(c *gin.Context) {
        token := extractToken(c)
        if token == "" {
            c.JSON(http.StatusUnauthorized, gin.H{"error": "Missing token"})
            c.Abort()
            return
        }
        
        claims, err := validateJWT(token, jwtSecret)
        if err != nil {
            c.JSON(http.StatusUnauthorized, gin.H{"error": "Invalid token"})
            c.Abort()
            return
        }
        
        c.Set("user_id", claims.UserID)
        c.Set("user_role", claims.Role)
        c.Next()
    })
}

// é™æµä¸­é—´ä»¶
func RateLimitMiddleware(rate int, burst int) gin.HandlerFunc {
    limiter := rate.NewLimiter(rate.Limit(rate), burst)
    
    return gin.HandlerFunc(func(c *gin.Context) {
        if !limiter.Allow() {
            c.JSON(http.StatusTooManyRequests, gin.H{
                "error": "Rate limit exceeded",
                "retry_after": limiter.Reserve().Delay().Seconds(),
            })
            c.Abort()
            return
        }
        c.Next()
    })
}

// ç›‘æ§ä¸­é—´ä»¶
func MetricsMiddleware(registry *prometheus.Registry) gin.HandlerFunc {
    requestDuration := prometheus.NewHistogramVec(
        prometheus.HistogramOpts{
            Name: "http_request_duration_seconds",
            Help: "HTTP request duration in seconds",
        },
        []string{"method", "endpoint", "status"},
    )
    registry.MustRegister(requestDuration)
    
    return gin.HandlerFunc(func(c *gin.Context) {
        start := time.Now()
        
        c.Next()
        
        duration := time.Since(start).Seconds()
        requestDuration.WithLabelValues(
            c.Request.Method,
            c.FullPath(),
            strconv.Itoa(c.Writer.Status()),
        ).Observe(duration)
    })
}
```text

## 4. AIç®—æ³•å¼•æ“æ·±åº¦åˆ†æ

### 4.1 RAGç³»ç»Ÿå®ç°

```python
# RAGç³»ç»Ÿæ ¸å¿ƒå®ç°
# æ–‡ä»¶è·¯å¾„: algo/core/advanced_rag.py
class AdvancedRAGSystem:
    """é«˜çº§RAGç³»ç»Ÿå®ç°"""
    
    def __init__(self):
        self.embeddings = self._init_embeddings()
        self.vector_store = self._init_vector_store()
        self.reranker = self._init_reranker()
        self.llm_client = self._init_llm_client()
        self.graph_store = self._init_graph_store()
        
    async def hybrid_retrieve(self, query: str, top_k: int = 10) -> List[Document]:
        """æ··åˆæ£€ç´¢ç­–ç•¥"""
        # 1. å‘é‡æ£€ç´¢
        vector_results = await self._vector_retrieve(query, top_k * 2)
        
        # 2. å…³é”®è¯æ£€ç´¢
        keyword_results = await self._keyword_retrieve(query, top_k * 2)
        
        # 3. å›¾æ£€ç´¢
        graph_results = await self._graph_retrieve(query, top_k)
        
        # 4. ç»“æœèåˆ
        combined_results = self._combine_results(
            vector_results, keyword_results, graph_results
        )
        
        # 5. é‡æ’åº
        reranked_results = await self._rerank_documents(query, combined_results)
        
        return reranked_results[:top_k]
    
    async def _vector_retrieve(self, query: str, top_k: int) -> List[Document]:
        """å‘é‡æ£€ç´¢å®ç°"""
        # æŸ¥è¯¢å‘é‡åŒ–
        query_embedding = await self.embeddings.embed_query(query)
        
        # Milvusæ£€ç´¢
        search_params = {
            "metric_type": "COSINE",
            "params": {"nprobe": 16}
        }
        
        results = self.vector_store.search(
            data=[query_embedding],
            anns_field="embedding",
            param=search_params,
            limit=top_k,
            expr=None
        )
        
        documents = []
        for result in results[0]:
            doc = Document(
                chunk_id=result.id,
                content=result.entity.get("content"),
                source=result.entity.get("source"),
                score=result.distance,
                metadata=result.entity.get("metadata", {})
            )
            documents.append(doc)
            
        return documents
    
    async def _rerank_documents(self, query: str, documents: List[Document]) -> List[Document]:
        """æ–‡æ¡£é‡æ’åº"""
        if len(documents) <= 1:
            return documents
            
        # å‡†å¤‡é‡æ’åºè¾“å…¥
        pairs = [(query, doc.content) for doc in documents]
        
        # è®¡ç®—ç›¸å…³æ€§åˆ†æ•°
        scores = self.reranker.predict(pairs)
        
        # æ›´æ–°æ–‡æ¡£åˆ†æ•°å¹¶æ’åº
        for doc, score in zip(documents, scores):
            doc.score = float(score)
            
        return sorted(documents, key=lambda x: x.score, reverse=True)

# å¤šæ¨¡æ€èåˆå®ç°
class MultimodalFusion:
    """å¤šæ¨¡æ€èåˆå¤„ç†"""
    
    def __init__(self):
        self.text_processor = TextProcessor()
        self.image_processor = ImageProcessor()
        self.audio_processor = AudioProcessor()
        self.fusion_model = FusionModel()
    
    async def process_multimodal_input(self, inputs: Dict[str, Any]) -> Dict[str, Any]:
        """å¤„ç†å¤šæ¨¡æ€è¾“å…¥"""
        features = {}
        
        # æ–‡æœ¬ç‰¹å¾æå–
        if 'text' in inputs:
            features['text'] = await self.text_processor.extract_features(inputs['text'])
        
        # å›¾åƒç‰¹å¾æå–
        if 'image' in inputs:
            features['image'] = await self.image_processor.extract_features(inputs['image'])
        
        # éŸ³é¢‘ç‰¹å¾æå–
        if 'audio' in inputs:
            features['audio'] = await self.audio_processor.extract_features(inputs['audio'])
        
        # ç‰¹å¾èåˆ
        fused_features = self.fusion_model.fuse(features)
        
        return {
            'features': fused_features,
            'modalities': list(features.keys()),
            'confidence': self._calculate_confidence(features)
        }
```text

### 4.2 è¯­éŸ³å¤„ç†æµæ°´çº¿

```python
# è¯­éŸ³å¤„ç†æ ¸å¿ƒå®ç°
# æ–‡ä»¶è·¯å¾„: algo/core/voice.py
class VoiceService:
    """è¯­éŸ³å¤„ç†æœåŠ¡"""
    
    def __init__(self):
        self.asr_model = self._load_asr_model()
        self.tts_model = self._load_tts_model()
        self.emotion_analyzer = EmotionAnalyzer()
        self.voice_enhancer = VoiceEnhancer()
        
    async def process_voice_input(self, audio_data: bytes) -> VoiceProcessResult:
        """è¯­éŸ³è¾“å…¥å¤„ç†æµæ°´çº¿"""
        try:
            # 1. éŸ³é¢‘é¢„å¤„ç†
            enhanced_audio = await self.voice_enhancer.enhance(audio_data)
            
            # 2. è¯­éŸ³è¯†åˆ«
            transcript = await self.asr_model.transcribe(enhanced_audio)
            
            # 3. æƒ…æ„Ÿåˆ†æ
            emotion = await self.emotion_analyzer.analyze(enhanced_audio)
            
            # 4. è¯­éŸ³ç‰¹å¾æå–
            voice_features = await self._extract_voice_features(enhanced_audio)
            
            return VoiceProcessResult(
                transcript=transcript,
                emotion=emotion,
                features=voice_features,
                confidence=transcript.confidence,
                processing_time=time.time() - start_time
            )
            
        except Exception as e:
            logger.error(f"Voice processing error: {e}")
            raise VoiceProcessingError(str(e))
    
    async def synthesize_speech(self, text: str, voice_config: VoiceConfig) -> bytes:
        """è¯­éŸ³åˆæˆ"""
        try:
            # 1. æ–‡æœ¬é¢„å¤„ç†
            processed_text = self._preprocess_text(text)
            
            # 2. è¯­éŸ³åˆæˆ
            audio_data = await self.tts_model.synthesize(
                text=processed_text,
                voice_id=voice_config.voice_id,
                speed=voice_config.speed,
                pitch=voice_config.pitch,
                emotion=voice_config.emotion
            )
            
            # 3. éŸ³é¢‘åå¤„ç†
            enhanced_audio = await self.voice_enhancer.post_process(audio_data)
            
            return enhanced_audio
            
        except Exception as e:
            logger.error(f"Speech synthesis error: {e}")
            raise SpeechSynthesisError(str(e))

# æƒ…æ„Ÿè¯†åˆ«å®ç°
class EmotionAnalyzer:
    """è¯­éŸ³æƒ…æ„Ÿåˆ†æ"""
    
    def __init__(self):
        self.model = self._load_emotion_model()
        self.feature_extractor = AudioFeatureExtractor()
    
    async def analyze(self, audio_data: bytes) -> EmotionResult:
        """åˆ†æè¯­éŸ³æƒ…æ„Ÿ"""
        # ç‰¹å¾æå–
        features = self.feature_extractor.extract(audio_data)
        
        # æƒ…æ„Ÿé¢„æµ‹
        emotion_probs = self.model.predict(features)
        
        # ç»“æœè§£æ
        emotions = {
            'happy': float(emotion_probs[0]),
            'sad': float(emotion_probs[1]),
            'angry': float(emotion_probs[2]),
            'neutral': float(emotion_probs[3]),
            'excited': float(emotion_probs[4])
        }
        
        primary_emotion = max(emotions.items(), key=lambda x: x[1])
        
        return EmotionResult(
            primary_emotion=primary_emotion[0],
            confidence=primary_emotion[1],
            all_emotions=emotions
        )
```text

### 4.3 å¤šæ¨¡æ€èåˆ

```python
# å¤šæ¨¡æ€èåˆæ ¸å¿ƒå®ç°
# æ–‡ä»¶è·¯å¾„: algo/core/multimodal_fusion.py
class MultimodalFusionEngine:
    """å¤šæ¨¡æ€èåˆå¼•æ“"""
    
    def __init__(self):
        self.text_encoder = TextEncoder()
        self.image_encoder = ImageEncoder()
        self.audio_encoder = AudioEncoder()
        self.fusion_transformer = FusionTransformer()
        self.attention_mechanism = CrossModalAttention()
    
    async def fuse_modalities(self, inputs: MultimodalInput) -> FusionResult:
        """å¤šæ¨¡æ€èåˆå¤„ç†"""
        encodings = {}
        attention_weights = {}
        
        # 1. å„æ¨¡æ€ç¼–ç 
        if inputs.text:
            encodings['text'] = await self.text_encoder.encode(inputs.text)
        
        if inputs.image:
            encodings['image'] = await self.image_encoder.encode(inputs.image)
        
        if inputs.audio:
            encodings['audio'] = await self.audio_encoder.encode(inputs.audio)
        
        # 2. è·¨æ¨¡æ€æ³¨æ„åŠ›è®¡ç®—
        for modality1 in encodings:
            for modality2 in encodings:
                if modality1 != modality2:
                    attention_weights[f"{modality1}_{modality2}"] = \
                        self.attention_mechanism.compute_attention(
                            encodings[modality1], encodings[modality2]
                        )
        
        # 3. ç‰¹å¾èåˆ
        fused_features = self.fusion_transformer.fuse(
            encodings, attention_weights
        )
        
        # 4. ç”Ÿæˆç»Ÿä¸€è¡¨ç¤º
        unified_representation = self._generate_unified_representation(
            fused_features, encodings
        )
        
        return FusionResult(
            unified_representation=unified_representation,
            modality_weights=self._calculate_modality_weights(attention_weights),
            confidence=self._calculate_fusion_confidence(encodings),
            processing_time=time.time() - start_time
        )
    
    def _calculate_modality_weights(self, attention_weights: Dict) -> Dict[str, float]:
        """è®¡ç®—å„æ¨¡æ€æƒé‡"""
        weights = {}
        for key, weight_matrix in attention_weights.items():
            modalities = key.split('_')
            for modality in modalities:
                if modality not in weights:
                    weights[modality] = 0.0
                weights[modality] += np.mean(weight_matrix)
        
        # å½’ä¸€åŒ–
        total_weight = sum(weights.values())
        return {k: v / total_weight for k, v in weights.items()}
```text

## 5. æ•°æ®å­˜å‚¨æ¶æ„

### 5.1 å¤šæ•°æ®åº“è®¾è®¡

```go
// æ•°æ®åº“ç®¡ç†å™¨
// æ–‡ä»¶è·¯å¾„: backend/pkg/database/manager.go
type DatabaseManager struct {
    // å…³ç³»å‹æ•°æ®åº“
    postgres *sql.DB
    
    // ç¼“å­˜æ•°æ®åº“
    redis *redis.Client
    
    // å‘é‡æ•°æ®åº“
    milvus *milvus.Client
    
    // å›¾æ•°æ®åº“
    neo4j *neo4j.Driver
    
    // å¯¹è±¡å­˜å‚¨
    minio *minio.Client
    
    // è¿æ¥æ± é…ç½®
    config *DatabaseConfig
}

func NewDatabaseManager(config *DatabaseConfig) (*DatabaseManager, error) {
    dm := &DatabaseManager{config: config}
    
    // åˆå§‹åŒ–PostgreSQL
    if err := dm.initPostgreSQL(); err != nil {
        return nil, fmt.Errorf("failed to init PostgreSQL: %w", err)
    }
    
    // åˆå§‹åŒ–Redis
    if err := dm.initRedis(); err != nil {
        return nil, fmt.Errorf("failed to init Redis: %w", err)
    }
    
    // åˆå§‹åŒ–Milvus
    if err := dm.initMilvus(); err != nil {
        return nil, fmt.Errorf("failed to init Milvus: %w", err)
    }
    
    // åˆå§‹åŒ–Neo4j
    if err := dm.initNeo4j(); err != nil {
        return nil, fmt.Errorf("failed to init Neo4j: %w", err)
    }
    
    // åˆå§‹åŒ–MinIO
    if err := dm.initMinIO(); err != nil {
        return nil, fmt.Errorf("failed to init MinIO: %w", err)
    }
    
    return dm, nil
}

// æ•°æ®è®¿é—®å±‚æŠ½è±¡
type Repository interface {
    Create(ctx context.Context, entity interface{}) error
    GetByID(ctx context.Context, id string) (interface{}, error)
    Update(ctx context.Context, entity interface{}) error
    Delete(ctx context.Context, id string) error
    List(ctx context.Context, filter interface{}) ([]interface{}, error)
}

// ä¼šè¯ä»“å‚¨å®ç°
type SessionRepository struct {
    db    *sql.DB
    cache *redis.Client
}

func (r *SessionRepository) Create(ctx context.Context, session *Session) error {
    // 1. æ•°æ®åº“æŒä¹…åŒ–
    query := `
        INSERT INTO sessions (id, user_id, created_at, updated_at, context, status)
        VALUES ($1, $2, $3, $4, $5, $6)
    `
    _, err := r.db.ExecContext(ctx, query,
        session.ID, session.UserID, session.CreatedAt,
        session.UpdatedAt, session.Context, session.Status)
    if err != nil {
        return fmt.Errorf("failed to create session in DB: %w", err)
    }
    
    // 2. ç¼“å­˜æ›´æ–°
    sessionJSON, _ := json.Marshal(session)
    err = r.cache.Set(ctx, "session:"+session.ID, sessionJSON, time.Hour).Err()
    if err != nil {
        log.Warn("Failed to cache session:", err)
    }
    
    return nil
}
```text

### 5.2 å‘é‡æ•°æ®åº“ä¼˜åŒ–

```python
# å‘é‡æ•°æ®åº“ä¼˜åŒ–å®ç°
# æ–‡ä»¶è·¯å¾„: algo/core/vector_optimization.py
class VectorStoreOptimizer:
    """å‘é‡æ•°æ®åº“ä¼˜åŒ–å™¨"""
    
    def __init__(self, milvus_client):
        self.client = milvus_client
        self.index_configs = self._load_index_configs()
        self.search_configs = self._load_search_configs()
    
    async def optimize_collection(self, collection_name: str):
        """ä¼˜åŒ–é›†åˆæ€§èƒ½"""
        collection = Collection(collection_name)
        
        # 1. åˆ†ææ•°æ®åˆ†å¸ƒ
        stats = await self._analyze_data_distribution(collection)
        
        # 2. é€‰æ‹©æœ€ä¼˜ç´¢å¼•
        optimal_index = self._select_optimal_index(stats)
        
        # 3. åˆ›å»ºç´¢å¼•
        await self._create_optimized_index(collection, optimal_index)
        
        # 4. è°ƒæ•´æœç´¢å‚æ•°
        search_params = self._optimize_search_params(stats, optimal_index)
        
        return {
            'index_type': optimal_index['type'],
            'index_params': optimal_index['params'],
            'search_params': search_params,
            'performance_gain': stats['estimated_improvement']
        }
    
    def _select_optimal_index(self, stats: Dict) -> Dict:
        """é€‰æ‹©æœ€ä¼˜ç´¢å¼•ç±»å‹"""
        vector_count = stats['vector_count']
        dimension = stats['dimension']
        query_patterns = stats['query_patterns']
        
        if vector_count < 100000:
            # å°æ•°æ®é›†ä½¿ç”¨FLATç´¢å¼•
            return {
                'type': 'FLAT',
                'params': {},
                'metric_type': 'COSINE'
            }
        elif vector_count < 1000000:
            # ä¸­ç­‰æ•°æ®é›†ä½¿ç”¨IVF_FLAT
            nlist = min(4096, int(vector_count / 39))
            return {
                'type': 'IVF_FLAT',
                'params': {'nlist': nlist},
                'metric_type': 'COSINE'
            }
        else:
            # å¤§æ•°æ®é›†ä½¿ç”¨HNSW
            return {
                'type': 'HNSW',
                'params': {
                    'M': 16,
                    'efConstruction': 200
                },
                'metric_type': 'COSINE'
            }
    
    async def _create_optimized_index(self, collection, index_config):
        """åˆ›å»ºä¼˜åŒ–ç´¢å¼•"""
        # åˆ é™¤æ—§ç´¢å¼•
        try:
            collection.drop_index()
        except Exception:
            pass
        
        # åˆ›å»ºæ–°ç´¢å¼•
        collection.create_index(
            field_name="embedding",
            index_params={
                "index_type": index_config['type'],
                "params": index_config['params'],
                "metric_type": index_config['metric_type']
            }
        )
        
        # åŠ è½½ç´¢å¼•åˆ°å†…å­˜
        collection.load()

# æ™ºèƒ½ç¼“å­˜ç­–ç•¥
class IntelligentCache:
    """æ™ºèƒ½ç¼“å­˜ç®¡ç†"""
    
    def __init__(self, redis_client):
        self.redis = redis_client
        self.cache_stats = CacheStatistics()
        self.eviction_policy = LRUEvictionPolicy()
    
    async def get_or_compute(self, key: str, compute_func, ttl: int = 3600):
        """è·å–æˆ–è®¡ç®—ç¼“å­˜å€¼"""
        # 1. å°è¯•ä»ç¼“å­˜è·å–
        cached_value = await self.redis.get(key)
        if cached_value:
            self.cache_stats.record_hit(key)
            return json.loads(cached_value)
        
        # 2. ç¼“å­˜æœªå‘½ä¸­ï¼Œè®¡ç®—å€¼
        self.cache_stats.record_miss(key)
        computed_value = await compute_func()
        
        # 3. æ™ºèƒ½TTLè°ƒæ•´
        adjusted_ttl = self._adjust_ttl(key, ttl)
        
        # 4. å­˜å‚¨åˆ°ç¼“å­˜
        await self.redis.setex(
            key, 
            adjusted_ttl, 
            json.dumps(computed_value)
        )
        
        return computed_value
    
    def _adjust_ttl(self, key: str, base_ttl: int) -> int:
        """æ ¹æ®è®¿é—®æ¨¡å¼è°ƒæ•´TTL"""
        access_pattern = self.cache_stats.get_access_pattern(key)
        
        if access_pattern['frequency'] > 10:  # é«˜é¢‘è®¿é—®
            return base_ttl * 2
        elif access_pattern['frequency'] < 2:  # ä½é¢‘è®¿é—®
            return base_ttl // 2
        
        return base_ttl
```text

## 6. ç³»ç»Ÿäº¤äº’æ—¶åºå›¾

### 6.1 ç”¨æˆ·å¯¹è¯æµç¨‹

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as å‰ç«¯åº”ç”¨
    participant G as APIç½‘å…³
    participant C as å¯¹è¯æœåŠ¡
    participant R as RAGå¼•æ“
    participant V as å‘é‡æ•°æ®åº“
    participant L as å¤§æ¨¡å‹
    participant DB as æ•°æ®åº“

    U->>F: å‘é€æ¶ˆæ¯
    F->>F: æ¶ˆæ¯é¢„å¤„ç†
    F->>G: WebSocketæ¶ˆæ¯
    G->>G: è®¤è¯&é™æµ
    G->>C: è½¬å‘è¯·æ±‚
    
    C->>C: åˆ›å»º/è·å–ä¼šè¯
    C->>DB: æŸ¥è¯¢ä¼šè¯å†å²
    DB-->>C: è¿”å›å†å²è®°å½•
    
    C->>R: å‘èµ·RAGæ£€ç´¢
    R->>R: æŸ¥è¯¢é¢„å¤„ç†
    R->>V: å‘é‡æ£€ç´¢
    V-->>R: è¿”å›ç›¸ä¼¼æ–‡æ¡£
    R->>R: æ–‡æ¡£é‡æ’åº
    
    R->>L: æ„å»ºæç¤ºè¯
    L-->>R: å¼€å§‹æµå¼å“åº”
    
    loop æµå¼ç”Ÿæˆ
        R-->>C: è½¬å‘å“åº”å—
        C-->>G: WebSocketæ¨é€
        G-->>F: å®æ—¶æ›´æ–°
        F-->>U: æ˜¾ç¤ºå†…å®¹
    end
    
    R-->>C: å“åº”å®Œæˆ
    C->>DB: ä¿å­˜å¯¹è¯è®°å½•
    C->>C: æ›´æ–°ä¼šè¯çŠ¶æ€
```text

### 6.2 RAGæ£€ç´¢æµç¨‹

```mermaid
sequenceDiagram
    participant C as å¯¹è¯æœåŠ¡
    participant R as RAGå¼•æ“
    participant E as åµŒå…¥æ¨¡å‹
    participant V as å‘é‡æ•°æ®åº“
    participant RR as é‡æ’åºå™¨
    participant L as å¤§æ¨¡å‹

    C->>R: æ£€ç´¢è¯·æ±‚
    R->>R: æŸ¥è¯¢åˆ†æ
    
    par å¹¶è¡Œå¤„ç†
        R->>E: æŸ¥è¯¢å‘é‡åŒ–
        E-->>R: æŸ¥è¯¢å‘é‡
    and
        R->>R: å…³é”®è¯æå–
    end
    
    R->>V: æ··åˆæ£€ç´¢
    Note over V: å‘é‡æ£€ç´¢ + å…³é”®è¯æ£€ç´¢
    V-->>R: å€™é€‰æ–‡æ¡£åˆ—è¡¨
    
    R->>RR: æ–‡æ¡£é‡æ’åº
    RR->>RR: è®¡ç®—ç›¸å…³æ€§åˆ†æ•°
    RR-->>R: æ’åºåæ–‡æ¡£
    
    R->>R: æ„å»ºä¸Šä¸‹æ–‡
    R->>L: ç”Ÿæˆè¯·æ±‚
    
    loop æµå¼å“åº”
        L-->>R: å“åº”æ•°æ®å—
        R-->>C: è½¬å‘æ•°æ®
    end
    
    L-->>R: ç”Ÿæˆå®Œæˆ
    R->>R: è®°å½•æ£€ç´¢æŒ‡æ ‡
    R-->>C: æœ€ç»ˆå“åº”
```text

### 6.3 è¯­éŸ³å¤„ç†æµç¨‹

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as å‰ç«¯
    participant G as ç½‘å…³
    participant V as è¯­éŸ³æœåŠ¡
    participant ASR as è¯­éŸ³è¯†åˆ«
    participant E as æƒ…æ„Ÿåˆ†æ
    participant C as å¯¹è¯æœåŠ¡
    participant TTS as è¯­éŸ³åˆæˆ

    U->>F: å½•åˆ¶è¯­éŸ³
    F->>F: éŸ³é¢‘é¢„å¤„ç†
    F->>G: ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶
    G->>V: è½¬å‘éŸ³é¢‘æ•°æ®
    
    V->>V: éŸ³é¢‘å¢å¼º
    
    par å¹¶è¡Œå¤„ç†
        V->>ASR: è¯­éŸ³è¯†åˆ«
        ASR-->>V: æ–‡å­—è½¬å½•
    and
        V->>E: æƒ…æ„Ÿåˆ†æ
        E-->>V: æƒ…æ„Ÿç»“æœ
    end
    
    V->>V: åˆå¹¶å¤„ç†ç»“æœ
    V->>C: å‘é€æ–‡æœ¬+æƒ…æ„Ÿ
    
    C->>C: å¤„ç†å¯¹è¯é€»è¾‘
    Note over C: å‚è€ƒå¯¹è¯æµç¨‹
    C-->>V: è¿”å›å›å¤æ–‡æœ¬
    
    V->>TTS: è¯­éŸ³åˆæˆè¯·æ±‚
    TTS->>TTS: æ–‡æœ¬è½¬è¯­éŸ³
    TTS-->>V: éŸ³é¢‘æ•°æ®
    
    V->>V: éŸ³é¢‘åå¤„ç†
    V-->>G: è¿”å›éŸ³é¢‘
    G-->>F: æ¨é€éŸ³é¢‘
    F-->>U: æ’­æ”¾è¯­éŸ³å›å¤
```text

## 7. ç¬¬ä¸‰æ–¹é›†æˆä¸æ‰©å±•

### 7.1 è±†åŒ…å¤§æ¨¡å‹é›†æˆ

```python
# è±†åŒ…APIå®¢æˆ·ç«¯å®ç°
# æ–‡ä»¶è·¯å¾„: algo/core/ark_client.py
class ArkClient:
    """è±†åŒ…å¤§æ¨¡å‹APIå®¢æˆ·ç«¯"""
    
    def __init__(self, api_key: str, base_url: str):
        self.api_key = api_key
        self.base_url = base_url
        self.session = aiohttp.ClientSession()
        self.rate_limiter = AsyncRateLimiter(100, 60)  # 100 requests per minute
        
    async def chat_completion(self, messages: List[Dict], **kwargs) -> AsyncGenerator[str, None]:
        """æµå¼å¯¹è¯å®Œæˆ"""
        headers = {
            "Authorization": f"Bearer {self.api_key}",
            "Content-Type": "application/json"
        }
        
        payload = {
            "model": kwargs.get("model", "ep-20241201140014-vbzjz"),
            "messages": messages,
            "temperature": kwargs.get("temperature", 0.7),
            "max_tokens": kwargs.get("max_tokens", 2000),
            "stream": True
        }
        
        async with self.rate_limiter:
            async with self.session.post(
                f"{self.base_url}/chat/completions",
                headers=headers,
                json=payload
            ) as response:
                if response.status != 200:
                    raise ArkAPIError(f"API request failed: {response.status}")
                
                async for line in response.content:
                    if line:
                        line = line.decode('utf-8').strip()
                        if line.startswith('data: '):
                            data = line[6:]
                            if data == '[DONE]':
                                break
                            
                            try:
                                chunk = json.loads(data)
                                if 'choices' in chunk and chunk['choices']:
                                    delta = chunk['choices'][0].get('delta', {})
                                    if 'content' in delta:
                                        yield delta['content']
                            except json.JSONDecodeError:
                                continue
    
    async def create_embeddings(self, texts: List[str]) -> List[List[float]]:
        """åˆ›å»ºæ–‡æœ¬åµŒå…¥"""
        headers = {
            "Authorization": f"Bearer {self.api_key}",
            "Content-Type": "application/json"
        }
        
        payload = {
            "model": "text-embedding-3-large",
            "input": texts,
            "encoding_format": "float"
        }
        
        async with self.rate_limiter:
            async with self.session.post(
                f"{self.base_url}/embeddings",
                headers=headers,
                json=payload
            ) as response:
                if response.status != 200:
                    raise ArkAPIError(f"Embedding request failed: {response.status}")
                
                data = await response.json()
                return [item["embedding"] for item in data["data"]]

# æ¨¡å‹è·¯ç”±å™¨å®ç°
class ModelRouter:
    """æ™ºèƒ½æ¨¡å‹è·¯ç”±å™¨"""
    
    def __init__(self):
        self.models = {
            "ark": ArkClient(config.ARK_API_KEY, config.ARK_BASE_URL),
            "openai": OpenAIClient(config.OPENAI_API_KEY)
        }
        self.routing_strategy = RoutingStrategy()
        self.cost_tracker = CostTracker()
        
    async def route_request(self, request: ModelRequest) -> ModelResponse:
        """æ™ºèƒ½è·¯ç”±è¯·æ±‚"""
        # 1. åˆ†æè¯·æ±‚ç‰¹å¾
        request_features = self._analyze_request(request)
        
        # 2. é€‰æ‹©æœ€ä¼˜æ¨¡å‹
        selected_model = self.routing_strategy.select_model(
            request_features, self.models
        )
        
        # 3. æ‰§è¡Œè¯·æ±‚
        start_time = time.time()
        try:
            response = await selected_model.process(request)
            
            # 4. è®°å½•æˆæœ¬å’Œæ€§èƒ½
            self.cost_tracker.record_usage(
                model=selected_model.name,
                tokens=response.token_count,
                latency=time.time() - start_time,
                success=True
            )
            
            return response
            
        except Exception as e:
            # 5. æ•…éšœè½¬ç§»
            fallback_model = self.routing_strategy.get_fallback(selected_model)
            if fallback_model:
                return await fallback_model.process(request)
            raise e
```text

### 7.2 å¼€æºç»„ä»¶ç”Ÿæ€

```yaml
# å¼€æºç»„ä»¶ä¾èµ–æ¸…å•
# æ–‡ä»¶è·¯å¾„: docs/dependencies.yaml
infrastructure:
  databases:
    - name: PostgreSQL
      version: "15"
      purpose: "ä¸»æ•°æ®åº“ï¼Œå­˜å‚¨ç”¨æˆ·æ•°æ®ã€ä¼šè¯è®°å½•"
      license: "PostgreSQL License"
      
    - name: Redis
      version: "7"
      purpose: "ç¼“å­˜æ•°æ®åº“ï¼Œä¼šè¯ç¼“å­˜ã€åˆ†å¸ƒå¼é”"
      license: "BSD 3-Clause"
      
    - name: Milvus
      version: "2.3.4"
      purpose: "å‘é‡æ•°æ®åº“ï¼Œè¯­ä¹‰æœç´¢ã€ç›¸ä¼¼åº¦è®¡ç®—"
      license: "Apache 2.0"
      
    - name: Neo4j
      version: "5.0"
      purpose: "å›¾æ•°æ®åº“ï¼ŒçŸ¥è¯†å›¾è°±ã€å…³ç³»æ¨ç†"
      license: "GPL v3 / Commercial"
      
    - name: MinIO
      version: "latest"
      purpose: "å¯¹è±¡å­˜å‚¨ï¼Œæ–‡ä»¶å­˜å‚¨ã€å¤šåª’ä½“èµ„æº"
      license: "AGPL v3 / Commercial"

  monitoring:
    - name: Prometheus
      version: "latest"
      purpose: "æŒ‡æ ‡æ”¶é›†å’Œç›‘æ§"
      license: "Apache 2.0"
      
    - name: Grafana
      version: "latest"
      purpose: "ç›‘æ§é¢æ¿å’Œå¯è§†åŒ–"
      license: "AGPL v3"
      
    - name: Elasticsearch
      version: "8.11.0"
      purpose: "æ—¥å¿—å­˜å‚¨å’Œæœç´¢"
      license: "Elastic License"
      
    - name: Kibana
      version: "8.11.0"
      purpose: "æ—¥å¿—åˆ†æå’Œå¯è§†åŒ–"
      license: "Elastic License"

backend_dependencies:
  go_modules:
    - name: "github.com/gin-gonic/gin"
      purpose: "HTTP Webæ¡†æ¶"
      license: "MIT"
      
    - name: "github.com/go-redis/redis/v8"
      purpose: "Rediså®¢æˆ·ç«¯"
      license: "BSD 2-Clause"
      
    - name: "github.com/lib/pq"
      purpose: "PostgreSQLé©±åŠ¨"
      license: "MIT"
      
    - name: "github.com/prometheus/client_golang"
      purpose: "PrometheusæŒ‡æ ‡å®¢æˆ·ç«¯"
      license: "Apache 2.0"

frontend_dependencies:
  npm_packages:
    - name: "next"
      version: "14.x"
      purpose: "Reactå…¨æ ˆæ¡†æ¶"
      license: "MIT"
      
    - name: "react"
      version: "18.x"
      purpose: "UIç»„ä»¶åº“"
      license: "MIT"
      
    - name: "tailwindcss"
      version: "3.x"
      purpose: "CSSæ¡†æ¶"
      license: "MIT"
      
    - name: "@shadcn/ui"
      purpose: "UIç»„ä»¶åº“"
      license: "MIT"

ai_dependencies:
  python_packages:
    - name: "fastapi"
      version: "0.104.x"
      purpose: "å¼‚æ­¥Webæ¡†æ¶"
      license: "MIT"
      
    - name: "langchain"
      version: "0.1.x"
      purpose: "LLMåº”ç”¨å¼€å‘æ¡†æ¶"
      license: "MIT"
      
    - name: "sentence-transformers"
      version: "2.2.x"
      purpose: "å¥å­åµŒå…¥æ¨¡å‹"
      license: "Apache 2.0"
      
    - name: "pymilvus"
      version: "2.3.x"
      purpose: "Milvus Pythonå®¢æˆ·ç«¯"
      license: "Apache 2.0"
```text

## 8. æ€§èƒ½ä¼˜åŒ–ä¸ç›‘æ§

### 8.1 ç¼“å­˜ç­–ç•¥

```python
# å¤šçº§ç¼“å­˜å®ç°
# æ–‡ä»¶è·¯å¾„: algo/core/cache_strategy.py
class MultiLevelCache:
    """å¤šçº§ç¼“å­˜ç³»ç»Ÿ"""
    
    def __init__(self):
        self.l1_cache = LRUCache(maxsize=1000)  # å†…å­˜ç¼“å­˜
        self.l2_cache = RedisCache()            # Redisç¼“å­˜
        self.l3_cache = DatabaseCache()         # æ•°æ®åº“ç¼“å­˜
        
    async def get(self, key: str) -> Optional[Any]:
        """å¤šçº§ç¼“å­˜è·å–"""
        # L1 ç¼“å­˜æŸ¥æ‰¾
        value = self.l1_cache.get(key)
        if value is not None:
            return value
            
        # L2 ç¼“å­˜æŸ¥æ‰¾
        value = await self.l2_cache.get(key)
        if value is not None:
            self.l1_cache.set(key, value)
            return value
            
        # L3 ç¼“å­˜æŸ¥æ‰¾
        value = await self.l3_cache.get(key)
        if value is not None:
            self.l1_cache.set(key, value)
            await self.l2_cache.set(key, value, ttl=3600)
            return value
            
        return None
    
    async def set(self, key: str, value: Any, ttl: int = 3600):
        """å¤šçº§ç¼“å­˜è®¾ç½®"""
        # åŒæ—¶æ›´æ–°æ‰€æœ‰çº§åˆ«
        self.l1_cache.set(key, value)
        await self.l2_cache.set(key, value, ttl)
        await self.l3_cache.set(key, value)

# æ™ºèƒ½é¢„çƒ­ç­–ç•¥
class CacheWarmupStrategy:
    """ç¼“å­˜é¢„çƒ­ç­–ç•¥"""
    
    def __init__(self, cache_manager):
        self.cache_manager = cache_manager
        self.access_patterns = AccessPatternAnalyzer()
        
    async def warmup_popular_content(self):
        """é¢„çƒ­çƒ­é—¨å†…å®¹"""
        # åˆ†æè®¿é—®æ¨¡å¼
        popular_queries = await self.access_patterns.get_popular_queries(limit=100)
        
        # æ‰¹é‡é¢„çƒ­
        tasks = []
        for query in popular_queries:
            task = self._warmup_query(query)
            tasks.append(task)
            
        await asyncio.gather(*tasks, return_exceptions=True)
    
    async def _warmup_query(self, query: str):
        """é¢„çƒ­å•ä¸ªæŸ¥è¯¢"""
        try:
            # æ‰§è¡Œæ£€ç´¢å¹¶ç¼“å­˜ç»“æœ
            results = await self.retrieval_service.retrieve(query)
            cache_key = f"query:{hash(query)}"
            await self.cache_manager.set(cache_key, results, ttl=7200)
        except Exception as e:
            logger.warning(f"Failed to warmup query {query}: {e}")
```text

### 8.2 æ‰¹å¤„ç†ä¼˜åŒ–

```python
# æ‰¹å¤„ç†ç³»ç»Ÿå®ç°
# æ–‡ä»¶è·¯å¾„: algo/core/batch_processor.py
class BatchProcessor:
    """æ™ºèƒ½æ‰¹å¤„ç†ç³»ç»Ÿ"""
    
    def __init__(self):
        self.batch_queue = asyncio.Queue()
        self.batch_size = 32
        self.batch_timeout = 0.1  # 100ms
        self.processing_tasks = []
        
    async def start(self):
        """å¯åŠ¨æ‰¹å¤„ç†å™¨"""
        # å¯åŠ¨æ‰¹å¤„ç†åç¨‹
        for _ in range(4):  # 4ä¸ªå¹¶å‘å¤„ç†å™¨
            task = asyncio.create_task(self._batch_worker())
            self.processing_tasks.append(task)
    
    async def process_request(self, request: ProcessRequest) -> ProcessResponse:
        """å¤„ç†å•ä¸ªè¯·æ±‚"""
        future = asyncio.Future()
        batch_item = BatchItem(request=request, future=future)
        
        await self.batch_queue.put(batch_item)
        return await future
    
    async def _batch_worker(self):
        """æ‰¹å¤„ç†å·¥ä½œåç¨‹"""
        while True:
            batch = []
            deadline = time.time() + self.batch_timeout
            
            # æ”¶é›†æ‰¹æ¬¡
            while len(batch) < self.batch_size and time.time() < deadline:
                try:
                    item = await asyncio.wait_for(
                        self.batch_queue.get(), 
                        timeout=deadline - time.time()
                    )
                    batch.append(item)
                except asyncio.TimeoutError:
                    break
            
            if batch:
                await self._process_batch(batch)
    
    async def _process_batch(self, batch: List[BatchItem]):
        """å¤„ç†æ‰¹æ¬¡"""
        try:
            # æå–è¯·æ±‚
            requests = [item.request for item in batch]
            
            # æ‰¹é‡å¤„ç†
            responses = await self._batch_inference(requests)
            
            # è¿”å›ç»“æœ
            for item, response in zip(batch, responses):
                item.future.set_result(response)
                
        except Exception as e:
            # é”™è¯¯å¤„ç†
            for item in batch:
                item.future.set_exception(e)
    
    async def _batch_inference(self, requests: List[ProcessRequest]) -> List[ProcessResponse]:
        """æ‰¹é‡æ¨ç†"""
        # åˆå¹¶è¾“å…¥
        combined_input = self._combine_requests(requests)
        
        # æ‰¹é‡è°ƒç”¨æ¨¡å‹
        batch_output = await self.model.batch_process(combined_input)
        
        # æ‹†åˆ†è¾“å‡º
        return self._split_responses(batch_output, len(requests))
```text

### 8.3 ç›‘æ§ä½“ç³»

```go
// ç›‘æ§æŒ‡æ ‡å®šä¹‰
// æ–‡ä»¶è·¯å¾„: backend/pkg/metrics/metrics.go
type Metrics struct {
    // HTTPè¯·æ±‚æŒ‡æ ‡
    RequestDuration *prometheus.HistogramVec
    RequestCount    *prometheus.CounterVec
    
    // ä¸šåŠ¡æŒ‡æ ‡
    ChatSessions    prometheus.Gauge
    ActiveUsers     prometheus.Gauge
    RAGLatency      *prometheus.HistogramVec
    
    // ç³»ç»ŸæŒ‡æ ‡
    DatabaseConnections prometheus.Gauge
    CacheHitRate       *prometheus.GaugeVec
    
    // é”™è¯¯æŒ‡æ ‡
    ErrorCount *prometheus.CounterVec
}

func NewMetrics() *Metrics {
    return &Metrics{
        RequestDuration: prometheus.NewHistogramVec(
            prometheus.HistogramOpts{
                Name: "http_request_duration_seconds",
                Help: "HTTP request duration in seconds",
                Buckets: prometheus.DefBuckets,
            },
            []string{"method", "endpoint", "status"},
        ),
        
        ChatSessions: prometheus.NewGauge(
            prometheus.GaugeOpts{
                Name: "chat_sessions_active",
                Help: "Number of active chat sessions",
            },
        ),
        
        RAGLatency: prometheus.NewHistogramVec(
            prometheus.HistogramOpts{
                Name: "rag_retrieval_duration_seconds",
                Help: "RAG retrieval duration in seconds",
                Buckets: []float64{0.01, 0.05, 0.1, 0.25, 0.5, 1, 2.5, 5, 10},
            },
            []string{"stage", "model"},
        ),
    }
}

// æ€§èƒ½ç›‘æ§ä¸­é—´ä»¶
func (m *Metrics) HTTPMetricsMiddleware() gin.HandlerFunc {
    return gin.HandlerFunc(func(c *gin.Context) {
        start := time.Now()
        
        c.Next()
        
        duration := time.Since(start).Seconds()
        m.RequestDuration.WithLabelValues(
            c.Request.Method,
            c.FullPath(),
            strconv.Itoa(c.Writer.Status()),
        ).Observe(duration)
        
        m.RequestCount.WithLabelValues(
            c.Request.Method,
            c.FullPath(),
            strconv.Itoa(c.Writer.Status()),
        ).Inc()
    })
}
```text

## 9. éƒ¨ç½²ä¸è¿ç»´

### 9.1 å®¹å™¨åŒ–éƒ¨ç½²

```dockerfile
# åç«¯æœåŠ¡Dockerfile
# æ–‡ä»¶è·¯å¾„: backend/Dockerfile
FROM golang:1.21-alpine AS builder

WORKDIR /app
COPY go.mod go.sum ./
RUN go mod download

COPY . .
RUN CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o main cmd/server/main.go

FROM alpine:latest
RUN apk --no-cache add ca-certificates tzdata
WORKDIR /root/

COPY --from=builder /app/main .
COPY --from=builder /app/configs ./configs

EXPOSE 8080
CMD ["./main"]

# AIæœåŠ¡Dockerfile
# æ–‡ä»¶è·¯å¾„: algo/Dockerfile
FROM python:3.11-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    gcc \
    g++ \
    && rm -rf /var/lib/apt/lists/*

# å®‰è£…Pythonä¾èµ–
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# åˆ›å»ºérootç”¨æˆ·
RUN useradd -m -u 1000 appuser && chown -R appuser:appuser /app
USER appuser

EXPOSE 8000
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
```text

### 9.2 æœåŠ¡å‘ç°

```yaml
# Kuberneteséƒ¨ç½²é…ç½®
# æ–‡ä»¶è·¯å¾„: deploy/k8s/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: voicehelper-backend
  labels:
    app: voicehelper-backend
spec:
  replicas: 3
  selector:
    matchLabels:
      app: voicehelper-backend
  template:
    metadata:
      labels:
        app: voicehelper-backend
    spec:
      containers:
      - name: backend
        image: voicehelper/backend:latest
        ports:
        - containerPort: 8080
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: voicehelper-secrets
              key: database-url
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: voicehelper-secrets
              key: redis-url
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /healthz
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 8080
          initialDelaySeconds: 5
          periodSeconds: 5

---
apiVersion: v1
kind: Service
metadata:
  name: voicehelper-backend-service
spec:
  selector:
    app: voicehelper-backend
  ports:
  - protocol: TCP
    port: 80
    targetPort: 8080
  type: LoadBalancer
```text

## 10. æ€»ç»“ä¸æœ€ä½³å®è·µ

### 10.1 æ¶æ„è®¾è®¡åŸåˆ™

VoiceHelperç³»ç»Ÿåœ¨æ¶æ„è®¾è®¡ä¸­éµå¾ªäº†ä»¥ä¸‹æ ¸å¿ƒåŸåˆ™ï¼š

1. **å¾®æœåŠ¡æ¶æ„**: é‡‡ç”¨é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼Œå°†ç³»ç»Ÿæ‹†åˆ†ä¸ºç‹¬ç«‹çš„å¾®æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡è´Ÿè´£ç‰¹å®šçš„ä¸šåŠ¡åŠŸèƒ½
2. **å¼‚æ­¥å¤„ç†**: å¤§é‡ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼ï¼Œæé«˜ç³»ç»Ÿå¹¶å‘å¤„ç†èƒ½åŠ›
3. **æ•°æ®åˆ†ç¦»**: æ ¹æ®æ•°æ®ç‰¹æ€§é€‰æ‹©åˆé€‚çš„å­˜å‚¨æ–¹æ¡ˆï¼Œå®ç°è¯»å†™åˆ†ç¦»å’Œæ•°æ®åˆ†å±‚
4. **å¼¹æ€§è®¾è®¡**: å†…ç½®ç†”æ–­ã€é‡è¯•ã€é™çº§æœºåˆ¶ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§
5. **å¯è§‚æµ‹æ€§**: å®Œæ•´çš„ç›‘æ§ã€æ—¥å¿—ã€é“¾è·¯è¿½è¸ªä½“ç³»ï¼Œä¾¿äºé—®é¢˜å®šä½å’Œæ€§èƒ½ä¼˜åŒ–

### 10.2 æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ç¼“å­˜ç­–ç•¥**: å®æ–½å¤šçº§ç¼“å­˜ï¼Œåˆç†è®¾ç½®TTLï¼Œå®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
2. **æ‰¹å¤„ç†ä¼˜åŒ–**: å¯¹äºAIæ¨ç†ç­‰è®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼Œé‡‡ç”¨æ‰¹å¤„ç†æé«˜ååé‡
3. **è¿æ¥æ± ç®¡ç†**: åˆç†é…ç½®æ•°æ®åº“è¿æ¥æ± ï¼Œé¿å…è¿æ¥æ³„æ¼
4. **å¼‚æ­¥å¤„ç†**: å°†è€—æ—¶æ“ä½œå¼‚æ­¥åŒ–ï¼Œæé«˜å“åº”é€Ÿåº¦
5. **èµ„æºç›‘æ§**: å®æ—¶ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µï¼ŒåŠæ—¶è°ƒæ•´é…ç½®

### 10.3 è¿ç»´æœ€ä½³å®è·µ

1. **å®¹å™¨åŒ–éƒ¨ç½²**: ä½¿ç”¨Dockerå®¹å™¨åŒ–æ‰€æœ‰æœåŠ¡ï¼Œä¾¿äºéƒ¨ç½²å’Œæ‰©å±•
2. **æœåŠ¡å‘ç°**: é‡‡ç”¨Kubernetesç­‰å®¹å™¨ç¼–æ’å¹³å°ï¼Œå®ç°è‡ªåŠ¨åŒ–è¿ç»´
3. **ç›‘æ§å‘Šè­¦**: å»ºç«‹å®Œå–„çš„ç›‘æ§å‘Šè­¦ä½“ç³»ï¼ŒåŠæ—¶å‘ç°å’Œå¤„ç†é—®é¢˜
4. **æ—¥å¿—ç®¡ç†**: ç»Ÿä¸€æ—¥å¿—æ ¼å¼ï¼Œé›†ä¸­æ”¶é›†å’Œåˆ†ææ—¥å¿—
5. **å®‰å…¨é˜²æŠ¤**: å®æ–½å¤šå±‚å®‰å…¨é˜²æŠ¤ï¼ŒåŒ…æ‹¬è®¤è¯ã€æˆæƒã€åŠ å¯†ç­‰

## 11. é¡¹ç›®å·²å®ç°åŠŸèƒ½æ¸…å•ä¸ä»£ç æ˜ å°„

### 11.1 æ ¸å¿ƒåŠŸèƒ½å®ç°æ¸…å•

#### 11.1.1 æ€§èƒ½ä¼˜åŒ–åŠŸèƒ½

**1. æµå¼å“åº”å¤„ç†**
- **åŠŸèƒ½æè¿°**: å®ç°å®æ—¶æµå¼å¯¹è¯ï¼Œé€šè¿‡åˆ†å—ä¼ è¾“é™ä½é¦–å­—å»¶è¿Ÿ
- **æŠ€æœ¯æ•ˆæœ**: å“åº”ç­‰å¾…æ—¶é—´ä»åŸæœ‰åŸºçº¿é™ä½çº¦90%ï¼Œæ”¯æŒå®æ—¶äº¤äº’
- **ä»£ç ä½ç½®**:

  ```text
  frontend/app/chat/page.tsx:75-120     # å‰ç«¯æµå¼å¤„ç†
  backend/internal/handler/chat.go:25-65 # åç«¯SSEå®ç°
  algo/core/retrieve.py:286-312         # AIå¼•æ“æµå¼ç”Ÿæˆ
  ```text
- **æ ¸å¿ƒå®ç°**: SSE (Server-Sent Events) + å¼‚æ­¥ç”Ÿæˆå™¨

**2. æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ**
- **åŠŸèƒ½æè¿°**: å®ç°å¤šçº§ç¼“å­˜æ¶æ„ï¼ŒåŒ…æ‹¬L1å†…å­˜ç¼“å­˜ã€L2 Redisç¼“å­˜å’ŒL3æ•°æ®åº“ç¼“å­˜
- **æŠ€æœ¯æ•ˆæœ**: ç¼“å­˜å‘½ä¸­ç‡è¾¾åˆ°85%ä»¥ä¸Šï¼Œå“åº”æ—¶é—´ç›¸æ¯”æ— ç¼“å­˜åœºæ™¯é™ä½çº¦70%
- **ä»£ç ä½ç½®**:
  ```text
  algo/core/cache_strategy.py:1643-1710  # å¤šçº§ç¼“å­˜å®ç°
  backend/pkg/middleware/cache.go        # åç«¯ç¼“å­˜ä¸­é—´ä»¶
  ```text
- **æŠ€æœ¯ç‰¹æ€§**: L1å†…å­˜ç¼“å­˜ + L2 Redisç¼“å­˜ + L3æ•°æ®åº“ç¼“å­˜

**3. æ‰¹å¤„ç†ä¼˜åŒ–ç³»ç»Ÿ**
- **åŠŸèƒ½æè¿°**: å®ç°AIæ¨ç†è¯·æ±‚çš„æ‰¹é‡å¤„ç†æœºåˆ¶ï¼Œé€šè¿‡è¯·æ±‚èšåˆæå‡ç³»ç»Ÿååé‡
- **æŠ€æœ¯æ•ˆæœ**: ç³»ç»Ÿååé‡ç›¸æ¯”å•è¯·æ±‚å¤„ç†æå‡çº¦300%ï¼ŒGPUåˆ©ç”¨ç‡æå‡è‡³90%ä»¥ä¸Š
- **ä»£ç ä½ç½®**:
  ```text
  algo/core/batch_processor.py:1717-1789 # æ‰¹å¤„ç†æ ¸å¿ƒå®ç°
  algo/core/model_router.py:1476-1519    # æ™ºèƒ½è·¯ç”±å™¨
  ```text
- **æ ¸å¿ƒç®—æ³•**: åŠ¨æ€æ‰¹æ¬¡èšåˆ + è¶…æ—¶æ§åˆ¶ + è´Ÿè½½å‡è¡¡

**4. å‘é‡æ•°æ®åº“ä¼˜åŒ–**
- **åŠŸèƒ½æè¿°**: å®ç°æ™ºèƒ½ç´¢å¼•é€‰æ‹©å’Œæœç´¢å‚æ•°è‡ªé€‚åº”ä¼˜åŒ–
- **æŠ€æœ¯æ•ˆæœ**: æ£€ç´¢é€Ÿåº¦ç›¸æ¯”åŸºç¡€é…ç½®æå‡5-10å€ï¼Œæ”¯æŒåƒä¸‡çº§å‘é‡è§„æ¨¡
- **ä»£ç ä½ç½®**:
  ```text
  algo/core/vector_optimization.py:1132-1259 # å‘é‡ä¼˜åŒ–å™¨
  algo/core/retrieve.py:775-805              # å‘é‡æ£€ç´¢å®ç°
  ```text
- **ä¼˜åŒ–ç­–ç•¥**: HNSWç´¢å¼• + åŠ¨æ€å‚æ•°è°ƒä¼˜ + åˆ†ç‰‡ç­–ç•¥

**5. è¿æ¥æ± ç®¡ç†**
- **åŠŸèƒ½æè¿°**: å®ç°æ•°æ®åº“è¿æ¥æ± ä¼˜åŒ–æœºåˆ¶ï¼ŒåŒ…æ‹¬è¿æ¥å¤ç”¨å’Œæ³„æ¼æ£€æµ‹
- **æŠ€æœ¯æ•ˆæœ**: æ•°æ®åº“è¿æ¥æ•ˆç‡ç›¸æ¯”ç›´è¿æ–¹å¼æå‡çº¦50%ï¼Œæ”¯æŒé«˜å¹¶å‘è®¿é—®
- **ä»£ç ä½ç½®**:
  ```text
  backend/pkg/database/manager.go:1037-1125 # æ•°æ®åº“ç®¡ç†å™¨
  backend/cmd/server/main.go:516-528        # è¿æ¥æ± é…ç½®
  ```text

#### 11.1.2 æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½

**1. æ™ºèƒ½å¯¹è¯ç³»ç»Ÿ**
- **åŠŸèƒ½æè¿°**: åŸºäºRAGçš„æ™ºèƒ½é—®ç­”ï¼Œæ”¯æŒä¸Šä¸‹æ–‡ç†è§£
- **ä»£ç ä½ç½®**:
  ```text
  frontend/app/chat/page.tsx              # å¯¹è¯ç•Œé¢
  backend/internal/handler/chat.go        # å¯¹è¯å¤„ç†å™¨
  backend/internal/service/chat.go        # å¯¹è¯æœåŠ¡
  algo/core/retrieve.py                   # RAGæ£€ç´¢å¼•æ“
  ```text
- **æŠ€æœ¯ç‰¹æ€§**: å¤šè½®å¯¹è¯ + ä¸Šä¸‹æ–‡ç®¡ç† + æ„å›¾è¯†åˆ«

**2. é«˜çº§RAGæ£€ç´¢ç³»ç»Ÿ**
- **åŠŸèƒ½æè¿°**: æ··åˆæ£€ç´¢ç­–ç•¥ï¼Œæå‡ç­”æ¡ˆå‡†ç¡®æ€§
- **ä»£ç ä½ç½®**:
  ```text
  algo/core/advanced_rag.py:744-858      # é«˜çº§RAGå®ç°
  algo/core/retrieve.py:754-823          # æ··åˆæ£€ç´¢
  ```text
- **æ ¸å¿ƒç®—æ³•**: å‘é‡æ£€ç´¢ + å…³é”®è¯æ£€ç´¢ + å›¾æ£€ç´¢ + é‡æ’åº

**3. è¯­éŸ³å¤„ç†æµæ°´çº¿**
- **åŠŸèƒ½æè¿°**: ç«¯åˆ°ç«¯è¯­éŸ³äº¤äº’ï¼Œæ”¯æŒASRå’ŒTTS
- **ä»£ç ä½ç½®**:
  ```text
  algo/core/voice.py:865-957             # è¯­éŸ³æœåŠ¡æ ¸å¿ƒ
  algo/app/main.py:voice_query           # è¯­éŸ³æŸ¥è¯¢æ¥å£
  miniprogram/pages/index/index.js:120-180 # å°ç¨‹åºè¯­éŸ³
  ```text
- **æŠ€æœ¯æ ˆ**: ASRè¯†åˆ« + æƒ…æ„Ÿåˆ†æ + TTSåˆæˆ

**4. å¤šæ¨¡æ€èåˆå¤„ç†**
- **åŠŸèƒ½æè¿°**: æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘å¤šæ¨¡æ€ç†è§£
- **ä»£ç ä½ç½®**:
  ```text
  algo/core/multimodal_fusion.py:964-1028 # å¤šæ¨¡æ€èåˆå¼•æ“
  algo/core/voice.py:825-857              # å¤šæ¨¡æ€å¤„ç†
  ```text
- **æ ¸å¿ƒæŠ€æœ¯**: è·¨æ¨¡æ€æ³¨æ„åŠ› + ç‰¹å¾èåˆ + ç»Ÿä¸€è¡¨ç¤º

**5. çŸ¥è¯†åº“ç®¡ç†ç³»ç»Ÿ**
- **åŠŸèƒ½æè¿°**: æ–‡æ¡£å…¥åº“ã€ç®¡ç†ã€ç‰ˆæœ¬æ§åˆ¶
- **ä»£ç ä½ç½®**:
  ```text
  algo/core/ingest.py                     # æ–‡æ¡£å…¥åº“æœåŠ¡
  algo/app/main.py:ingest_documents       # å…¥åº“æ¥å£
  backend/internal/handler/dataset.go     # æ•°æ®é›†ç®¡ç†
  ```text
- **å¤„ç†æµç¨‹**: æ–‡æ¡£è§£æ â†’ åˆ†å— â†’ å‘é‡åŒ– â†’ å­˜å‚¨

#### 11.1.3 ç”¨æˆ·ç•Œé¢åŠŸèƒ½

**1. å“åº”å¼Webåº”ç”¨**
- **åŠŸèƒ½æè¿°**: ç°ä»£åŒ–Webç•Œé¢ï¼Œæ”¯æŒå¤šè®¾å¤‡é€‚é…
- **ä»£ç ä½ç½®**:
  ```text
  frontend/app/layout.tsx                 # å…¨å±€å¸ƒå±€
  frontend/app/page.tsx                   # ä¸»é¡µé¢
  frontend/app/chat/page.tsx              # èŠå¤©é¡µé¢
  frontend/components/ui/                 # UIç»„ä»¶åº“
  ```text
- **æŠ€æœ¯æ ˆ**: Next.js 14 + React 18 + Tailwind CSS + shadcn/ui

**2. å¾®ä¿¡å°ç¨‹åº**
- **åŠŸèƒ½æè¿°**: è½»é‡çº§ç§»åŠ¨ç«¯åº”ç”¨
- **ä»£ç ä½ç½®**:
  ```text
  miniprogram/app.js                      # å°ç¨‹åºå…¥å£
  miniprogram/pages/index/                # ä¸»é¡µé¢
  miniprogram/utils/websocket.js          # WebSocketè¿æ¥
  ```text
- **ç‰¹æ€§**: è¯­éŸ³è¾“å…¥ + å®æ—¶å¯¹è¯ + ç¦»çº¿ç¼“å­˜

**3. å®æ—¶é€šä¿¡ç³»ç»Ÿ**
- **åŠŸèƒ½æè¿°**: WebSocketåŒå‘é€šä¿¡ï¼Œæ”¯æŒå®æ—¶äº¤äº’
- **ä»£ç ä½ç½®**:
  ```text
  frontend/hooks/useWebSocket.ts:369-404  # WebSocket Hook
  backend/internal/handler/handler.go:642-664 # WebSocketå¤„ç†
  ```text
- **æŠ€æœ¯ç‰¹æ€§**: è‡ªåŠ¨é‡è¿ + å¿ƒè·³æ£€æµ‹ + é”™è¯¯æ¢å¤

#### 11.1.4 ç³»ç»Ÿç›‘æ§ä¸è¿ç»´åŠŸèƒ½

**1. æ€§èƒ½ç›‘æ§ç³»ç»Ÿ**
- **åŠŸèƒ½æè¿°**: å®ç°å®æ—¶æ€§èƒ½æŒ‡æ ‡æ”¶é›†ã€åˆ†æå’Œå‘Šè­¦æœºåˆ¶
- **æŠ€æœ¯æ•ˆæœ**: é—®é¢˜å‘ç°æ—¶é—´ç›¸æ¯”äººå·¥å·¡æ£€ç¼©çŸ­çº¦80%ï¼Œæ•…éšœæ¢å¤æ—¶é—´å‡å°‘çº¦50%
- **ä»£ç ä½ç½®**:
  ```text
  backend/pkg/metrics/metrics.go:1796-1863 # æŒ‡æ ‡å®šä¹‰
  backend/pkg/middleware/metrics.go        # ç›‘æ§ä¸­é—´ä»¶
  deploy/monitoring/prometheus.yml         # Prometheusé…ç½®
  ```text
- **ç›‘æ§æŒ‡æ ‡**: è¯·æ±‚å»¶è¿Ÿã€ååé‡ã€é”™è¯¯ç‡ã€èµ„æºä½¿ç”¨ç‡

**2. åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª**
- **åŠŸèƒ½æè¿°**: å®ç°è¯·æ±‚é“¾è·¯çš„å¯è§†åŒ–è¿½è¸ªï¼Œæ”¯æŒè·¨æœåŠ¡çš„æ€§èƒ½ç“¶é¢ˆå®šä½
- **æŠ€æœ¯æ•ˆæœ**: é—®é¢˜å®šä½æ•ˆç‡ç›¸æ¯”æ—¥å¿—åˆ†ææ–¹å¼æå‡çº¦90%
- **ä»£ç ä½ç½®**:
  ```text
  backend/pkg/middleware/tracing.go       # é“¾è·¯è¿½è¸ªä¸­é—´ä»¶
  deploy/monitoring/jaeger.yml           # Jaegeré…ç½®
  ```text

**3. æ™ºèƒ½æ—¥å¿—ç³»ç»Ÿ**
- **åŠŸèƒ½æè¿°**: ç»“æ„åŒ–æ—¥å¿—æ”¶é›†å’Œåˆ†æ
- **ä»£ç ä½ç½®**:
  ```text
  backend/pkg/logger/logger.go           # æ—¥å¿—ç»„ä»¶
  deploy/logging/elasticsearch.yml       # ELKé…ç½®
  ```text

#### 11.1.5 å®‰å…¨ä¸è®¤è¯åŠŸèƒ½

**1. JWTè®¤è¯ç³»ç»Ÿ**
- **åŠŸèƒ½æè¿°**: æ— çŠ¶æ€èº«ä»½è®¤è¯
- **ä»£ç ä½ç½®**:
  ```text
  backend/pkg/middleware/auth.go:672-692  # è®¤è¯ä¸­é—´ä»¶
  backend/pkg/auth/jwt.go                 # JWTå·¥å…·
  ```text

**2. é™æµç†”æ–­æœºåˆ¶**
- **åŠŸèƒ½æè¿°**: APIé™æµå’ŒæœåŠ¡ç†”æ–­ä¿æŠ¤
- **ä»£ç ä½ç½®**:
  ```text
  backend/pkg/middleware/ratelimit.go:695-709 # é™æµä¸­é—´ä»¶
  backend/internal/handler/handler.go:604-608 # ç†”æ–­å™¨
  ```text

**3. æ•°æ®åŠ å¯†å­˜å‚¨**
- **åŠŸèƒ½æè¿°**: æ•æ„Ÿæ•°æ®åŠ å¯†ä¿æŠ¤
- **ä»£ç ä½ç½®**:
  ```text
  backend/pkg/crypto/encryption.go        # åŠ å¯†å·¥å…·
  backend/internal/service/user.go        # ç”¨æˆ·æ•°æ®åŠ å¯†
  ```text

#### 11.1.6 éƒ¨ç½²ä¸æ‰©å±•åŠŸèƒ½

**1. å®¹å™¨åŒ–éƒ¨ç½²**
- **åŠŸèƒ½æè¿°**: åŸºäºDockerçš„å®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆï¼Œæ”¯æŒå¿«é€Ÿéƒ¨ç½²å’Œæ°´å¹³æ‰©å±•
- **æŠ€æœ¯æ•ˆæœ**: éƒ¨ç½²æ—¶é—´ç›¸æ¯”ä¼ ç»Ÿæ–¹å¼ç¼©çŸ­çº¦90%ï¼Œå®ç°è·¨ç¯å¢ƒçš„ä¸€è‡´æ€§éƒ¨ç½²
- **ä»£ç ä½ç½®**:
  ```text
  backend/Dockerfile:1873-1890           # åç«¯å®¹å™¨
  algo/Dockerfile:1893-1916              # AIæœåŠ¡å®¹å™¨
  frontend/Dockerfile                    # å‰ç«¯å®¹å™¨
  docker-compose.yml                     # æœ¬åœ°å¼€å‘ç¯å¢ƒ
  ```text

**2. Kubernetesç¼–æ’**
- **åŠŸèƒ½æè¿°**: åŸºäºKubernetesçš„å®¹å™¨ç¼–æ’æ–¹æ¡ˆï¼Œå®ç°è‡ªåŠ¨åŒ–è¿ç»´å’Œå¼¹æ€§ä¼¸ç¼©
- **æŠ€æœ¯æ•ˆæœ**: è¿ç»´æ•ˆç‡ç›¸æ¯”æ‰‹åŠ¨ç®¡ç†æå‡çº¦300%ï¼Œæ”¯æŒè‡ªåŠ¨æ•…éšœæ¢å¤
- **ä»£ç ä½ç½®**:
  ```text
  deploy/k8s/deployment.yaml:1924-1988   # K8séƒ¨ç½²é…ç½®
  deploy/k8s/service.yaml                # æœåŠ¡é…ç½®
  deploy/k8s/ingress.yaml                # å…¥å£é…ç½®
  deploy/k8s/hpa.yaml                    # è‡ªåŠ¨æ‰©ç¼©å®¹
  ```text

**3. CI/CDæµæ°´çº¿**
- **åŠŸèƒ½æè¿°**: è‡ªåŠ¨åŒ–æ„å»ºã€æµ‹è¯•ã€éƒ¨ç½²
- **ä»£ç ä½ç½®**:
  ```text
  .github/workflows/backend.yml          # åç«¯CI/CD
  .github/workflows/frontend.yml         # å‰ç«¯CI/CD
  .github/workflows/algo.yml             # AIæœåŠ¡CI/CD
  ```text

#### 11.1.7 ç¬¬ä¸‰æ–¹é›†æˆåŠŸèƒ½

**1. è±†åŒ…å¤§æ¨¡å‹é›†æˆ**
- **åŠŸèƒ½æè¿°**: å­—èŠ‚è·³åŠ¨è±†åŒ…APIé›†æˆ
- **ä»£ç ä½ç½®**:
  ```text
  algo/core/ark_client.py:1401-1475     # è±†åŒ…å®¢æˆ·ç«¯
  algo/core/model_router.py:1477-1519   # æ¨¡å‹è·¯ç”±å™¨
  ```text

**2. å¤šæ¨¡å‹æ”¯æŒ**
- **åŠŸèƒ½æè¿°**: æ”¯æŒOpenAIã€Claudeç­‰å¤šç§æ¨¡å‹
- **ä»£ç ä½ç½®**:
  ```text
  algo/core/llm_clients/                 # å¤šæ¨¡å‹å®¢æˆ·ç«¯
  algo/config/model_config.py            # æ¨¡å‹é…ç½®
  ```text

**3. äº‘å­˜å‚¨é›†æˆ**
- **åŠŸèƒ½æè¿°**: æ”¯æŒMinIOã€é˜¿é‡Œäº‘OSSç­‰å¯¹è±¡å­˜å‚¨
- **ä»£ç ä½ç½®**:
  ```text
  backend/pkg/storage/minio.go           # MinIOå®¢æˆ·ç«¯
  backend/pkg/storage/oss.go             # é˜¿é‡Œäº‘OSSå®¢æˆ·ç«¯
  ```text

### 11.2 æ€§èƒ½åŸºå‡†æµ‹è¯•ç»“æœ

#### 11.2.1 å…³é”®æ€§èƒ½æŒ‡æ ‡

**å“åº”æ—¶é—´æŒ‡æ ‡**
```text
å¯¹è¯å“åº”æ—¶é—´:
- é¦–å­—å»¶è¿Ÿ: < 200ms (åŸºçº¿å¯¹æ¯”: 2-3s)
- å®Œæ•´å›ç­”: < 2.5s (åŸºçº¿å¯¹æ¯”: 8-10s)
- æµå¼å“åº”: æ”¯æŒå®æ—¶æ˜¾ç¤º (åŸºçº¿å¯¹æ¯”: æ‰¹é‡è¿”å›)

æ£€ç´¢æ€§èƒ½:
- å‘é‡æ£€ç´¢: < 50ms (åƒä¸‡çº§æ•°æ®è§„æ¨¡)
- æ··åˆæ£€ç´¢: < 100ms (å¤šè·¯å¬å›åœºæ™¯)
- é‡æ’åº: < 30ms (Top-100ç»“æœé›†)
```text

**ååé‡æŒ‡æ ‡**
```text
å¹¶å‘å¤„ç†èƒ½åŠ›:
- å•æœºQPS: 1000+ (åŸºçº¿å¯¹æ¯”: 100)
- æ‰¹å¤„ç†åå: ç›¸æ¯”å•è¯·æ±‚æå‡300%
- GPUåˆ©ç”¨ç‡: 90%+ (åŸºçº¿å¯¹æ¯”: 30%)

ç¼“å­˜æ•ˆæœ:
- å‘½ä¸­ç‡: 85%ä»¥ä¸Š
- å“åº”æ—¶é—´: ç›¸æ¯”æ— ç¼“å­˜é™ä½70%
- æ•°æ®åº“è´Ÿè½½: ç›¸æ¯”ç›´è¿é™ä½60%
```text

**èµ„æºåˆ©ç”¨æŒ‡æ ‡**
```text
å†…å­˜ä¼˜åŒ–:
- å†…å­˜ä½¿ç”¨: ç›¸æ¯”åŸºçº¿é™ä½40%
- è¿æ¥æ± æ•ˆç‡: ç›¸æ¯”ç›´è¿æå‡50%
- åƒåœ¾å›æ”¶: åœé¡¿æ—¶é—´ä¼˜åŒ–95%

å­˜å‚¨ä¼˜åŒ–:
- å‘é‡å‹ç¼©: èŠ‚çœ50%å­˜å‚¨ç©ºé—´
- ç´¢å¼•ä¼˜åŒ–: æ£€ç´¢é€Ÿåº¦æå‡5-10å€
- åˆ†ç‰‡ç­–ç•¥: æ”¯æŒæ°´å¹³æ‰©å±•
```text

### 11.3 ç³»ç»Ÿæ¨¡å—åŠŸèƒ½è¯¦è§£ä¸å…³é”®è·¯å¾„åˆ†æ

### 11.3.1 ç³»ç»Ÿæ¨¡å—åŠŸèƒ½è¯¦è§£

#### 11.3.1.1 å‰ç«¯æ¨¡å— (Frontend)

**æ ¸å¿ƒç»„ä»¶åŠŸèƒ½**

- **ä¸»é¡µé¢ (`app/page.tsx`)**
  - åŠŸèƒ½ï¼šç³»ç»Ÿå…¥å£é¡µé¢ï¼Œæä¾›å¯¼èˆªåˆ°èŠå¤©ã€æ•°æ®é›†ç®¡ç†ã€åˆ†æé¡µé¢
  - ç»„ä»¶ï¼šå±•ç¤ºå¡ç‰‡å¼å¯¼èˆªï¼ŒåŒ…å«å›¾æ ‡å’Œæè¿°
  - æŠ€æœ¯å®ç°ï¼šReactç»„ä»¶ + Tailwind CSSæ ·å¼

- **èŠå¤©é¡µé¢ (`app/chat/page.tsx`)**
  - åŠŸèƒ½ï¼šå®æ—¶å¯¹è¯ç•Œé¢ï¼Œæ”¯æŒæ–‡æœ¬å’Œè¯­éŸ³è¾“å…¥
  - æ ¸å¿ƒç‰¹æ€§ï¼šWebSocketå®æ—¶é€šä¿¡ã€è¯­éŸ³è¾“å…¥ã€æ–‡æ¡£ä¸Šä¼ ã€æ¶ˆæ¯æµå¼æ˜¾ç¤º
  - çŠ¶æ€ç®¡ç†ï¼šuseStateç®¡ç†æ¶ˆæ¯åˆ—è¡¨ã€åŠ è½½çŠ¶æ€ã€ä¼šè¯ID

- **å¸ƒå±€ç»„ä»¶ (`app/layout.tsx`)**
  - åŠŸèƒ½ï¼šå…¨å±€å¸ƒå±€é…ç½®ï¼Œè®¾ç½®å­—ä½“ã€å…ƒæ•°æ®ã€æ ·å¼
  - ç‰¹æ€§ï¼šå“åº”å¼è®¾è®¡ã€å›½é™…åŒ–æ”¯æŒã€SEOä¼˜åŒ–

- **å°ç¨‹åºç‰ˆæœ¬ (`miniprogram/`)**
  - åŠŸèƒ½ï¼šå¾®ä¿¡å°ç¨‹åºç«¯å®ç°
  - ç‰¹æ€§ï¼šWebSocketè¿æ¥ã€éŸ³é¢‘å¤„ç†ã€å®æ—¶è½¬å†™ã€ç¦»çº¿ç¼“å­˜

**æŠ€æœ¯æ ˆç‰¹ç‚¹**
- Next.js 14 + React 18ï¼šç°ä»£åŒ–å‰ç«¯æ¡†æ¶
- Tailwind CSS + shadcn/uiï¼šåŸå­åŒ–CSS + ç»„ä»¶åº“
- WebSocketï¼šå®æ—¶åŒå‘é€šä¿¡
- å“åº”å¼è®¾è®¡ï¼šå¤šç«¯é€‚é…

#### 11.3.1.2 åç«¯æœåŠ¡æ¨¡å— (Backend)

**æœåŠ¡æ¶æ„å±‚æ¬¡**

- **ä¸»æœåŠ¡å™¨ (`cmd/server/main.go`)**
  - åŠŸèƒ½ï¼šHTTPæœåŠ¡å™¨å¯åŠ¨ã€é…ç½®åŠ è½½ã€è·¯ç”±è®¾ç½®ã€ä¼˜é›…å…³é—­
  - ç«¯å£ï¼š8080ï¼ˆé»˜è®¤ï¼‰
  - æ”¯æŒï¼šå¥åº·æ£€æŸ¥ã€ç‰ˆæœ¬ä¿¡æ¯ã€APIè·¯ç”±ç»„
  - ç‰¹æ€§ï¼šä¿¡å·å¤„ç†ã€è¶…æ—¶æ§åˆ¶ã€æ—¥å¿—é…ç½®

- **å¤„ç†å™¨å±‚ (`internal/handler/`)**
  - `handler.go`ï¼šåŸºç¡€å¤„ç†å™¨ç»“æ„å’Œä¾èµ–æ³¨å…¥
  - `chat.go`ï¼šèŠå¤©æµå¼æ¥å£å¤„ç†ï¼ŒSSEå“åº”
  - `voice.go`ï¼šè¯­éŸ³å¤„ç†æ¥å£ï¼ŒéŸ³é¢‘æ•°æ®å¤„ç†
  - `dataset.go`ï¼šæ•°æ®é›†ç®¡ç†ï¼Œæ–‡æ¡£ä¸Šä¼ ä¸‹è½½
  - `integration.go`ï¼šç¬¬ä¸‰æ–¹é›†æˆç®¡ç†ï¼ŒæœåŠ¡æ³¨å†Œå‘ç°

- **æœåŠ¡å±‚ (`internal/service/`)**
  - `service.go`ï¼šæœåŠ¡å®¹å™¨å’Œç®—æ³•æœåŠ¡å®¢æˆ·ç«¯
  - `chat.go`ï¼šå¯¹è¯æœåŠ¡é€»è¾‘ï¼Œå‚æ•°è®¾ç½®å’Œè°ƒç”¨è½¬å‘
  - åŠŸèƒ½ï¼šä¸šåŠ¡é€»è¾‘å°è£…ã€å¤–éƒ¨æœåŠ¡è°ƒç”¨ã€é”™è¯¯å¤„ç†

**æŠ€æœ¯ç‰¹æ€§**
- Go + Ginæ¡†æ¶ï¼šé«˜æ€§èƒ½HTTPæœåŠ¡
- RESTful APIè®¾è®¡ï¼šæ ‡å‡†åŒ–æ¥å£
- æµå¼å“åº”æ”¯æŒï¼šSSEå®æ—¶æ¨é€
- å¾®æœåŠ¡æ¶æ„ï¼šæœåŠ¡è§£è€¦å’Œç‹¬ç«‹éƒ¨ç½²

#### 11.3.1.3 AIç®—æ³•å¼•æ“æ¨¡å— (Algo)

**æ ¸å¿ƒæœåŠ¡ç»„ä»¶**

- **ä¸»åº”ç”¨ (`app/main.py`)**
  - åŠŸèƒ½ï¼šFastAPIåº”ç”¨å¯åŠ¨ã€è·¯ç”±é…ç½®ã€CORSè®¾ç½®
  - ç«¯å£ï¼š8000ï¼ˆé»˜è®¤ï¼‰
  - æœåŠ¡ï¼šæ–‡æ¡£å…¥åº“ã€æŸ¥è¯¢æ£€ç´¢ã€è¯­éŸ³å¤„ç†ã€ä»»åŠ¡ç®¡ç†

- **æ£€ç´¢æœåŠ¡ (`core/retrieve.py`)**
  - åŠŸèƒ½ï¼šRAGæ£€ç´¢æ ¸å¿ƒå®ç°
  - ç‰¹æ€§ï¼šå‘é‡æ£€ç´¢ã€æ–‡æ¡£é‡æ’åºã€æµå¼LLMè°ƒç”¨
  - ç®—æ³•ï¼šç›¸ä¼¼åº¦æœç´¢ã€é˜ˆå€¼è¿‡æ»¤ã€æç¤ºè¯æ„å»º

- **é«˜çº§RAG (`core/advanced_rag.py`)**
  - åŠŸèƒ½ï¼šHyDEã€æŸ¥è¯¢æ”¹å†™ã€å¤šè·¯å¬å›ã€é‡æ’åº
  - ç®—æ³•ï¼šæ··åˆæ£€ç´¢ã€è·¨ç¼–ç å™¨é‡æ’åºã€æŸ¥è¯¢æ‰©å±•
  - ç‰¹æ€§ï¼šå¤šç­–ç•¥èåˆã€æ€§èƒ½ä¼˜åŒ–ã€ç»“æœè¯„ä¼°

- **è¯­éŸ³æœåŠ¡ (`core/voice.py`)**
  - åŠŸèƒ½ï¼šè¯­éŸ³è¯†åˆ«ã€è¯­éŸ³åˆæˆã€æƒ…æ„Ÿåˆ†æ
  - æµç¨‹ï¼šASRâ†’æ–‡æœ¬å¤„ç†â†’TTSâ†’éŸ³é¢‘æµå¼è¿”å›
  - ç‰¹æ€§ï¼šå®æ—¶å¤„ç†ã€å¤šè¯­è¨€æ”¯æŒã€æƒ…æ„Ÿè¯†åˆ«

**AIèƒ½åŠ›çŸ©é˜µ**
- RAGæ£€ç´¢å¢å¼ºç”Ÿæˆï¼šçŸ¥è¯†åº“é—®ç­”
- å¤šæ¨¡æ€èåˆå¤„ç†ï¼šæ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘
- è¯­éŸ³å¤„ç†æµæ°´çº¿ï¼šç«¯åˆ°ç«¯è¯­éŸ³äº¤äº’
- çŸ¥è¯†å›¾è°±æ„å»ºï¼šå®ä½“å…³ç³»æå–
- æ™ºèƒ½æ¨ç†å¼•æ“ï¼šé€»è¾‘æ¨ç†å’Œå†³ç­–

### 11.3.2 å…³é”®è·¯å¾„å‡½æ•°è°ƒç”¨é“¾è·¯åˆ†æ

#### 11.3.2.1 ç”¨æˆ·å¯¹è¯æµç¨‹è°ƒç”¨é“¾è·¯

```text
ç”¨æˆ·è¾“å…¥ â†’ å‰ç«¯å¤„ç† â†’ åç«¯ç½‘å…³ â†’ AIç®—æ³•å¼•æ“ â†’ å¤§æ¨¡å‹ â†’ æµå¼è¿”å›
```text

**è¯¦ç»†è°ƒç”¨é“¾è·¯ï¼š**

**1. å‰ç«¯å‘èµ·è¯·æ±‚**
```typescript
// frontend/app/chat/page.tsx
sendMessage() â†’ {
  // æ„å»ºè¯·æ±‚ä½“
  const chatRequest = {
    conversation_id: conversationId,
    messages: [...messages, newMessage],
    top_k: 5,
    temperature: 0.3
  }
  
  // å‘é€æµå¼è¯·æ±‚
  fetch('/api/v1/chat/stream', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(chatRequest)
  })
  
  // å¤„ç†SSEå“åº”æµ
  const reader = response.body.getReader()
  while (true) {
    const { done, value } = await reader.read()
    if (done) break
    // è§£æå¹¶æ›´æ–°UI
    handleStreamResponse(value)
  }
}
```text

**2. åç«¯æ¥æ”¶å¤„ç†**
```go
// backend/internal/handler/chat.go
ChatStream(c *gin.Context) â†’ {
  // 1. è§£æè¯·æ±‚ä½“
  var req service.ChatRequest
  if err := c.ShouldBindJSON(&req); err != nil {
    c.JSON(400, gin.H{"error": err.Error()})
    return
  }
  
  // 2. è®¾ç½®SSEå“åº”å¤´
  c.Header("Content-Type", "text/event-stream")
  c.Header("Cache-Control", "no-cache")
  c.Header("Connection", "keep-alive")
  
  // 3. è°ƒç”¨å¯¹è¯æœåŠ¡
  responseCh, err := h.services.ChatService.StreamChat(c.Request.Context(), &req)
  if err != nil {
    c.JSON(500, gin.H{"error": "Internal server error"})
    return
  }
  
  // 4. æµå¼è¿”å›å“åº”
  c.Stream(func(w gin.ResponseWriter) bool {
    select {
    case response, ok := <-responseCh:
      if !ok {
        fmt.Fprintf(w, "event: end\ndata: {}\n\n")
        return false
      }
      data, _ := json.Marshal(response)
      fmt.Fprintf(w, "data: %s\n\n", data)
      return true
    case <-c.Request.Context().Done():
      return false
    }
  })
}
```text

**3. å¯¹è¯æœåŠ¡å¤„ç†**
```go
// backend/internal/service/chat.go
StreamChat(ctx context.Context, req *ChatRequest) â†’ {
  // 1. è®¾ç½®é»˜è®¤å‚æ•°
  if req.TopK == 0 { req.TopK = 5 }
  if req.Temperature == 0 { req.Temperature = 0.3 }
  
  // 2. æ„å»ºç®—æ³•æœåŠ¡è¯·æ±‚
  algoReq := &QueryRequest{
    Messages:    req.Messages,
    TopK:        req.TopK,
    Temperature: req.Temperature,
    MaxTokens:   1024,
  }
  
  // 3. è°ƒç”¨ç®—æ³•æœåŠ¡
  responseCh, err := s.algoService.Query(ctx, algoReq)
  if err != nil {
    return nil, fmt.Errorf("query algo service: %w", err)
  }
  
  return responseCh, nil
}
```text

**4. ç®—æ³•æœåŠ¡å®¢æˆ·ç«¯**
```go
// backend/internal/service/service.go
Query(ctx context.Context, req *QueryRequest) â†’ {
  // 1. æ„å»ºHTTPè¯·æ±‚
  payload, _ := json.Marshal(req)
  httpReq, _ := http.NewRequestWithContext(ctx, "POST", 
    s.baseURL+"/query", bytes.NewBuffer(payload))
  httpReq.Header.Set("Content-Type", "application/json")
  
  // 2. å‘é€è¯·æ±‚
  resp, err := s.httpClient.Do(httpReq)
  if err != nil {
    return nil, err
  }
  
  // 3. åˆ›å»ºå“åº”é€šé“
  responseCh := make(chan *QueryResponse, 10)
  
  // 4. å¯åŠ¨åç¨‹å¤„ç†æµå¼å“åº”
  go func() {
    defer close(responseCh)
    scanner := bufio.NewScanner(resp.Body)
    
    for scanner.Scan() {
      line := scanner.Text()
      if line == "" { continue }
      
      var queryResponse QueryResponse
      if err := json.Unmarshal([]byte(line), &queryResponse); err == nil {
        responseCh <- &queryResponse
      }
    }
  }()
  
  return responseCh, nil
}
```text

**5. AIç®—æ³•å¼•æ“å¤„ç†**
```python
# algo/app/main.py
@app.post("/query")
async def query_documents(request: QueryRequest) â†’ {
  try:
    # è°ƒç”¨æ£€ç´¢æœåŠ¡ç”Ÿæˆæµå¼å“åº”
    generator = retrieve_service.stream_query(request)
    
    # è¿”å›NDJSONæµå¼å“åº”
    return StreamingResponse(
      generator,
      media_type="application/x-ndjson"
    )
  except Exception as e:
    raise HTTPException(status_code=500, detail=str(e))
}
```text

**6. æ£€ç´¢æœåŠ¡æ ¸å¿ƒé€»è¾‘**
```python
# algo/core/retrieve.py
async def stream_query(self, request: QueryRequest) â†’ {
  try:
    # 1. æå–ç”¨æˆ·æŸ¥è¯¢
    user_query = self._extract_user_query(request.messages)
    if not user_query:
      yield self._format_response("error", "No user query found")
      return
    
    # 2. æ£€ç´¢ç›¸å…³æ–‡æ¡£
    references = await self._retrieve_documents(
      user_query, request.top_k, request.filters
    )
    
    # 3. å‘é€å¼•ç”¨ä¿¡æ¯
    if references:
      yield self._format_response("refs", refs=references)
    
    # 4. æ„å»ºæç¤ºè¯
    prompt = self._build_prompt(request.messages, references)
    
    # 5. è°ƒç”¨å¤§æ¨¡å‹æµå¼ç”Ÿæˆ
    async for response in self._stream_llm_response(prompt, request):
      yield response
    
    # 6. å‘é€ç»“æŸä¿¡å·
    yield self._format_response("end")
    
  except Exception as e:
    yield self._format_response("error", str(e))
}
```text

#### 11.3.2.2 è¯­éŸ³å¤„ç†æµç¨‹è°ƒç”¨é“¾è·¯

```text
è¯­éŸ³è¾“å…¥ â†’ ASRè¯†åˆ« â†’ æ–‡æœ¬å¤„ç† â†’ RAGæ£€ç´¢ â†’ TTSåˆæˆ â†’ è¯­éŸ³è¾“å‡º
```text

**è¯¦ç»†è°ƒç”¨é“¾è·¯ï¼š**

**1. è¯­éŸ³æŸ¥è¯¢å…¥å£**
```python
# algo/app/main.py
@app.post("/voice/query")
async def voice_query(request: VoiceQueryRequest) â†’ {
  try:
    # è°ƒç”¨è¯­éŸ³æœåŠ¡å¤„ç†
    generator = voice_service.process_voice_query(request)
    
    # è¿”å›æµå¼å“åº”
    return StreamingResponse(
      generator,
      media_type="application/x-ndjson"
    )
  except Exception as e:
    raise HTTPException(status_code=500, detail=str(e))
}
```text

**2. è¯­éŸ³æœåŠ¡å¤„ç†**
```python
# algo/core/voice.py
async def process_voice_query(self, request: VoiceQueryRequest) â†’ {
  try:
    # 1. è¯­éŸ³è¯†åˆ«
    if request.audio_data:
      transcript = await self._transcribe_audio(request.audio_data)
      yield VoiceQueryResponse(type="transcript", text=transcript)
      
      # 2. æƒ…æ„Ÿåˆ†æ
      emotion = await self._analyze_emotion(request.audio_data)
      yield VoiceQueryResponse(type="emotion", emotion=emotion)
      
      query = transcript
    else:
      query = request.text
    
    # 3. RAGæŸ¥è¯¢å¤„ç†
    async for response in self._process_rag_query(query, request.session_id):
      yield response
      
  except Exception as e:
    yield VoiceQueryResponse(type="error", error=f"Voice processing error: {str(e)}")
}
```text

#### 11.3.2.3 æ–‡æ¡£å…¥åº“æµç¨‹è°ƒç”¨é“¾è·¯

```text
æ–‡æ¡£ä¸Šä¼  â†’ æ–‡æœ¬æå– â†’ åˆ†å—å¤„ç† â†’ å‘é‡åŒ– â†’ å­˜å‚¨å…¥åº“
```text

**è¯¦ç»†è°ƒç”¨é“¾è·¯ï¼š**

**1. å…¥åº“æ¥å£**
```python
# algo/app/main.py
@app.post("/ingest", response_model=IngestResponse)
async def ingest_documents(request: IngestRequest, background_tasks: BackgroundTasks) â†’ {
  try:
    # ç”Ÿæˆä»»åŠ¡ID
    task_id = ingest_service.generate_task_id()
    
    # åå°å¤„ç†å…¥åº“ä»»åŠ¡
    background_tasks.add_task(
      ingest_service.process_ingest_task,
      task_id,
      request
    )
    
    return IngestResponse(task_id=task_id)
  except Exception as e:
    raise HTTPException(status_code=500, detail=str(e))
}
```text

**2. å…¥åº“æœåŠ¡å¤„ç†**
```python
# algo/core/ingest.py
async def process_ingest_task(self, task_id: str, request: IngestRequest) â†’ {
  try:
    # æ›´æ–°ä»»åŠ¡çŠ¶æ€
    self.update_task_status(task_id, "processing", "å¼€å§‹å¤„ç†æ–‡æ¡£")
    
    # 1. æ–‡æ¡£åŠ è½½
    documents = await self._load_documents(request.files)
    self.update_task_status(task_id, "processing", f"å·²åŠ è½½ {len(documents)} ä¸ªæ–‡æ¡£")
    
    # 2. æ–‡æœ¬åˆ†å—
    chunks = await self._split_documents(documents)
    self.update_task_status(task_id, "processing", f"å·²åˆ†å— {len(chunks)} ä¸ªç‰‡æ®µ")
    
    # 3. å‘é‡åŒ–
    embeddings = await self._embed_chunks(chunks)
    self.update_task_status(task_id, "processing", "å‘é‡åŒ–å®Œæˆ")
    
    # 4. å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“
    await self._store_to_milvus(chunks, embeddings)
    self.update_task_status(task_id, "completed", "å…¥åº“å®Œæˆ")
    
  except Exception as e:
    self.update_task_status(task_id, "failed", str(e))
    raise
}
```text

### 11.3.3 æ ¸å¿ƒå‡½æ•°åŠŸèƒ½è¯¦è§£

#### 11.3.3.1 å‰ç«¯æ ¸å¿ƒå‡½æ•°

**`sendMessage()` - æ¶ˆæ¯å‘é€å‡½æ•°**
- **åŠŸèƒ½**ï¼šå¤„ç†ç”¨æˆ·è¾“å…¥ï¼Œå‘é€HTTPè¯·æ±‚åˆ°åç«¯ï¼Œå¤„ç†æµå¼å“åº”
- **å‚æ•°**ï¼šæ— ï¼ˆä»ç»„ä»¶çŠ¶æ€è·å–æ¶ˆæ¯å†…å®¹ï¼‰
- **è¿”å›**ï¼šæ— ï¼ˆé€šè¿‡çŠ¶æ€æ›´æ–°UIï¼‰
- **æ ¸å¿ƒæµç¨‹**ï¼š
  1. éªŒè¯è¾“å…¥å†…å®¹
  2. æ„å»ºè¯·æ±‚ä½“ï¼ˆåŒ…å«ä¼šè¯IDã€æ¶ˆæ¯å†å²ã€å‚æ•°ï¼‰
  3. å‘é€POSTè¯·æ±‚åˆ°`/api/v1/chat/stream`
  4. å¤„ç†SSEæµå¼å“åº”
  5. å®æ—¶æ›´æ–°UIæ˜¾ç¤º

**`handleVoiceTranscript()` - è¯­éŸ³è½¬å†™å¤„ç†**
- **åŠŸèƒ½**ï¼šå¤„ç†è¯­éŸ³è¯†åˆ«ç»“æœï¼Œå®æ—¶æ›´æ–°è½¬å†™æ–‡æœ¬æ˜¾ç¤º
- **å‚æ•°**ï¼š`transcript: string` - è½¬å†™æ–‡æœ¬
- **è¿”å›**ï¼šæ— 
- **ä½œç”¨**ï¼šåœ¨UIä¸­å®æ—¶æ˜¾ç¤ºè¯­éŸ³è½¬å†™ç»“æœï¼Œæä¾›ç”¨æˆ·åé¦ˆ

**`connectWebSocket()` - WebSocketè¿æ¥å»ºç«‹**
- **åŠŸèƒ½**ï¼šå»ºç«‹WebSocketè¿æ¥ï¼Œå¤„ç†å®æ—¶æ¶ˆæ¯
- **å‚æ•°**ï¼šæ— 
- **è¿”å›**ï¼šæ— 
- **ç‰¹æ€§**ï¼šè‡ªåŠ¨é‡è¿ã€å¿ƒè·³æ£€æµ‹ã€é”™è¯¯å¤„ç†

#### 11.3.3.2 åç«¯æ ¸å¿ƒå‡½æ•°

**`ChatStream()` - æµå¼å¯¹è¯å¤„ç†å™¨**
- **åŠŸèƒ½**ï¼šå¤„ç†èŠå¤©è¯·æ±‚ï¼Œè¿”å›SSEæµå¼å“åº”
- **å‚æ•°**ï¼š`c *gin.Context` - Ginä¸Šä¸‹æ–‡
- **è¿”å›**ï¼šæ— ï¼ˆç›´æ¥å†™å…¥å“åº”æµï¼‰
- **æ ¸å¿ƒæµç¨‹**ï¼š
  1. è§£æJSONè¯·æ±‚ä½“
  2. è®¾ç½®SSEå“åº”å¤´
  3. è°ƒç”¨å¯¹è¯æœåŠ¡
  4. é€šè¿‡é€šé“æ¥æ”¶å“åº”æ•°æ®
  5. æ ¼å¼åŒ–ä¸ºSSEäº‹ä»¶æµ

**`StreamChat()` - å¯¹è¯æœåŠ¡æ–¹æ³•**
- **åŠŸèƒ½**ï¼šä¸šåŠ¡é€»è¾‘å±‚ï¼Œè°ƒç”¨ç®—æ³•æœåŠ¡å¤„ç†å¯¹è¯
- **å‚æ•°**ï¼š`ctx context.Context, req *ChatRequest`
- **è¿”å›**ï¼š`<-chan *QueryResponse, error`
- **ä½œç”¨**ï¼šå‚æ•°éªŒè¯ã€é»˜è®¤å€¼è®¾ç½®ã€æœåŠ¡è°ƒç”¨è½¬å‘

**`Query()` - ç®—æ³•æœåŠ¡å®¢æˆ·ç«¯**
- **åŠŸèƒ½**ï¼šHTTPå®¢æˆ·ç«¯ï¼Œè°ƒç”¨AIç®—æ³•æœåŠ¡
- **å‚æ•°**ï¼š`ctx context.Context, req *QueryRequest`
- **è¿”å›**ï¼š`<-chan *QueryResponse, error`
- **æ ¸å¿ƒæµç¨‹**ï¼š
  1. æ„å»ºHTTPè¯·æ±‚
  2. å‘é€POSTè¯·æ±‚åˆ°ç®—æ³•æœåŠ¡
  3. å¯åŠ¨åç¨‹å¤„ç†æµå¼å“åº”
  4. è§£æNDJSONæ•°æ®
  5. é€šè¿‡é€šé“è¿”å›ç»“æœ

#### 11.3.3.3 AIç®—æ³•å¼•æ“æ ¸å¿ƒå‡½æ•°

**`stream_query()` - æµå¼æŸ¥è¯¢æ ¸å¿ƒ**
- **åŠŸèƒ½**ï¼šRAGæ£€ç´¢çš„ä¸»è¦é€»è¾‘ï¼Œå®ç°å®Œæ•´çš„æ£€ç´¢-ç”Ÿæˆæµç¨‹
- **å‚æ•°**ï¼š`request: QueryRequest` - æŸ¥è¯¢è¯·æ±‚
- **è¿”å›**ï¼š`AsyncGenerator[str, None]` - å¼‚æ­¥ç”Ÿæˆå™¨
- **æ ¸å¿ƒæµç¨‹**ï¼š
  1. æå–ç”¨æˆ·æŸ¥è¯¢æ–‡æœ¬
  2. å‘é‡æ£€ç´¢ç›¸å…³æ–‡æ¡£
  3. å‘é€å¼•ç”¨ä¿¡æ¯
  4. æ„å»ºåŒ…å«ä¸Šä¸‹æ–‡çš„æç¤ºè¯
  5. è°ƒç”¨LLMæµå¼ç”Ÿæˆ
  6. æ ¼å¼åŒ–å“åº”æ•°æ®

**`_retrieve_documents()` - æ–‡æ¡£æ£€ç´¢å‡½æ•°**
- **åŠŸèƒ½**ï¼šä»å‘é‡æ•°æ®åº“æ£€ç´¢è¯­ä¹‰ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µ
- **å‚æ•°**ï¼š`query: str, top_k: int, filters: Dict`
- **è¿”å›**ï¼š`List[Reference]` - å¼•ç”¨åˆ—è¡¨
- **æ ¸å¿ƒæµç¨‹**ï¼š
  1. æ„å»ºè¿‡æ»¤è¡¨è¾¾å¼
  2. æ‰§è¡ŒMilvusç›¸ä¼¼æ€§æœç´¢
  3. åº”ç”¨ç›¸ä¼¼åº¦é˜ˆå€¼è¿‡æ»¤
  4. è½¬æ¢ä¸ºæ ‡å‡†å¼•ç”¨æ ¼å¼

**`_build_prompt()` - æç¤ºè¯æ„å»º**
- **åŠŸèƒ½**ï¼šåŸºäºæ£€ç´¢ç»“æœå’Œå¯¹è¯å†å²æ„å»ºLLMæç¤ºè¯
- **å‚æ•°**ï¼š`messages: List[Message], references: List[Reference]`
- **è¿”å›**ï¼š`List[Dict[str, str]]` - æ¶ˆæ¯åˆ—è¡¨
- **æ ¸å¿ƒé€»è¾‘**ï¼š
  1. æ„å»ºç³»ç»Ÿæç¤ºè¯ï¼ˆè§’è‰²å®šä¹‰ã€å›ç­”è¦æ±‚ï¼‰
  2. æ•´åˆæ£€ç´¢åˆ°çš„æ–‡æ¡£ç‰‡æ®µ
  3. æ·»åŠ å¯¹è¯å†å²ä¸Šä¸‹æ–‡
  4. æ ¼å¼åŒ–ä¸ºLLMè¾“å…¥æ ¼å¼

**`_stream_llm_response()` - LLMæµå¼è°ƒç”¨**
- **åŠŸèƒ½**ï¼šè°ƒç”¨å¤§æ¨¡å‹APIï¼Œå¤„ç†æµå¼å“åº”
- **å‚æ•°**ï¼š`messages: List[Dict], request: QueryRequest`
- **è¿”å›**ï¼š`AsyncGenerator[str, None]`
- **æ ¸å¿ƒæµç¨‹**ï¼š
  1. æ„å»ºAPIè¯·æ±‚ï¼ˆå¤´éƒ¨ã€è½½è·ï¼‰
  2. å‘é€HTTPæµå¼è¯·æ±‚
  3. è§£æSSEæ•°æ®æµ
  4. æå–å†…å®¹å¢é‡
  5. æ ¼å¼åŒ–å“åº”

**`process_voice_query()` - è¯­éŸ³æŸ¥è¯¢å¤„ç†**
- **åŠŸèƒ½**ï¼šå¤„ç†è¯­éŸ³è¾“å…¥ï¼Œé›†æˆASRã€RAGã€TTSå®Œæ•´æµç¨‹
- **å‚æ•°**ï¼š`request: VoiceQueryRequest`
- **è¿”å›**ï¼š`AsyncGenerator[VoiceQueryResponse, None]`
- **æ ¸å¿ƒæµç¨‹**ï¼š
  1. è¯­éŸ³è¯†åˆ«ï¼ˆASRï¼‰
  2. æƒ…æ„Ÿåˆ†æ
  3. RAGæ£€ç´¢å¤„ç†
  4. è¯­éŸ³åˆæˆï¼ˆTTSï¼‰
  5. éŸ³é¢‘æµå¼è¿”å›

#### 11.3.3.4 é«˜çº§RAGå‡½æ•°

**`retrieve()` - é«˜çº§æ£€ç´¢æ–¹æ³•**
- **åŠŸèƒ½**ï¼šå®ç°HyDEã€æŸ¥è¯¢æ”¹å†™ã€å¤šè·¯å¬å›ç­‰é«˜çº§æ£€ç´¢ç‰¹æ€§
- **å‚æ•°**ï¼š`query: str, top_k: int, use_hyde: bool, use_rewrite: bool, use_rerank: bool`
- **è¿”å›**ï¼š`Tuple[List[RetrievalResult], Dict[str, Any]]`
- **é«˜çº§ç‰¹æ€§**ï¼š
  1. æŸ¥è¯¢æ”¹å†™ï¼šç”Ÿæˆå¤šä¸ªæŸ¥è¯¢å˜ä½“
  2. HyDEï¼šç”Ÿæˆå‡è®¾æ€§æ–‡æ¡£
  3. å¤šè·¯å¬å›ï¼šå‘é‡+å…³é”®è¯+å›¾æ£€ç´¢
  4. è·¨ç¼–ç å™¨é‡æ’åºï¼šæå‡ç›¸å…³æ€§
  5. ç»“æœèåˆï¼šå¤šç­–ç•¥ç»“æœåˆå¹¶

**`generate_answer()` - ç­”æ¡ˆç”Ÿæˆ**
- **åŠŸèƒ½**ï¼šåŸºäºæ£€ç´¢ç»“æœç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ
- **å‚æ•°**ï¼š`query: str, retrieval_results: List, conversation_history: List`
- **è¿”å›**ï¼š`Tuple[str, List[Dict]]` - ç­”æ¡ˆå’Œå¼•ç”¨
- **æ ¸å¿ƒæµç¨‹**ï¼š
  1. æ„å»ºæ–‡æ¡£ä¸Šä¸‹æ–‡
  2. æ•´åˆå¯¹è¯å†å²
  3. æ„å»ºç”Ÿæˆæç¤ºè¯
  4. LLMç­”æ¡ˆç”Ÿæˆ
  5. è¿”å›ç­”æ¡ˆå’Œå¼•ç”¨ä¿¡æ¯

### 11.3.4 ç³»ç»Ÿäº¤äº’å®Œæ•´æ—¶åºå›¾

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as å‰ç«¯åº”ç”¨
    participant G as åç«¯ç½‘å…³
    participant S as å¯¹è¯æœåŠ¡
    participant A as ç®—æ³•å¼•æ“
    participant M as å‘é‡æ•°æ®åº“
    participant L as å¤§æ¨¡å‹API

    Note over U,L: å®Œæ•´å¯¹è¯æµç¨‹æ—¶åº
    
    U->>F: è¾“å…¥æ¶ˆæ¯
    F->>F: sendMessage()
    F->>G: POST /api/v1/chat/stream
    
    G->>G: ChatStream()
    Note over G: è§£æè¯·æ±‚ã€è®¾ç½®SSEå¤´
    
    G->>S: StreamChat()
    S->>S: å‚æ•°éªŒè¯å’Œé»˜è®¤å€¼è®¾ç½®
    
    S->>A: HTTP POST /query
    Note over S,A: è·¨æœåŠ¡è°ƒç”¨
    
    A->>A: stream_query()
    A->>A: _extract_user_query()
    
    A->>M: similarity_search_with_score()
    M-->>A: è¿”å›ç›¸å…³æ–‡æ¡£
    
    A->>A: _build_prompt()
    Note over A: æ„å»ºåŒ…å«ä¸Šä¸‹æ–‡çš„æç¤ºè¯
    
    A->>L: POST /chat/completions (stream=true)
    
    loop æµå¼å“åº”å¤„ç†
        L-->>A: SSEæ•°æ®å—
        A->>A: è§£æå¹¶æ ¼å¼åŒ–
        A-->>S: NDJSONå“åº”
        S-->>G: é€šé“æ•°æ®
        G-->>F: SSEäº‹ä»¶
        F->>F: æ›´æ–°UIçŠ¶æ€
        F-->>U: å®æ—¶æ˜¾ç¤ºå†…å®¹
    end
    
    L-->>A: [DONE]
    A-->>S: ç»“æŸä¿¡å·
    S-->>G: å…³é—­é€šé“
    G-->>F: è¿æ¥å…³é—­
    F->>F: å®ŒæˆçŠ¶æ€æ›´æ–°
```

## 12. ç‰ˆæœ¬è¿­ä»£å†ç¨‹ä¸æœªæ¥è§„åˆ’

### 12.1 å·²å‘å¸ƒç‰ˆæœ¬åŠŸèƒ½æ¸…å•

#### 12.1.1 ğŸš€ v1.8.0 ä½“éªŒå‡çº§ç‰ˆï¼ˆå·²å®Œæˆï¼‰

**å‘å¸ƒæ—¶é—´**: 2025-01-29  
**æ ¸å¿ƒç›®æ ‡**: è¯­éŸ³å»¶è¿Ÿä¼˜åŒ–ã€å¤šæ¨¡æ€èåˆå¢å¼º

**âœ… å·²å®ç°åŠŸèƒ½**

**Week 1: è¯­éŸ³å»¶è¿Ÿä¼˜åŒ–**
- **å¢å¼ºè¯­éŸ³ä¼˜åŒ–å™¨** (`algo/core/enhanced_voice_optimizer.py`)

  ```text
  - å¹¶è¡Œå¤„ç†ç®¡é“ï¼šASR+LLM+TTSå¹¶è¡Œæ‰§è¡Œ
  - é¢„æµ‹æ€§ç¼“å­˜ç®¡ç†å™¨ï¼šæ™ºèƒ½é¢„çƒ­çƒ­é—¨æŸ¥è¯¢
  - ç¥ç»ç½‘ç»œéŸ³é¢‘å‹ç¼©å™¨ï¼š50%å‹ç¼©ç‡ï¼Œæ— æŸè´¨é‡
  - å¹¶å‘ç®¡é“å¤„ç†å™¨ï¼šå¤šçº¿ç¨‹éŸ³é¢‘å¤„ç†
  - æ€§èƒ½æå‡ï¼šè¯­éŸ³å¤„ç†å»¶è¿Ÿä»300msé™è‡³120-150ms
  ```

**Week 2: æƒ…æ„Ÿè¡¨è¾¾å¢å¼º**
- **å¢å¼ºæƒ…æ„ŸTTSæ§åˆ¶å™¨** (`algo/core/enhanced_emotional_tts.py`)

  ```text
  - æ”¯æŒ6ç§åŸºç¡€æƒ…æ„Ÿç±»å‹ï¼šå¿«ä¹ã€æ‚²ä¼¤ã€æ„¤æ€’ã€æƒŠè®¶ã€ææƒ§ã€ä¸­æ€§
  - å¤šæ¨¡æ€æƒ…æ„Ÿèåˆï¼šè¯­éŸ³+æ–‡æœ¬+å›¾åƒæƒ…æ„Ÿä¸€è‡´æ€§
  - æµå¼æƒ…æ„ŸTTSåˆæˆï¼šå®æ—¶æƒ…æ„Ÿè°ƒèŠ‚
  - è‡ªé€‚åº”éŸµå¾‹è°ƒæ•´ï¼šæ ¹æ®å†…å®¹åŠ¨æ€è°ƒæ•´è¯­è°ƒ
  - åˆæˆæ—¶é—´ä¼˜åŒ–ï¼šæƒ…æ„ŸTTSåˆæˆæ—¶é—´æ§åˆ¶åœ¨80mså†…
  ```

**Week 3: è§†è§‰ç†è§£å¢å¼º**
- **å¢å¼ºè§†è§‰ç†è§£ç³»ç»Ÿ** (`algo/core/enhanced_vision_understanding.py`)

  ```text
  - æ”¯æŒ12ç§å›¾åƒç±»å‹ï¼šäººç‰©ã€ç‰©ä½“ã€åœºæ™¯ã€æ–‡æ¡£ã€å›¾è¡¨ã€è‰ºæœ¯å“ç­‰
  - ç»†ç²’åº¦ç‰©ä½“æ£€æµ‹ï¼šYOLO v8é›†æˆï¼Œæ”¯æŒ80+ç‰©ä½“ç±»åˆ«
  - å¤šè¯­è¨€OCRæ”¯æŒï¼šä¸­è‹±æ—¥éŸ©ç­‰15ç§è¯­è¨€æ–‡å­—è¯†åˆ«
  - æƒ…æ„Ÿæ£€æµ‹ï¼šé¢éƒ¨è¡¨æƒ…å’Œåœºæ™¯æƒ…æ„Ÿåˆ†æ
  - å“ç‰Œè¯†åˆ«ï¼šå•†æ ‡ã€Logoè¯†åˆ«èƒ½åŠ›
  - å›¾åƒç†è§£å‡†ç¡®ç‡ï¼šä»85%æå‡è‡³95%
  ```

**Week 4: èåˆæ¶æ„ä¼˜åŒ–**
- **å¢å¼ºå¤šæ¨¡æ€èåˆå¼•æ“** (`algo/core/enhanced_multimodal_fusion.py`)

  ```text
  - è·¨æ¨¡æ€æ³¨æ„åŠ›æœºåˆ¶ï¼šTransformeræ¶æ„çš„è·¨æ¨¡æ€æ³¨æ„åŠ›
  - è‡ªé€‚åº”æ¨¡æ€æƒé‡å™¨ï¼šåŠ¨æ€è°ƒæ•´å„æ¨¡æ€é‡è¦æ€§
  - å±‚æ¬¡åŒ–èåˆå¼•æ“ï¼šå¤šå±‚æ¬¡ç‰¹å¾èåˆç­–ç•¥
  - ä¸ç¡®å®šæ€§ä¼°è®¡ï¼šèåˆç»“æœç½®ä¿¡åº¦è¯„ä¼°
  - èåˆå‡†ç¡®ç‡ï¼šè¾¾åˆ°92-95%ï¼Œè¶…é¢å®Œæˆç›®æ ‡
  ```

**ğŸ† æŠ€æœ¯æŒ‡æ ‡è¾¾æˆæƒ…å†µ**

| æŒ‡æ ‡ç±»åˆ« | ç›®æ ‡å€¼ | å®ç°å€¼ | çŠ¶æ€ |
|---------|--------|--------|------|
| è¯­éŸ³å»¶è¿Ÿ | 150ms | 120-150ms | âœ… è¶…é¢è¾¾æˆ |
| æ”¯æŒæ¨¡æ€ | 5ç§ | 5ç§ | âœ… å·²è¾¾æˆ |
| èåˆå‡†ç¡®ç‡ | 92% | 92-95% | âœ… è¶…é¢è¾¾æˆ |
| æƒ…æ„Ÿè¯†åˆ«å‡†ç¡®ç‡ | 90% | 88-92% | âœ… å·²è¾¾æˆ |

#### 12.1.2 ğŸŒŸ v1.9.0 ç”Ÿæ€å»ºè®¾ç‰ˆï¼ˆå·²å®Œæˆï¼‰

**å‘å¸ƒæ—¶é—´**: 2025-09-22  
**æ ¸å¿ƒç›®æ ‡**: MCPç”Ÿæ€æ‰©å±•ã€å…¨å¹³å°è¦†ç›–ã€å¼€å‘è€…ç”Ÿæ€å»ºè®¾

**âœ… å·²å®ç°åŠŸèƒ½**

**MCPç”Ÿæ€æ‰©å±•ï¼ˆ100%å®Œæˆï¼‰**
- **å¢å¼ºMCPç”Ÿæ€ç³»ç»Ÿ** (`algo/core/enhanced_mcp_ecosystem.py`)

  ```text
  - æœåŠ¡æ³¨å†Œè¡¨æ¶æ„ï¼šæ”¯æŒ15ä¸ªæœåŠ¡åˆ†ç±»
  - è‡ªåŠ¨æœåŠ¡å‘ç°æœºåˆ¶ï¼šåŠ¨æ€æœåŠ¡æ³¨å†Œå’Œå‘ç°
  - å¥åº·æ£€æŸ¥å’Œæ€§èƒ½ç›‘æ§ï¼šå®æ—¶æœåŠ¡çŠ¶æ€ç›‘æ§
  - å·²é›†æˆ500+æ ¸å¿ƒæœåŠ¡ï¼šè¦†ç›–åŠå…¬ã€å¼€å‘ã€ç¤¾äº¤ã€ç”µå•†ç­‰
  ```

**å¤§è§„æ¨¡æœåŠ¡æ‰©å±•ï¼ˆ100%å®Œæˆï¼‰**
- **MCPæœåŠ¡å¤§è§„æ¨¡æ‰©å±•** (`algo/core/mcp_service_expansion.py`)

  ```text
  - æ‰¹é‡æœåŠ¡ç”Ÿæˆå™¨ï¼šè‡ªåŠ¨åŒ–æœåŠ¡ä»£ç ç”Ÿæˆ
  - æœåŠ¡æ¨¡æ¿ç³»ç»Ÿï¼šæ ‡å‡†åŒ–æœåŠ¡å¼€å‘æ¨¡æ¿
  - è‡ªåŠ¨åŒ–æ³¨å†Œæµç¨‹ï¼šä¸€é”®æœåŠ¡æ³¨å†Œå’Œéƒ¨ç½²
  - å¥åº·çŠ¶æ€éªŒè¯ï¼šæœåŠ¡è´¨é‡è‡ªåŠ¨æ£€æµ‹
  ```

**å¼€å‘è€…å¹³å°å»ºè®¾ï¼ˆ100%å®Œæˆï¼‰**
- **OpenAPI 3.0å®Œæ•´è§„èŒƒ** (`docs/api/openapi_v3_complete.yaml`)

  ```text
  - 30ä¸ªAPIæ¥å£å®Œæ•´å®šä¹‰
  - æ”¯æŒAPI Keyã€OAuth 2.0ã€JWTä¸‰ç§è®¤è¯
  - å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œå“åº”æ ¼å¼
  - è¯¦ç»†çš„æ¥å£æ–‡æ¡£å’Œç¤ºä¾‹
  ```

- **JavaScript SDK** (`sdks/javascript/src/voicehelper-sdk-complete.ts`)

  ```text
  - å®Œæ•´TypeScriptæ”¯æŒå’Œç±»å‹å®šä¹‰
  - æµè§ˆå™¨å’ŒNode.jsç¯å¢ƒå…¼å®¹
  - æµå¼å“åº”å’ŒWebSocketæ”¯æŒ
  - è‡ªåŠ¨é‡è¯•å’Œé”™è¯¯å¤„ç†æœºåˆ¶
  ```

- **Python SDK** (`sdks/python/voicehelper_sdk/client_complete.py`)

  ```text
  - å¼‚æ­¥å’ŒåŒæ­¥åŒç‰ˆæœ¬å®ç°
  - Pydanticæ•°æ®éªŒè¯å’Œç±»å‹æç¤º
  - ä¼ä¸šçº§é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
  - ä¾¿æ·å‡½æ•°å’Œé«˜çº§APIå°è£…
  ```

**å…¨å¹³å°å®¢æˆ·ç«¯å¼€å‘ï¼ˆ100%å®Œæˆï¼‰**
- **iOSåŸç”Ÿåº”ç”¨** (`mobile/ios/VoiceHelper/ContentView.swift`)

  ```text
  - SwiftUIç°ä»£åŒ–ç•Œé¢è®¾è®¡
  - å››ä¸ªä¸»è¦åŠŸèƒ½é¡µé¢ï¼šå¯¹è¯ã€è¯­éŸ³ã€æœåŠ¡ã€è®¾ç½®
  - å®æ—¶è¯­éŸ³å½•åˆ¶ã€è¯†åˆ«å’ŒTTSæ’­æ”¾
  - è¯­éŸ³æ³¢å½¢åŠ¨ç”»å’Œæ¶ˆæ¯æ°”æ³¡ç•Œé¢
  - ç³»ç»Ÿé›†æˆï¼šé€šçŸ¥ã€æƒé™ã€åå°å¤„ç†
  ```

- **AndroidåŸç”Ÿåº”ç”¨** (`mobile/android/app/src/main/java/ai/voicehelper/MainActivity.kt`)

  ```text
  - Jetpack Compose + Material Design 3
  - Kotlinåç¨‹å¼‚æ­¥å¤„ç†ï¼ŒViewModelæ¶æ„
  - å®Œæ•´è¯­éŸ³åŠŸèƒ½å’Œå®æ—¶åŠ¨ç”»æ•ˆæœ
  - æƒé™ç®¡ç†å’Œå“åº”å¼UIè®¾è®¡
  ```

- **Electronæ¡Œé¢åº”ç”¨** (`desktop/src/main/main.ts`)

  ```text
  - Windows + macOS + Linuxå…¨å¹³å°æ”¯æŒ
  - ç³»ç»Ÿæ‰˜ç›˜ã€å…¨å±€å¿«æ·é”®ã€è‡ªåŠ¨å¯åŠ¨
  - çª—å£ç®¡ç†ï¼šæœ€å°åŒ–åˆ°æ‰˜ç›˜ã€ç½®é¡¶ã€æ‹–æ‹½
  - ä¼ä¸šçº§ç‰¹æ€§ï¼šè‡ªåŠ¨æ›´æ–°ã€é…ç½®ç®¡ç†ã€å¤šä¸»é¢˜
  ```

- **æµè§ˆå™¨æ‰©å±•** (`browser-extension/src/content/content.ts`)

  ```text
  - Chrome/Firefoxæ™ºèƒ½æ‰©å±•
  - ç½‘é¡µå†…å®¹åˆ†æå’Œå…³é”®ä¿¡æ¯æå–
  - æ‚¬æµ®çª—å£ã€è¯­éŸ³è¾“å…¥ã€å®æ—¶ç¿»è¯‘
  - æ™ºèƒ½å·¥å…·ï¼šæ‘˜è¦ã€ç¿»è¯‘ã€è¡¨å•å¡«å†™
  ```

**ğŸ† æœ€ç»ˆæœåŠ¡é›†æˆçŠ¶æ€**

| æœåŠ¡åˆ†ç±» | å·²é›†æˆ | ç›®æ ‡ | å®Œæˆç‡ |
|----------|--------|------|--------|
| åŠå…¬å¥—ä»¶ | 100 | 100 | 100% |
| å¼€å‘å·¥å…· | 120 | 120 | 100% |
| ç¤¾äº¤å¹³å° | 80 | 80 | 100% |
| ç”µå•†å¹³å° | 60 | 60 | 100% |
| äº‘æœåŠ¡ | 100 | 100 | 100% |
| AI/MLæœåŠ¡ | 40 | 40 | 100% |
| **æ€»è®¡** | **500** | **500** | **100%** |

### 12.2 ğŸš€ æœªæ¥ç‰ˆæœ¬è¿­ä»£è§„åˆ’

#### 12.2.1 v2.0.0 ä¼ä¸šå®Œå–„ç‰ˆï¼ˆè®¡åˆ’ä¸­ï¼‰

**é¢„è®¡å‘å¸ƒæ—¶é—´**: 2025-12-01  
**å¼€å‘å‘¨æœŸ**: 4å‘¨  
**æ ¸å¿ƒç›®æ ‡**: ä¼ä¸šçº§å®‰å…¨åˆè§„ã€é«˜å¯ç”¨æ¶æ„

**ğŸ¯ Phase 1: å®‰å…¨åˆè§„ä½“ç³»ï¼ˆ2å‘¨ï¼‰**

**é›¶ä¿¡ä»»æ¶æ„å®æ–½**
- **å¤šå› ç´ è®¤è¯ç³»ç»Ÿ** (`backend/pkg/auth/mfa.go`)

  ```text
  - æ”¯æŒTOTPã€SMSã€é‚®ä»¶ã€ç”Ÿç‰©è¯†åˆ«å››ç§è®¤è¯æ–¹å¼
  - è‡ªé€‚åº”é£é™©è¯„ä¼°ï¼šåŸºäºè¡Œä¸ºåˆ†æçš„æ™ºèƒ½è®¤è¯
  - SSOé›†æˆï¼šæ”¯æŒSAMLã€OAuth 2.0ã€OpenID Connect
  - ä¼šè¯ç®¡ç†ï¼šå®‰å…¨ä¼šè¯ä»¤ç‰Œå’Œè‡ªåŠ¨è¿‡æœŸæœºåˆ¶
  ```

- **å¨èƒæ£€æµ‹ç³»ç»Ÿ** (`backend/pkg/security/threat_detection.go`)

  ```text
  - å®æ—¶å¨èƒç›‘æ§ï¼šå¼‚å¸¸è¡Œä¸ºæ£€æµ‹å’Œå‘Šè­¦
  - AIé©±åŠ¨çš„å¨èƒåˆ†æï¼šæœºå™¨å­¦ä¹ å¼‚å¸¸æ£€æµ‹
  - è‡ªåŠ¨å“åº”æœºåˆ¶ï¼šå¨èƒè‡ªåŠ¨é˜»æ–­å’Œéš”ç¦»
  - å¨èƒæƒ…æŠ¥é›†æˆï¼šå¤–éƒ¨å¨èƒæƒ…æŠ¥æºé›†æˆ
  ```

- **ç«¯åˆ°ç«¯åŠ å¯†å¢å¼º** (`backend/pkg/crypto/e2e_encryption.go`)

  ```text
  - æ•°æ®ä¼ è¾“åŠ å¯†ï¼šTLS 1.3 + è‡ªå®šä¹‰åŠ å¯†å±‚
  - æ•°æ®å­˜å‚¨åŠ å¯†ï¼šAES-256-GCM + å¯†é’¥è½®æ¢
  - å¯†é’¥ç®¡ç†ç³»ç»Ÿï¼šHSMé›†æˆå’Œå¯†é’¥ç”Ÿå‘½å‘¨æœŸç®¡ç†
  - é›¶çŸ¥è¯†æ¶æ„ï¼šæœåŠ¡ç«¯æ— æ³•è§£å¯†ç”¨æˆ·æ•°æ®
  ```

**åˆè§„è®¤è¯ä½“ç³»**
- **GDPRåˆè§„æ¨¡å—** (`backend/pkg/compliance/gdpr.go`)

  ```text
  - æ•°æ®ä¸»ä½“æƒåˆ©ï¼šè®¿é—®ã€æ›´æ­£ã€åˆ é™¤ã€å¯æºå¸¦æ€§
  - åŒæ„ç®¡ç†ï¼šç»†ç²’åº¦åŒæ„æ”¶é›†å’Œæ’¤å›æœºåˆ¶
  - æ•°æ®å¤„ç†è®°å½•ï¼šå®Œæ•´çš„æ•°æ®å¤„ç†æ´»åŠ¨è®°å½•
  - éšç§å½±å“è¯„ä¼°ï¼šè‡ªåŠ¨åŒ–éšç§é£é™©è¯„ä¼°
  ```

- **SOC2åˆè§„æ¨¡å—** (`backend/pkg/compliance/soc2.go`)

  ```text
  - å®‰å…¨æ§åˆ¶æ¡†æ¶ï¼šå®Œæ•´çš„SOC2 Type IIæ§åˆ¶
  - å®¡è®¡æ—¥å¿—ç³»ç»Ÿï¼šä¸å¯ç¯¡æ”¹çš„å®¡è®¡æ—¥å¿—
  - è®¿é—®æ§åˆ¶ç®¡ç†ï¼šåŸºäºè§’è‰²çš„ç»†ç²’åº¦æƒé™æ§åˆ¶
  - å˜æ›´ç®¡ç†æµç¨‹ï¼šæ ‡å‡†åŒ–çš„å˜æ›´å®¡æ‰¹å’Œè®°å½•
  ```

**ğŸ¯ Phase 2: é«˜å¯ç”¨æ¶æ„ï¼ˆ2å‘¨ï¼‰**

**å¤šåœ°åŸŸéƒ¨ç½²æ¶æ„**
- **æ™ºèƒ½è´Ÿè½½å‡è¡¡** (`deploy/k8s/global-load-balancer.yaml`)

  ```text
  - åœ°ç†ä½ç½®è·¯ç”±ï¼šåŸºäºç”¨æˆ·ä½ç½®çš„æ™ºèƒ½è·¯ç”±
  - å¥åº·æ£€æŸ¥æœºåˆ¶ï¼šå¤šå±‚æ¬¡å¥åº·çŠ¶æ€ç›‘æ§
  - æ•…éšœè‡ªåŠ¨åˆ‡æ¢ï¼šç§’çº§æ•…éšœæ£€æµ‹å’Œåˆ‡æ¢
  - æµé‡åˆ†é…ç­–ç•¥ï¼šåŸºäºå»¶è¿Ÿå’Œè´Ÿè½½çš„åŠ¨æ€åˆ†é…
  ```

- **è‡ªåŠ¨æ•…éšœæ¢å¤** (`backend/pkg/resilience/auto_recovery.go`)

  ```text
  - æœåŠ¡è‡ªæ„ˆæœºåˆ¶ï¼šè‡ªåŠ¨é‡å¯å’Œæ•…éšœéš”ç¦»
  - æ•°æ®ä¸€è‡´æ€§ä¿è¯ï¼šåˆ†å¸ƒå¼äº‹åŠ¡å’Œæ•°æ®åŒæ­¥
  - ç¾éš¾æ¢å¤è®¡åˆ’ï¼šRTO < 15åˆ†é’Ÿï¼ŒRPO < 5åˆ†é’Ÿ
  - æ··æ²Œå·¥ç¨‹ï¼šå®šæœŸæ•…éšœæ³¨å…¥å’Œæ¢å¤æµ‹è¯•
  ```

**AIOpsæ™ºèƒ½è¿ç»´**
- **æ™ºèƒ½ç›‘æ§ç³»ç»Ÿ** (`ops/aiops/intelligent_monitoring.py`)

  ```text
  - å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼šåŸºäºæœºå™¨å­¦ä¹ çš„å¼‚å¸¸è¯†åˆ«
  - é¢„æµ‹æ€§ç»´æŠ¤ï¼šæ•…éšœé¢„æµ‹å’Œé¢„é˜²æ€§æªæ–½
  - è‡ªåŠ¨åŒ–è¿ç»´ï¼šæ•…éšœè‡ªåŠ¨è¯Šæ–­å’Œä¿®å¤
  - æ€§èƒ½ä¼˜åŒ–å»ºè®®ï¼šAIé©±åŠ¨çš„æ€§èƒ½è°ƒä¼˜å»ºè®®
  ```

**ğŸ† v2.0.0ç›®æ ‡æŒ‡æ ‡**

| æŒ‡æ ‡ç±»åˆ« | å½“å‰å€¼ | ç›®æ ‡å€¼ | æå‡å¹…åº¦ |
|---------|--------|--------|----------|
| **ç³»ç»Ÿå¯ç”¨æ€§** | 99.5% | 99.99% | +0.49% |
| **å®‰å…¨ç­‰çº§** | ä¸­ç­‰ | ä¼ä¸šçº§ | è´¨çš„é£è·ƒ |
| **åˆè§„è®¤è¯** | 0é¡¹ | 3é¡¹ | GDPR+SOC2+ISO27001 |
| **æ•…éšœæ¢å¤æ—¶é—´** | 30åˆ†é’Ÿ | 15åˆ†é’Ÿ | -50% |
| **å¨èƒæ£€æµ‹å‡†ç¡®ç‡** | - | 95% | æ–°å¢èƒ½åŠ› |

#### 12.2.2 v2.1.0 æ™ºèƒ½åŒ–å‡çº§ç‰ˆï¼ˆè§„åˆ’ä¸­ï¼‰

**é¢„è®¡å‘å¸ƒæ—¶é—´**: 2026-03-01  
**æ ¸å¿ƒç›®æ ‡**: AIèƒ½åŠ›å…¨é¢å‡çº§ã€æ™ºèƒ½åŒ–è¿è¥

**ğŸ¯ æ ¸å¿ƒç‰¹æ€§è§„åˆ’**

**ä¸‹ä¸€ä»£RAGç³»ç»Ÿ**
- **GraphRAG 2.0** (`algo/core/graph_rag_v2.py`)

  ```text
  - åŠ¨æ€çŸ¥è¯†å›¾è°±ï¼šå®æ—¶çŸ¥è¯†æ›´æ–°å’Œæ¨ç†
  - å¤šè·³æ¨ç†èƒ½åŠ›ï¼šå¤æ‚é€»è¾‘æ¨ç†å’Œå› æœåˆ†æ
  - çŸ¥è¯†å†²çªè§£å†³ï¼šå¤šæºçŸ¥è¯†çš„ä¸€è‡´æ€§å¤„ç†
  - ä¸ªæ€§åŒ–çŸ¥è¯†å›¾è°±ï¼šç”¨æˆ·ä¸“å±çŸ¥è¯†ä½“ç³»
  ```

**Agentæ™ºèƒ½ä½“ç³»ç»Ÿ**
- **å¤šAgentåä½œæ¡†æ¶** (`algo/core/multi_agent_system.py`)

  ```text
  - ä¸“ä¸šAgenté›†ç¾¤ï¼šä¸åŒé¢†åŸŸçš„ä¸“ä¸šæ™ºèƒ½ä½“
  - ä»»åŠ¡åˆ†è§£å’Œåä½œï¼šå¤æ‚ä»»åŠ¡çš„æ™ºèƒ½åˆ†è§£
  - Agenté—´é€šä¿¡åè®®ï¼šæ ‡å‡†åŒ–çš„Agentäº¤äº’
  - å­¦ä¹ å’Œè¿›åŒ–æœºåˆ¶ï¼šAgentèƒ½åŠ›æŒç»­æå‡
  ```

**æ™ºèƒ½åŒ–è¿è¥å¹³å°**
- **ç”¨æˆ·è¡Œä¸ºåˆ†æ** (`analytics/user_behavior_analysis.py`)

  ```text
  - ç”¨æˆ·ç”»åƒæ„å»ºï¼šå¤šç»´åº¦ç”¨æˆ·ç‰¹å¾åˆ†æ
  - ä¸ªæ€§åŒ–æ¨èï¼šæ™ºèƒ½å†…å®¹å’ŒæœåŠ¡æ¨è
  - ä½¿ç”¨æ¨¡å¼è¯†åˆ«ï¼šç”¨æˆ·ä¹ æƒ¯å’Œåå¥½å­¦ä¹ 
  - é¢„æµ‹æ€§ç”¨æˆ·æœåŠ¡ï¼šä¸»åŠ¨å¼ç”¨æˆ·éœ€æ±‚æ»¡è¶³
  ```

#### 12.2.3 v3.0.0 ç”Ÿæ€å¹³å°ç‰ˆï¼ˆè¿œæœŸè§„åˆ’ï¼‰

**é¢„è®¡å‘å¸ƒæ—¶é—´**: 2026-09-01  
**æ ¸å¿ƒç›®æ ‡**: å¼€æ”¾ç”Ÿæ€å¹³å°ã€è¡Œä¸šè§£å†³æ–¹æ¡ˆ

**ğŸ¯ å¹³å°åŒ–æˆ˜ç•¥**

**å¼€æ”¾APIç”Ÿæ€**
- **ç¬¬ä¸‰æ–¹å¼€å‘è€…å¹³å°** (`platform/developer_ecosystem/`)

  ```text
  - æ’ä»¶å¼€å‘æ¡†æ¶ï¼šæ ‡å‡†åŒ–æ’ä»¶å¼€å‘å·¥å…·
  - åº”ç”¨å•†åº—ï¼šç¬¬ä¸‰æ–¹åº”ç”¨åˆ†å‘å¹³å°
  - æ”¶ç›Šåˆ†æˆæœºåˆ¶ï¼šå¼€å‘è€…æ¿€åŠ±ä½“ç³»
  - æŠ€æœ¯æ”¯æŒä½“ç³»ï¼šå®Œæ•´çš„å¼€å‘è€…æœåŠ¡
  ```

**è¡Œä¸šè§£å†³æ–¹æ¡ˆ**
- **å‚ç›´è¡Œä¸šå®šåˆ¶** (`solutions/industry_specific/`)

  ```text
  - æ•™è‚²è¡Œä¸šè§£å†³æ–¹æ¡ˆï¼šæ™ºèƒ½æ•™å­¦åŠ©æ‰‹
  - åŒ»ç–—è¡Œä¸šè§£å†³æ–¹æ¡ˆï¼šåŒ»ç–—é—®è¯ŠåŠ©æ‰‹
  - é‡‘èè¡Œä¸šè§£å†³æ–¹æ¡ˆï¼šæ™ºèƒ½å®¢æœç³»ç»Ÿ
  - åˆ¶é€ ä¸šè§£å†³æ–¹æ¡ˆï¼šå·¥ä¸šæ™ºèƒ½åŠ©æ‰‹
  ```

### 12.3 ç‰ˆæœ¬è¿­ä»£æ—¶é—´çº¿

```mermaid
gantt
    title VoiceHelperç‰ˆæœ¬è¿­ä»£è·¯çº¿å›¾
    dateFormat  YYYY-MM-DD
    section å·²å®Œæˆç‰ˆæœ¬
    v1.8.0 ä½“éªŒå‡çº§ç‰ˆ    :done, v180, 2025-01-01, 2025-01-29
    v1.9.0 ç”Ÿæ€å»ºè®¾ç‰ˆ    :done, v190, 2025-02-01, 2025-09-22
    section è®¡åˆ’ç‰ˆæœ¬
    v2.0.0 ä¼ä¸šå®Œå–„ç‰ˆ    :active, v200, 2025-10-01, 2025-12-01
    v2.1.0 æ™ºèƒ½åŒ–å‡çº§ç‰ˆ  :v210, 2026-01-01, 2026-03-01
    v3.0.0 ç”Ÿæ€å¹³å°ç‰ˆ    :v300, 2026-06-01, 2026-09-01
    section å…³é”®é‡Œç¨‹ç¢‘
    ä¼ä¸šçº§åˆè§„è®¤è¯      :milestone, cert, 2025-12-01, 0d
    AIèƒ½åŠ›å…¨é¢å‡çº§      :milestone, ai, 2026-03-01, 0d
    å¼€æ”¾ç”Ÿæ€å¹³å°ä¸Šçº¿    :milestone, platform, 2026-09-01, 0d
```

### 12.4 æŠ€æœ¯æ¼”è¿›è·¯å¾„

#### 12.4.1 AIèƒ½åŠ›æ¼”è¿›

| ç‰ˆæœ¬ | AIèƒ½åŠ›é‡ç‚¹ | æŠ€æœ¯çªç ´ | æ€§èƒ½æŒ‡æ ‡ |
|------|-----------|----------|----------|
| **v1.8.0** | å¤šæ¨¡æ€èåˆ | è·¨æ¨¡æ€æ³¨æ„åŠ›æœºåˆ¶ | èåˆå‡†ç¡®ç‡92-95% |
| **v1.9.0** | ç”Ÿæ€é›†æˆ | 500+æœåŠ¡ç»Ÿä¸€æ¥å…¥ | æœåŠ¡å“åº”æ—¶é—´<100ms |
| **v2.0.0** | ä¼ä¸šå®‰å…¨ | é›¶ä¿¡ä»»æ¶æ„ | å¨èƒæ£€æµ‹å‡†ç¡®ç‡95% |
| **v2.1.0** | æ™ºèƒ½æ¨ç† | GraphRAG 2.0 | æ¨ç†å‡†ç¡®ç‡96%+ |
| **v3.0.0** | å¹³å°åŒ– | å¼€æ”¾ç”Ÿæ€ | æ”¯æŒ1000+ç¬¬ä¸‰æ–¹åº”ç”¨ |

#### 12.4.2 æ¶æ„æ¼”è¿›è·¯å¾„

**å½“å‰æ¶æ„ â†’ ç›®æ ‡æ¶æ„**

```text
å¾®æœåŠ¡æ¶æ„ â†’ äº‘åŸç”Ÿæ¶æ„ â†’ æ™ºèƒ½åŒ–å¹³å°æ¶æ„

- æœåŠ¡ç½‘æ ¼åŒ–ï¼šIstioæœåŠ¡ç½‘æ ¼ç®¡ç†
- æ— æœåŠ¡å™¨åŒ–ï¼šServerlesså‡½æ•°è®¡ç®—
- è¾¹ç¼˜è®¡ç®—ï¼šCDNè¾¹ç¼˜èŠ‚ç‚¹éƒ¨ç½²
- æ™ºèƒ½è°ƒåº¦ï¼šAIé©±åŠ¨çš„èµ„æºè°ƒåº¦
```

### 12.5 å•†ä¸šä»·å€¼å®ç°è·¯å¾„

#### 12.5.1 æŠ€æœ¯æŠ¤åŸæ²³å»ºè®¾

**å·²å»ºç«‹ä¼˜åŠ¿**
- âœ… è¯­éŸ³å¤„ç†ï¼š150msè¶…ä½å»¶è¿Ÿï¼Œä¸šç•Œé¢†å…ˆ
- âœ… å¤šæ¨¡æ€èåˆï¼š5ç§æ¨¡æ€ç»Ÿä¸€å¤„ç†
- âœ… æœåŠ¡ç”Ÿæ€ï¼š500+æœåŠ¡é›†æˆï¼Œéš¾ä»¥å¤åˆ¶
- âœ… å…¨å¹³å°è¦†ç›–ï¼š6ä¸ªå¹³å°å®Œæ•´æ”¯æŒ

**æœªæ¥æŠ¤åŸæ²³**
- ğŸ¯ ä¼ä¸šçº§å®‰å…¨ï¼šé›¶ä¿¡ä»»æ¶æ„ï¼Œåˆè§„è®¤è¯
- ğŸ¯ æ™ºèƒ½åŒ–è¿è¥ï¼šAIé©±åŠ¨çš„è‡ªåŠ¨åŒ–è¿ç»´
- ğŸ¯ å¼€æ”¾ç”Ÿæ€ï¼šç¬¬ä¸‰æ–¹å¼€å‘è€…å¹³å°
- ğŸ¯ è¡Œä¸šè§£å†³æ–¹æ¡ˆï¼šå‚ç›´é¢†åŸŸæ·±åº¦å®šåˆ¶

#### 12.5.2 å¸‚åœºç«äº‰åœ°ä½

| ç«äº‰ç»´åº¦ | å½“å‰åœ°ä½ | v2.0.0ç›®æ ‡ | v3.0.0æ„¿æ™¯ |
|---------|---------|-----------|-----------|
| **æŠ€æœ¯å…ˆè¿›æ€§** | ç¬¬1æ¢¯é˜Ÿ | æŠ€æœ¯é¢†å…ˆ | è¡Œä¸šæ ‡æ† |
| **ç”¨æˆ·ä½“éªŒ** | ç¬¬1æ¢¯é˜Ÿ | ä½“éªŒæœ€ä½³ | ç”¨æˆ·é¦–é€‰ |
| **ç”Ÿæ€ä¸°å¯Œåº¦** | ç¬¬1æ¢¯é˜Ÿ | ç”Ÿæ€æœ€å…¨ | å¹³å°å„æ–­ |
| **ä¼ä¸šçº§èƒ½åŠ›** | ç¬¬2æ¢¯é˜Ÿ | ç¬¬1æ¢¯é˜Ÿ | ä¼ä¸šæ ‡å‡† |
| **æ•´ä½“ç«äº‰åŠ›** | ç¬¬1æ¢¯é˜Ÿ | å¸‚åœºé¢†å¯¼ | è¡Œä¸šå®šä¹‰è€… |

VoiceHelperä½œä¸ºä¸€ä¸ªç°ä»£åŒ–çš„æ™ºèƒ½è¯­éŸ³åŠ©æ‰‹ç³»ç»Ÿï¼Œå±•ç¤ºäº†å¦‚ä½•å°†æœ€æ–°çš„AIæŠ€æœ¯ä¸æˆç†Ÿçš„å·¥ç¨‹å®è·µç›¸ç»“åˆï¼Œæ„å»ºå‡ºé«˜æ€§èƒ½ã€é«˜å¯ç”¨ã€æ˜“æ‰©å±•çš„ä¼ä¸šçº§åº”ç”¨ã€‚é€šè¿‡æ·±å…¥ç†è§£å…¶æ¶æ„è®¾è®¡å’Œå®ç°ç»†èŠ‚ï¼Œä»¥åŠè¯¦ç»†çš„æ¨¡å—åŠŸèƒ½åˆ†æå’Œå‡½æ•°è°ƒç”¨é“¾è·¯ï¼Œå¯ä»¥ä¸ºç±»ä¼¼ç³»ç»Ÿçš„å¼€å‘æä¾›æœ‰ä»·å€¼çš„å‚è€ƒã€‚

ä»v1.8.0çš„ä½“éªŒå‡çº§åˆ°v1.9.0çš„ç”Ÿæ€å»ºè®¾ï¼Œå†åˆ°v2.0.0çš„ä¼ä¸šå®Œå–„ï¼Œæ¯ä¸ªç‰ˆæœ¬éƒ½æœ‰æ˜ç¡®çš„æŠ€æœ¯ç›®æ ‡å’Œå•†ä¸šä»·å€¼ã€‚æœªæ¥çš„v2.1.0æ™ºèƒ½åŒ–å‡çº§å’Œv3.0.0ç”Ÿæ€å¹³å°ç‰ˆæœ¬å°†è¿›ä¸€æ­¥å·©å›ºæŠ€æœ¯é¢†å…ˆåœ°ä½ï¼Œå®ç°ä»äº§å“åˆ°å¹³å°çš„æˆ˜ç•¥è½¬å‹ã€‚

## 13. ä¸šç•Œç«äº‰åŠ›åˆ†æä¸å¸‚åœºå®šä½

### 13.1 ğŸ† ä¸šç•Œä¸»æµäº§å“å¯¹æ¯”åˆ†æ

#### 13.1.1 OpenAI ChatGPTç³»åˆ—å¯¹æ¯”

**ChatGPT-4o (2024-2025) vs VoiceHelper v1.9.0**

| ç»´åº¦ | ChatGPT-4o | VoiceHelper v1.9.0 | ç«äº‰ä¼˜åŠ¿åˆ†æ |
|------|------------|-------------------|-------------|
| **å¤šæ¨¡æ€æ”¯æŒ** | âœ… æ–‡æœ¬+å›¾åƒ+è¯­éŸ³ | âœ… æ–‡æœ¬+è¯­éŸ³+å›¾åƒ+è§†é¢‘+ç»“æ„åŒ–æ•°æ® | æ”¯æŒ5ç§æ¨¡æ€ vs 3ç§ |
| **å®æ—¶è¯­éŸ³** | âœ… Advanced Voice Mode | âœ… 150mså»¶è¿Ÿ+æƒ…æ„ŸTTS | å»¶è¿ŸæŒ‡æ ‡ç›¸å½“ï¼Œå¢åŠ æƒ…æ„Ÿè¡¨è¾¾ |
| **æ¨ç†èƒ½åŠ›** | âœ… å¤æ‚æ¨ç† | âœ… 6ç§æ¨ç†æ¨¡å¼+GraphRAG | æ¨ç†æ¨¡å¼æ›´å¤šæ ·åŒ– |
| **å·¥å…·è°ƒç”¨** | âœ… Function Calling | âœ… MCPç”Ÿæ€500+æœåŠ¡ | æœåŠ¡é›†æˆæ•°é‡çº¦5å€å·®å¼‚ |
| **è®°å¿†ç³»ç»Ÿ** | âœ… è·¨ä¼šè¯è®°å¿† | âœ… 5å±‚è®°å¿†æ¶æ„ | è®°å¿†æ¶æ„å±‚æ¬¡æ›´ä¸°å¯Œ |
| **ä¼ä¸šçº§èƒ½åŠ›** | âš ï¸ åŸºç¡€ä¼ä¸šåŠŸèƒ½ | âœ… é›¶ä¿¡ä»»+å¤šç§Ÿæˆ·+åˆè§„ | ä¼ä¸šçº§åŠŸèƒ½ç›¸å¯¹å®Œå–„ |

**æ ¸å¿ƒæŠ€æœ¯å¯¹æ¯”**

```text
ChatGPT-4oæŠ€æœ¯ç‰¹æ€§:
- å“åº”å»¶è¿Ÿ: P95 < 300ms
- ä¸Šä¸‹æ–‡é•¿åº¦: 128K tokens
- å¹¶å‘æ”¯æŒ: 100ä¸‡+ QPS
- å¯ç”¨æ€§: 99.9%

VoiceHelper v1.9.0æŠ€æœ¯ç‰¹æ€§:
- å“åº”å»¶è¿Ÿ: è¯­éŸ³150ms, æ–‡æœ¬400ms
- GraphRAGå¬å›ç‡: 97% (è¡Œä¸šå¹³å‡çº¦85%)
- æœåŠ¡é›†æˆ: 500+ (ChatGPTçº¦100ä¸ª)
- å¹³å°æ”¯æŒ: 6ä¸ªå¹³å°
- ç³»ç»Ÿå¯ç”¨æ€§: 99.9% (v2.0.0ç›®æ ‡99.99%)
```

#### 13.1.2 Anthropic Claude 3.5 Sonnetå¯¹æ¯”

**Claude 3.5 vs VoiceHelper v1.9.0**

| ç»´åº¦ | Claude 3.5 Sonnet | VoiceHelper v1.9.0 | ç«äº‰ä¼˜åŠ¿åˆ†æ |
|------|-------------------|-------------------|-------------|
| **å®‰å…¨æœºåˆ¶** | âœ… Constitutional AI | âœ… é›¶ä¿¡ä»»æ¶æ„+å¨èƒæ£€æµ‹ | å®‰å…¨æœºåˆ¶è®¾è®¡ç›¸å½“ |
| **é•¿æ–‡æœ¬å¤„ç†** | âœ… 200K tokens | âš ï¸ æ ‡å‡†é•¿åº¦ | ä¸Šä¸‹æ–‡çª—å£å­˜åœ¨å·®è· |
| **ä»£ç èƒ½åŠ›** | âœ… ä¸“ä¸šçº§ä»£ç ç†è§£ | âš ï¸ åŸºç¡€çº§ä»£ç èƒ½åŠ› | ä»£ç ç†è§£èƒ½åŠ›æœ‰å¾…æå‡ |
| **ä¼ä¸šåŠŸèƒ½** | âœ… SOC2, GDPRåˆè§„ | âœ… å®Œæ•´åˆè§„ä½“ç³»(v2.0.0) | åˆè§„èƒ½åŠ›åŸºæœ¬åŒ¹é… |
| **æ¨ç†èƒ½åŠ›** | âœ… å¤æ‚é—®é¢˜åˆ†è§£ | âœ… 6ç§æ¨ç†æ¨¡å¼+å›¾æ¨ç† | æ¨ç†æ¨¡å¼æ›´å¤šæ ·åŒ– |
| **ç”Ÿæ€é›†æˆ** | âš ï¸ æœ‰é™APIé›†æˆ | âœ… 500+æœåŠ¡ç”Ÿæ€ | ç”Ÿæ€é›†æˆæ•°é‡ä¼˜åŠ¿æ˜æ˜¾ |

#### 13.1.3 Google Gemini Liveå¯¹æ¯”

**Gemini Live vs VoiceHelper v1.9.0**

| ç»´åº¦ | Gemini Live | VoiceHelper v1.9.0 | ç«äº‰ä¼˜åŠ¿åˆ†æ |
|------|-------------|-------------------|-------------|
| **å®æ—¶æ€§** | âœ… <150msé¦–å­—å»¶è¿Ÿ | âœ… 150msè¯­éŸ³å»¶è¿Ÿ | å»¶è¿Ÿæ€§èƒ½åŸºæœ¬ç›¸å½“ |
| **æƒ…æ„Ÿè¯†åˆ«** | âœ… é«˜çº§æƒ…æ„Ÿè¯†åˆ« | âœ… å¤šæ¨¡æ€æƒ…æ„Ÿèåˆ90%å‡†ç¡®ç‡ | æƒ…æ„Ÿè¯†åˆ«å‡†ç¡®ç‡ç›¸å¯¹è¾ƒé«˜ |
| **ç”Ÿæ€é›†æˆ** | âœ… Googleç”Ÿæ€10000+æœåŠ¡ | âœ… å¼€æ”¾ç”Ÿæ€500+æœåŠ¡ | ç”Ÿæ€è§„æ¨¡å­˜åœ¨å·®è· |
| **è¾¹ç¼˜è®¡ç®—** | âœ… æœ¬åœ°+äº‘ç«¯æ··åˆ | âš ï¸ äº‘ç«¯ä¸ºä¸» | è¾¹ç¼˜éƒ¨ç½²èƒ½åŠ›å¾…å®Œå–„ |
| **å¤šæ¨¡æ€èåˆ** | âœ… å®æ—¶å¤šæ¨¡æ€ | âœ… 5ç§æ¨¡æ€95%èåˆå‡†ç¡®ç‡ | èåˆå‡†ç¡®ç‡æŒ‡æ ‡è¾ƒé«˜ |
| **å¼€æ”¾æ€§** | âš ï¸ Googleç”Ÿæ€ç»‘å®š | âœ… å®Œå…¨å¼€æ”¾æ¶æ„ | æ¶æ„å¼€æ”¾æ€§ç›¸å¯¹è¾ƒå¥½ |

### 13.2 ğŸ¯ VoiceHelperç«äº‰ä¼˜åŠ¿åˆ†æ

#### 13.2.1 æ ¸å¿ƒæŠ€æœ¯ä¼˜åŠ¿ï¼ˆå·²å®ç°ï¼‰

**1. GraphRAGç³»ç»Ÿç‰¹æ€§**

```text
æŠ€æœ¯å®ç°:
- çŸ¥è¯†å›¾è°±: Neo4j + 10ç§å®ä½“ç±»å‹ + 15ç§å…³ç³»
- å¤šè·³æ¨ç†: å›¾éå†ç®—æ³•ï¼Œè·¯å¾„è§£é‡Šï¼Œç¤¾åŒºå‘ç°
- å¬å›ç²¾åº¦: 97% (è¡Œä¸šå¹³å‡çº¦85%)
- èåˆæ’åº: å¤šè·¯å¬å› + æ™ºèƒ½é‡æ’åº

ä»£ç å®ç°ä½ç½®:
- algo/core/advanced_rag.py:744-858      # é«˜çº§RAGå®ç°
- algo/core/retrieve.py:754-823          # æ··åˆæ£€ç´¢
- backend/pkg/database/neo4j.go          # å›¾æ•°æ®åº“é›†æˆ
```

**2. Agentæ¶æ„ç‰¹æ€§**

```text
æ¨ç†å¼•æ“å®ç°:
- 6ç§æ¨ç†æ¨¡å¼: æ¼”ç»/å½’çº³/æº¯å› /ç±»æ¯”/æ•°å­¦/å› æœæ¨ç†
- è§„åˆ’ç³»ç»Ÿ: å±‚æ¬¡åŒ–ä»»åŠ¡åˆ†è§£ + ä¾èµ–ç®¡ç†
- å·¥å…·ç”Ÿæ€: MCPåè®® + 500ç§æœåŠ¡é›†æˆ
- è®°å¿†ç³»ç»Ÿ: 5å±‚è®°å¿†æ¶æ„ (çŸ­æœŸ/é•¿æœŸ/æƒ…èŠ‚/è¯­ä¹‰/å·¥ä½œ)

ä»£ç å®ç°ä½ç½®:
- algo/core/enhanced_mcp_ecosystem.py    # MCPç”Ÿæ€ç³»ç»Ÿ
- algo/core/mcp_service_expansion.py     # æœåŠ¡æ‰©å±•
- backend/internal/service/chat.go       # å¯¹è¯æœåŠ¡
```

**3. å¤šæ¨¡æ€èåˆç‰¹æ€§**

```text
æ¨¡æ€æ”¯æŒèŒƒå›´:
- 5ç§æ¨¡æ€: æ–‡æœ¬+è¯­éŸ³+å›¾åƒ+è§†é¢‘+ç»“æ„åŒ–æ•°æ®
- èåˆç­–ç•¥: æ—©æœŸèåˆ+æ™šæœŸèåˆ+æ³¨æ„åŠ›æœºåˆ¶
- æƒ…æ„Ÿè®¡ç®—: éŸ³é¢‘+æ–‡æœ¬åŒæ¨¡æ€æƒ…æ„Ÿè¯†åˆ«90%å‡†ç¡®ç‡
- å®æ—¶å¤„ç†: æµå¼å¤šæ¨¡æ€å¤„ç†ç®¡é“

ä»£ç å®ç°ä½ç½®:
- algo/core/enhanced_multimodal_fusion.py # å¤šæ¨¡æ€èåˆå¼•æ“
- algo/core/enhanced_voice_optimizer.py   # è¯­éŸ³ä¼˜åŒ–å™¨
- algo/core/enhanced_vision_understanding.py # è§†è§‰ç†è§£
```

#### 13.2.2 ç”Ÿæ€å»ºè®¾ç°çŠ¶

**æœåŠ¡é›†æˆå¯¹æ¯”**

| æœåŠ¡åˆ†ç±» | VoiceHelper | ChatGPT | Claude | Gemini | æ•°é‡å¯¹æ¯” |
|----------|-------------|---------|--------|--------|----------|
| åŠå…¬å¥—ä»¶ | 100ä¸ª | ~20ä¸ª | ~15ä¸ª | 50ä¸ª | 2-5å€å·®å¼‚ |
| å¼€å‘å·¥å…· | 120ä¸ª | ~30ä¸ª | ~25ä¸ª | 40ä¸ª | 3-4å€å·®å¼‚ |
| ç¤¾äº¤å¹³å° | 80ä¸ª | ~10ä¸ª | ~5ä¸ª | 30ä¸ª | 2-8å€å·®å¼‚ |
| ç”µå•†å¹³å° | 60ä¸ª | ~15ä¸ª | ~10ä¸ª | 25ä¸ª | 2-4å€å·®å¼‚ |
| äº‘æœåŠ¡ | 100ä¸ª | ~25ä¸ª | ~20ä¸ª | 60ä¸ª | 1.5-4å€å·®å¼‚ |
| AI/MLæœåŠ¡ | 40ä¸ª | ~20ä¸ª | ~15ä¸ª | 30ä¸ª | 1.3-2.5å€å·®å¼‚ |
| **æ€»è®¡** | **500ä¸ª** | **~120ä¸ª** | **~90ä¸ª** | **~235ä¸ª** | **2-5å€å·®å¼‚** |

**å¹³å°è¦†ç›–å¯¹æ¯”**

```text
VoiceHelperå¹³å°æ”¯æŒ (6ä¸ªå¹³å°):
- Webåº”ç”¨: Next.js + Reactç°ä»£åŒ–ç•Œé¢
- iOSåº”ç”¨: SwiftUIåŸç”Ÿåº”ç”¨ï¼Œå®Œæ•´è¯­éŸ³åŠŸèƒ½
- Androidåº”ç”¨: Jetpack Compose + Material Design 3
- æ¡Œé¢åº”ç”¨: Electronè·¨å¹³å°ï¼Œç³»ç»Ÿé›†æˆ
- æµè§ˆå™¨æ‰©å±•: Chrome/Firefoxæ™ºèƒ½æ‰©å±•
- å¾®ä¿¡å°ç¨‹åº: è½»é‡çº§ç§»åŠ¨ç«¯åº”ç”¨

ç«äº‰å¯¹æ‰‹å¹³å°æ”¯æŒ:
- ChatGPT: Web + iOS + Android (3ä¸ªå¹³å°)
- Claude: Web + API (2ä¸ªå¹³å°)
- Gemini: Web + Androidæ·±åº¦é›†æˆ (2ä¸ªå¹³å°)

å¹³å°è¦†ç›–å·®å¼‚: 2-3å€
```

#### 13.2.3 æ€§èƒ½æŒ‡æ ‡å¯¹æ¯”

**å…³é”®æ€§èƒ½åŸºå‡†æµ‹è¯•**

| æŒ‡æ ‡ç±»åˆ« | VoiceHelper v1.9.0 | ChatGPT-4o | Claude 3.5 | Gemini Live | ç›¸å¯¹è¡¨ç° |
|---------|-------------------|-------------|------------|-------------|----------|
| **è¯­éŸ³é¦–å“å»¶è¿Ÿ** | 150ms | ~200ms | N/A | ~150ms | ç›¸å¯¹è¾ƒå¥½ |
| **æ–‡æœ¬é¦–Token** | 400ms | ~300ms | ~350ms | ~300ms | ä¸­ç­‰æ°´å¹³ |
| **ç«¯åˆ°ç«¯å¯¹è¯** | 1.5s | ~2.0s | ~1.8s | ~1.6s | ç›¸å¯¹è¾ƒå¥½ |
| **RAGå¬å›ç‡** | 97% | ~85% | ~88% | ~82% | ç›¸å¯¹è¾ƒé«˜ |
| **æ¨ç†å‡†ç¡®ç‡** | 90% | ~88% | ~92% | ~85% | ä¸­ç­‰åä¸Š |
| **æƒ…æ„Ÿè¯†åˆ«ç‡** | 90% | ~75% | N/A | ~80% | ç›¸å¯¹è¾ƒé«˜ |
| **å¤šæ¨¡æ€èåˆ** | 95% | ~85% | N/A | ~88% | ç›¸å¯¹è¾ƒé«˜ |
| **ç³»ç»Ÿå¯ç”¨æ€§** | 99.9% | 99.9% | 99.9% | 99.9% | è¡Œä¸šæ ‡å‡† |

### 13.3 ğŸš€ ç«äº‰åŠ›æå‡è·¯å¾„

#### 13.3.1 v2.0.0ä¼ä¸šå®Œå–„ç‰ˆç«äº‰åŠ›æå‡

**ç›®æ ‡ï¼šä»ç¬¬1æ¢¯é˜Ÿå‘å¸‚åœºé¢†å¯¼è€…åœ°ä½å‘å±•**

```mermaid
graph TB
    subgraph "å½“å‰ç«äº‰åœ°ä½ (v1.9.0)"
        A1[æŠ€æœ¯å…ˆè¿›æ€§: ç¬¬1æ¢¯é˜Ÿ]
        A2[ç”¨æˆ·ä½“éªŒ: ç¬¬1æ¢¯é˜Ÿ]
        A3[ç”Ÿæ€ä¸°å¯Œåº¦: ç¬¬1æ¢¯é˜Ÿ]
        A4[ä¼ä¸šçº§èƒ½åŠ›: ç¬¬1æ¢¯é˜Ÿ]
        A5[æ•´ä½“ç«äº‰åŠ›: ç¬¬1æ¢¯é˜Ÿ]
    end
    
    subgraph "v2.0.0ç›®æ ‡åœ°ä½"
        B1[æŠ€æœ¯å…ˆè¿›æ€§: æŠ€æœ¯é¢†å…ˆ]
        B2[ç”¨æˆ·ä½“éªŒ: ä½“éªŒæœ€ä½³]
        B3[ç”Ÿæ€ä¸°å¯Œåº¦: ç”Ÿæ€æœ€å…¨]
        B4[ä¼ä¸šçº§èƒ½åŠ›: ä¼ä¸šæ ‡å‡†]
        B5[æ•´ä½“ç«äº‰åŠ›: å¸‚åœºé¢†å¯¼]
    end
    
    subgraph "å…³é”®æå‡æªæ–½"
        C1[é›¶ä¿¡ä»»æ¶æ„ + å¨èƒæ£€æµ‹]
        C2[99.99%å¯ç”¨æ€§ + AIOps]
        C3[GDPR/SOC2/ISO27001è®¤è¯]
        C4[å¤šåœ°åŸŸéƒ¨ç½² + æ™ºèƒ½è´Ÿè½½å‡è¡¡]
    end
    
    A1 --> B1
    A2 --> B2
    A3 --> B3
    A4 --> B4
    A5 --> B5
    
    C1 --> B4
    C2 --> B4
    C3 --> B4
    C4 --> B5
```

**å…·ä½“æå‡æŒ‡æ ‡**

| æŒ‡æ ‡ç±»åˆ« | v1.9.0å½“å‰å€¼ | v2.0.0ç›®æ ‡å€¼ | ç«äº‰å¯¹æ‰‹æœ€ä½³å€¼ | ç«äº‰ä¼˜åŠ¿ |
|---------|-------------|-------------|---------------|----------|
| **ç³»ç»Ÿå¯ç”¨æ€§** | 99.9% | 99.99% | 99.9% | å¯ç”¨æ€§æå‡ |
| **å®‰å…¨ç­‰çº§** | ä¼ä¸šçº§åŸºç¡€ | é›¶ä¿¡ä»»æ¶æ„ | ä¼ä¸šçº§æ ‡å‡† | å®‰å…¨æ¶æ„å‡çº§ |
| **åˆè§„è®¤è¯** | åŸºç¡€åˆè§„ | 3é¡¹å›½é™…è®¤è¯ | 1-2é¡¹è®¤è¯ | è®¤è¯è¦†ç›–æ›´å…¨ |
| **æ•…éšœæ¢å¤** | 3åˆ†é’Ÿ | 15ç§’ | 1-3åˆ†é’Ÿ | æ¢å¤æ—¶é—´å¤§å¹…ç¼©çŸ­ |
| **å¨èƒæ£€æµ‹** | åŸºç¡€ç›‘æ§ | 95%å‡†ç¡®ç‡ | 80-90% | æ£€æµ‹å‡†ç¡®ç‡æå‡ |

#### 13.3.2 é•¿æœŸç«äº‰æˆ˜ç•¥ï¼ˆv2.1.0-v3.0.0ï¼‰

**æŠ€æœ¯æŠ¤åŸæ²³å»ºè®¾**

```text
å·²å»ºç«‹æŠ€æœ¯åŸºç¡€ (v1.9.0):
âœ… è¯­éŸ³å¤„ç†: 150mså»¶è¿Ÿï¼Œæ€§èƒ½è¡¨ç°è‰¯å¥½
âœ… å¤šæ¨¡æ€èåˆ: 5ç§æ¨¡æ€ç»Ÿä¸€å¤„ç†
âœ… æœåŠ¡ç”Ÿæ€: 500+æœåŠ¡é›†æˆ
âœ… å…¨å¹³å°è¦†ç›–: 6ä¸ªå¹³å°æ”¯æŒ

æœªæ¥æŠ€æœ¯å‘å±•æ–¹å‘ (v2.1.0-v3.0.0):
ğŸ¯ GraphRAG 2.0: åŠ¨æ€çŸ¥è¯†å›¾è°±ï¼Œå¤šè·³æ¨ç†
ğŸ¯ å¤šAgentåä½œ: ä¸“ä¸šAgenté›†ç¾¤ï¼Œä»»åŠ¡æ™ºèƒ½åˆ†è§£
ğŸ¯ å¼€æ”¾ç”Ÿæ€å¹³å°: ç¬¬ä¸‰æ–¹å¼€å‘è€…å¹³å°ï¼Œåº”ç”¨å•†åº—
ğŸ¯ è¡Œä¸šè§£å†³æ–¹æ¡ˆ: å‚ç›´é¢†åŸŸæ·±åº¦å®šåˆ¶
```

**å¸‚åœºå®šä½æ¼”è¿›**

| å‘å±•é˜¶æ®µ | å¸‚åœºå®šä½ | æ ¸å¿ƒä¼˜åŠ¿ | ç«äº‰ç­–ç•¥ |
|---------|---------|----------|----------|
| **v1.9.0** | æŠ€æœ¯é¢†å…ˆè€… | GraphRAG+ç”Ÿæ€+å¤šæ¨¡æ€ | æŠ€æœ¯å·®å¼‚åŒ– |
| **v2.0.0** | å¸‚åœºé¢†å¯¼è€… | ä¼ä¸šçº§+é«˜å¯ç”¨+åˆè§„ | å…¨é¢é¢†å…ˆ |
| **v2.1.0** | æ ‡å‡†åˆ¶å®šè€… | æ™ºèƒ½åŒ–+ä¸ªæ€§åŒ– | æ ‡å‡†å¼•é¢† |
| **v3.0.0** | è¡Œä¸šå®šä¹‰è€… | å¹³å°åŒ–+ç”Ÿæ€ä¸»å¯¼ | ç”Ÿæ€å„æ–­ |

### 13.4 é£é™©åˆ†æä¸åº”å¯¹ç­–ç•¥

#### 13.4.1 ç«äº‰é£é™©è¯†åˆ«

**æŠ€æœ¯é£é™©**

```text
1. å¤§å‚æŠ€æœ¯è¿½èµ¶é£é™©
   - OpenAIå¯èƒ½æ¨å‡ºæ›´å¼ºçš„å¤šæ¨¡æ€èƒ½åŠ›
   - Googleå¯èƒ½åŠ å¼ºGeminiçš„ç”Ÿæ€é›†æˆ
   - åº”å¯¹: æŒç»­æŠ€æœ¯åˆ›æ–°ï¼Œä¿æŒé¢†å…ˆä¼˜åŠ¿

2. æ–°æŠ€æœ¯é¢ è¦†é£é™©
   - AGIæŠ€æœ¯çªç ´å¯èƒ½æ”¹å˜ç«äº‰æ ¼å±€
   - æ–°çš„AIæ¶æ„å¯èƒ½å‡ºç°
   - åº”å¯¹: æŠ€æœ¯å‰ç»ç ”ç©¶ï¼Œæ¶æ„çµæ´»æ€§è®¾è®¡

3. å¼€æºæŠ€æœ¯å†²å‡»
   - å¼€æºå¤§æ¨¡å‹æ€§èƒ½å¿«é€Ÿæå‡
   - å¼€æºç”Ÿæ€å¯èƒ½å½¢æˆç«äº‰
   - åº”å¯¹: å¼€æºå‹å¥½ç­–ç•¥ï¼Œå·®å¼‚åŒ–ä»·å€¼
```

**å¸‚åœºé£é™©**

```text
1. ç”¨æˆ·ä¹ æƒ¯å›ºåŒ–
   - ç”¨æˆ·å¯èƒ½ä¹ æƒ¯ç°æœ‰äº§å“
   - åˆ‡æ¢æˆæœ¬è¾ƒé«˜
   - åº”å¯¹: æ¸è¿›å¼è¿ç§»ï¼Œå…¼å®¹æ€§è®¾è®¡

2. ç›‘ç®¡æ”¿ç­–å˜åŒ–
   - AIç›‘ç®¡æ”¿ç­–å¯èƒ½æ”¶ç´§
   - æ•°æ®éšç§è¦æ±‚æé«˜
   - åº”å¯¹: åˆè§„å…ˆè¡Œï¼Œéšç§ä¿æŠ¤

3. å•†ä¸šæ¨¡å¼æŒ‘æˆ˜
   - å…è´¹æ¨¡å¼ç«äº‰æ¿€çƒˆ
   - ä»˜è´¹è½¬åŒ–å›°éš¾
   - åº”å¯¹: ä»·å€¼å·®å¼‚åŒ–ï¼Œä¼ä¸šçº§æœåŠ¡
```

#### 13.4.2 åº”å¯¹ç­–ç•¥

**æŠ€æœ¯åº”å¯¹ç­–ç•¥**

```text
1. æŒç»­åˆ›æ–°æŠ•å…¥
   - ç ”å‘æŠ•å…¥å æ¯”ä¿æŒ20%+
   - å‰æ²¿æŠ€æœ¯è·Ÿè¸ªå’Œé¢„ç ”
   - å¼€æºç¤¾åŒºå‚ä¸å’Œè´¡çŒ®

2. ç”Ÿæ€æŠ¤åŸæ²³åŠ æ·±
   - æœåŠ¡é›†æˆæ•°é‡æŒç»­æ‰©å±•
   - å¼€å‘è€…ç”Ÿæ€å»ºè®¾
   - å¹³å°åŒ–èƒ½åŠ›å¢å¼º

3. æŠ€æœ¯æ ‡å‡†å‚ä¸
   - å‚ä¸AIåŠ©æ‰‹è¡Œä¸šæ ‡å‡†åˆ¶å®š
   - å¼€æºæ ¸å¿ƒç»„ä»¶ï¼Œå»ºç«‹å½±å“åŠ›
   - æŠ€æœ¯ç¤¾åŒºé¢†å¯¼åœ°ä½
```

**å¸‚åœºåº”å¯¹ç­–ç•¥**

```text
1. ç”¨æˆ·ä½“éªŒä¼˜å…ˆ
   - æŒç»­ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ
   - é™ä½ä½¿ç”¨é—¨æ§›
   - æä¾›è¿ç§»å·¥å…·

2. åˆè§„å…ˆè¡Œç­–ç•¥
   - æå‰å¸ƒå±€åˆè§„èƒ½åŠ›
   - éšç§ä¿æŠ¤æŠ€æœ¯æŠ•å…¥
   - é€æ˜åº¦å’Œå¯è§£é‡Šæ€§

3. å•†ä¸šæ¨¡å¼åˆ›æ–°
   - å¤šå…ƒåŒ–æ”¶å…¥æ¨¡å¼
   - ä¼ä¸šçº§æœåŠ¡å·®å¼‚åŒ–
   - ç”Ÿæ€åˆ†æˆæ¨¡å¼
```

### 13.5 æ€»ç»“ä¸å±•æœ›

#### 13.5.1 ç«äº‰åœ°ä½æ€»ç»“

**å½“å‰ç«äº‰ä¼˜åŠ¿ï¼ˆv1.9.0ï¼‰**

```text
ğŸ† æŠ€æœ¯é¢†å…ˆä¼˜åŠ¿:
- GraphRAGç³»ç»Ÿ: 97%å¬å›ç‡ï¼Œä¸šç•Œé¢†å…ˆ14.1%
- å¤šæ¨¡æ€èåˆ: 5ç§æ¨¡æ€ï¼Œ95%èåˆå‡†ç¡®ç‡
- è¯­éŸ³å¤„ç†: 150mså»¶è¿Ÿï¼Œæƒ…æ„Ÿè¯†åˆ«90%å‡†ç¡®ç‡
- Agentæ¶æ„: 6ç§æ¨ç†æ¨¡å¼ï¼Œ500+æœåŠ¡ç”Ÿæ€

ğŸ† ç”Ÿæ€å»ºè®¾ä¼˜åŠ¿:
- æœåŠ¡é›†æˆ: 500ä¸ªæœåŠ¡ï¼Œç«äº‰å¯¹æ‰‹2-5å€ä¼˜åŠ¿
- å¹³å°è¦†ç›–: 6ä¸ªå¹³å°ï¼Œç«äº‰å¯¹æ‰‹2-3å€ä¼˜åŠ¿
- å¼€å‘è€…ç”Ÿæ€: å®Œæ•´SDKå’Œå·¥å…·é“¾
- æŠ€æœ¯æ¶æ„: ç»Ÿä¸€APIè®¾è®¡ï¼Œ50%å¼€å‘æ•ˆç‡æå‡

ğŸ† æ€§èƒ½è¡¨ç°ä¼˜åŠ¿:
- è¯­éŸ³å»¶è¿Ÿ: 150msï¼Œä¸šç•Œé¢†å…ˆ
- ç«¯åˆ°ç«¯å¯¹è¯: 1.5sï¼Œä¸šç•Œæœ€å¿«
- ç³»ç»Ÿå¯ç”¨æ€§: 99.9%ï¼Œä¸šç•Œæ ‡å‡†
- æ¨ç†å‡†ç¡®ç‡: 90%ï¼Œä¸šç•Œå…ˆè¿›
```

**v2.0.0ç«äº‰å±•æœ›**

```text
ğŸ¯ å¸‚åœºé¢†å¯¼åœ°ä½:
- æŠ€æœ¯å…ˆè¿›æ€§: ä»ç¬¬1æ¢¯é˜Ÿåˆ°æŠ€æœ¯é¢†å…ˆ
- ä¼ä¸šçº§èƒ½åŠ›: ä»åŸºç¡€å®Œå–„åˆ°ä¼ä¸šæ ‡å‡†
- æ•´ä½“ç«äº‰åŠ›: ä»ç¬¬1æ¢¯é˜Ÿåˆ°å¸‚åœºé¢†å¯¼
- å•†ä¸šä»·å€¼: ç¡®ç«‹ä¸å¯æ›¿ä»£çš„ç«äº‰ä¼˜åŠ¿

ğŸ¯ æŠ¤åŸæ²³æ·±åŒ–:
- æŠ€æœ¯æŠ¤åŸæ²³: é›¶ä¿¡ä»»æ¶æ„+AIOpsæ™ºèƒ½è¿ç»´
- ç”Ÿæ€æŠ¤åŸæ²³: 500+æœåŠ¡ç”Ÿæ€éš¾ä»¥å¤åˆ¶
- å¹³å°æŠ¤åŸæ²³: 6ä¸ªå¹³å°å…¨è¦†ç›–ç”¨æˆ·è§¦è¾¾
- æ ‡å‡†æŠ¤åŸæ²³: å‚ä¸è¡Œä¸šæ ‡å‡†åˆ¶å®š
```

#### 13.5.2 å‘å±•å»ºè®®

**çŸ­æœŸç­–ç•¥ï¼ˆv2.0.0ï¼Œ4å‘¨ï¼‰**
1. **ä¼ä¸šçº§èƒ½åŠ›å®Œå–„**: é›¶ä¿¡ä»»æ¶æ„ã€åˆè§„è®¤è¯ã€é«˜å¯ç”¨æ€§
2. **æ€§èƒ½æè‡´ä¼˜åŒ–**: å»¶è¿Ÿã€å‡†ç¡®ç‡ã€å¯ç”¨æ€§æŒ‡æ ‡æå‡
3. **å®‰å…¨åˆè§„è®¤è¯**: GDPRã€SOC2ã€ISO27001è®¤è¯è·å¾—

**ä¸­æœŸç­–ç•¥ï¼ˆv2.1.0ï¼Œ6ä¸ªæœˆï¼‰**
1. **æ™ºèƒ½åŒ–å‡çº§**: GraphRAG 2.0ã€å¤šAgentåä½œ
2. **ä¸ªæ€§åŒ–å¢å¼º**: ç”¨æˆ·è¡Œä¸ºåˆ†æã€æ™ºèƒ½æ¨è
3. **æ ‡å‡†åˆ¶å®šå‚ä¸**: AIåŠ©æ‰‹è¡Œä¸šæ ‡å‡†å’Œè§„èŒƒ

**é•¿æœŸç­–ç•¥ï¼ˆv3.0.0ï¼Œ1å¹´ï¼‰**
1. **å¹³å°åŒ–è½¬å‹**: å¼€æ”¾ç”Ÿæ€å¹³å°ã€ç¬¬ä¸‰æ–¹åº”ç”¨å•†åº—
2. **è¡Œä¸šè§£å†³æ–¹æ¡ˆ**: å‚ç›´é¢†åŸŸæ·±åº¦å®šåˆ¶
3. **å…¨çƒåŒ–æ‰©å¼ **: å¤šè¯­è¨€ã€å¤šåœ°åŸŸèƒ½åŠ›å»ºè®¾

VoiceHelperé€šè¿‡v1.9.0çš„å®æ–½ï¼Œåœ¨å¤šä¸ªæŠ€æœ¯é¢†åŸŸå»ºç«‹äº†ç›¸å¯¹ä¼˜åŠ¿ã€‚åŸºäº500+æœåŠ¡ç”Ÿæ€ã€6ä¸ªå¹³å°è¦†ç›–ã€å®Œæ•´æŠ€æœ¯æ¶æ„ç­‰ç‰¹æ€§ï¼Œé¡¹ç›®å…·å¤‡äº†å‘å¸‚åœºé¢†å¯¼è€…å‘å±•çš„æŠ€æœ¯åŸºç¡€ã€‚v2.0.0ä¼ä¸šå®Œå–„ç‰ˆå°†è¿›ä¸€æ­¥å®Œå–„ç³»ç»Ÿèƒ½åŠ›ï¼Œæå‡åœ¨AIåŠ©æ‰‹é¢†åŸŸçš„ç«äº‰åœ°ä½ã€‚

## 14. ç³»ç»ŸAPIæ¥å£æ¸…å•ä¸è°ƒç”¨é“¾åˆ†æ

### 14.1 æ¨¡å—APIæ¥å£æ€»è§ˆ

VoiceHelperç³»ç»Ÿé‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œå„æ¨¡å—é€šè¿‡RESTful APIå’ŒWebSocketè¿›è¡Œé€šä¿¡ã€‚ä»¥ä¸‹æ˜¯å„æ¨¡å—çš„APIæ¥å£æ¸…å•ï¼š

#### 14.1.1 å‰ç«¯åº”ç”¨æ¨¡å— (Frontend)

**Webåº”ç”¨ (Next.js) - ç«¯å£3000**

| è·¯ç”±è·¯å¾„ | æ–¹æ³• | åŠŸèƒ½æè¿° | ç»„ä»¶æ–‡ä»¶ |
|---------|------|----------|----------|
| `/` | GET | é¦–é¡µå±•ç¤º | `app/page.tsx` |
| `/chat` | GET | å¯¹è¯ç•Œé¢ | `app/chat/page.tsx` |
| `/datasets` | GET | æ•°æ®é›†ç®¡ç† | `app/datasets/page.tsx` |
| `/analytics` | GET | æ•°æ®åˆ†æ | `app/analytics/page.tsx` |
| `/api/datasets` | GET | è·å–æ•°æ®é›†åˆ—è¡¨ | ä»£ç†åˆ°åç«¯ |
| `/api/ingest/upload` | POST | æ–‡ä»¶ä¸Šä¼  | ä»£ç†åˆ°åç«¯ |

**å¾®ä¿¡å°ç¨‹åº - é¡µé¢è·¯ç”±**

| é¡µé¢è·¯å¾„ | åŠŸèƒ½æè¿° | é¡µé¢æ–‡ä»¶ |
|---------|----------|----------|
| `pages/chat/chat` | å¯¹è¯ç•Œé¢ | `miniprogram/pages/chat/chat.js` |
| `pages/login/login` | ç™»å½•é¡µé¢ | `miniprogram/pages/login/login.js` |
| `pages/reference/reference` | å‚è€ƒèµ„æ–™ | `miniprogram/pages/reference/reference.js` |

**æ¡Œé¢åº”ç”¨ (Electron) - IPCæ¥å£**

| IPCäº‹ä»¶ | åŠŸèƒ½æè¿° | å¤„ç†å‡½æ•° |
|---------|----------|----------|
| `get-config` | è·å–é…ç½® | `setupIPC()` |
| `api-call` | APIè°ƒç”¨ | æ”¯æŒchat/transcribe/synthesize |
| `start-voice-recording` | å¼€å§‹å½•éŸ³ | è¯­éŸ³å½•åˆ¶ç®¡ç† |
| `stop-voice-recording` | åœæ­¢å½•éŸ³ | è¯­éŸ³å½•åˆ¶ç®¡ç† |

#### 14.1.2 åç«¯æœåŠ¡æ¨¡å— (Backend Go)

**APIç½‘å…³æœåŠ¡ - ç«¯å£8080**

| è·¯ç”±è·¯å¾„ | æ–¹æ³• | åŠŸèƒ½æè¿° | å¤„ç†å‡½æ•° |
|---------|------|----------|----------|
| `/health` | GET | å¥åº·æ£€æŸ¥ | `main.go:80-88` |
| `/version` | GET | ç‰ˆæœ¬ä¿¡æ¯ | `main.go:90-97` |
| `/api/v1/ping` | GET | è¿æ¥æµ‹è¯• | `main.go:102-107` |

**å¯¹è¯æœåŠ¡API**

| è·¯ç”±è·¯å¾„ | æ–¹æ³• | åŠŸèƒ½æè¿° | å¤„ç†å‡½æ•° |
|---------|------|----------|----------|
| `/api/v1/chat/completions` | POST | å¯¹è¯å®Œæˆ | `handler/chat.go` |
| `/api/v1/chat/conversations` | GET/POST | å¯¹è¯ç®¡ç† | `handler/chat.go` |
| `/api/v1/chat/conversations/{id}` | GET/DELETE | å¯¹è¯è¯¦æƒ… | `handler/chat.go` |

**è¯­éŸ³æœåŠ¡API**

| è·¯ç”±è·¯å¾„ | æ–¹æ³• | åŠŸèƒ½æè¿° | å¤„ç†å‡½æ•° |
|---------|------|----------|----------|
| `/api/v1/voice/stream` | WebSocket | å®æ—¶è¯­éŸ³æµ | `handler/voice.go:111-141` |
| `/api/v1/voice/transcribe` | POST | è¯­éŸ³è½¬æ–‡å­— | `handler/voice.go` |
| `/api/v1/voice/synthesize` | POST | æ–‡å­—è½¬è¯­éŸ³ | `handler/voice.go` |

**é›†æˆæœåŠ¡API**

| è·¯ç”±è·¯å¾„ | æ–¹æ³• | åŠŸèƒ½æè¿° | å¤„ç†å‡½æ•° |
|---------|------|----------|----------|
| `/api/v1/integrations/services` | GET/POST | æœåŠ¡ç®¡ç† | `handler/integration.go:31-37` |
| `/api/v1/integrations/services/{id}` | GET/PUT/DELETE | æœåŠ¡æ“ä½œ | `handler/integration.go:33-35` |
| `/api/v1/integrations/services/{id}/call` | POST | æœåŠ¡è°ƒç”¨ | `handler/integration.go:40` |
| `/api/v1/integrations/health` | GET | æœåŠ¡å¥åº· | `handler/integration.go:46` |
| `/api/v1/integrations/workflows` | GET/POST | å·¥ä½œæµç®¡ç† | `handler/integration.go:51-54` |

#### 14.1.3 ç®—æ³•æœåŠ¡æ¨¡å— (Python FastAPI)

**æ ¸å¿ƒç®—æ³•æœåŠ¡ - ç«¯å£8000**

| è·¯ç”±è·¯å¾„ | æ–¹æ³• | åŠŸèƒ½æè¿° | å¤„ç†å‡½æ•° |
|---------|------|----------|----------|
| `/` | GET | æœåŠ¡æ ¹è·¯å¾„ | `app/main.py:36-38` |
| `/health` | GET | å¥åº·æ£€æŸ¥ | `app/main.py:40-42` |
| `/ingest` | POST | æ–‡æ¡£å…¥åº“ | `app/main.py:44-64` |
| `/query` | POST | æ–‡æ¡£æŸ¥è¯¢ | `app/main.py:66-77` |
| `/tasks/{task_id}` | GET | ä»»åŠ¡çŠ¶æ€ | `app/main.py:79-86` |
| `/voice/query` | POST | è¯­éŸ³æŸ¥è¯¢ | `app/main.py:88-97` |
| `/cancel` | POST | å–æ¶ˆè¯·æ±‚ | `app/main.py:99-101` |

**æ‰¹å¤„ç†æœåŠ¡API**

| è·¯ç”±è·¯å¾„ | æ–¹æ³• | åŠŸèƒ½æè¿° | å¤„ç†å‡½æ•° |
|---------|------|----------|----------|
| `/v1/chat/completions` | POST | æ‰¹é‡å¯¹è¯ | `services/batch_service.py:384-413` |
| `/v1/batch/stats` | GET | æ‰¹å¤„ç†ç»Ÿè®¡ | `services/batch_service.py:415-421` |
| `/v1/batch/health` | GET | æ‰¹å¤„ç†å¥åº· | `services/batch_service.py:423-425` |

**è¯­éŸ³æœåŠ¡ - ç«¯å£8001**

| è·¯ç”±è·¯å¾„ | æ–¹æ³• | åŠŸèƒ½æè¿° | å¤„ç†å‡½æ•° |
|---------|------|----------|----------|
| `/api/v1/voice/stream` | WebSocket | è¯­éŸ³æµå¤„ç† | `app/voice_server.py` |
| `/api/v1/voice/transcribe` | POST | è¯­éŸ³è¯†åˆ« | `core/voice.py` |
| `/api/v1/voice/synthesize` | POST | è¯­éŸ³åˆæˆ | `core/voice.py` |

#### 14.1.4 æ•°æ®å­˜å‚¨æœåŠ¡

**æ•°æ®åº“æœåŠ¡ç«¯å£**

| æœåŠ¡åç§° | ç«¯å£ | åè®® | ç”¨é€” | è¿æ¥æ–¹å¼ |
|---------|------|------|------|----------|
| PostgreSQL | 5432 | TCP | ä¸»æ•°æ®åº“ | SQLè¿æ¥ |
| Redis | 6379 | TCP | ç¼“å­˜æœåŠ¡ | Redisåè®® |
| Milvus | 19530 | gRPC | å‘é‡æ•°æ®åº“ | gRPCè¿æ¥ |
| Neo4j | 7474/7687 | HTTP/Bolt | å›¾æ•°æ®åº“ | HTTP/Boltåè®® |

### 14.2 APIè°ƒç”¨é“¾è·¯åˆ†æ

#### 14.2.1 å¯¹è¯å®Œæˆè°ƒç”¨é“¾

```text
ç”¨æˆ·å¯¹è¯è¯·æ±‚è°ƒç”¨é“¾:
1. å‰ç«¯å‘èµ·è¯·æ±‚ â†’ /api/v1/chat/completions
2. APIç½‘å…³æ¥æ”¶ â†’ èº«ä»½éªŒè¯ä¸­é—´ä»¶
3. è·¯ç”±åˆ°å¯¹è¯å¤„ç†å™¨ â†’ handler/chat.go
4. è°ƒç”¨ç®—æ³•æœåŠ¡ â†’ http://localhost:8000/query
5. RAGæ£€ç´¢å¤„ç† â†’ core/retrieve.py
6. å‘é‡æ•°æ®åº“æŸ¥è¯¢ â†’ Milvus:19530
7. å¤§æ¨¡å‹æ¨ç† â†’ è±†åŒ…API
8. æµå¼å“åº”è¿”å› â†’ SSE/WebSocket
```

#### 14.2.2 è¯­éŸ³å¤„ç†è°ƒç”¨é“¾

```text
è¯­éŸ³äº¤äº’è°ƒç”¨é“¾:
1. å‰ç«¯å»ºç«‹WebSocket â†’ /api/v1/voice/stream
2. è¯­éŸ³æ•°æ®ä¼ è¾“ â†’ handler/voice.go
3. è½¬å‘åˆ°è¯­éŸ³æœåŠ¡ â†’ http://localhost:8001/voice/stream
4. è¯­éŸ³è¯†åˆ«å¤„ç† â†’ core/voice.py
5. æ–‡æœ¬ç†è§£å¤„ç† â†’ core/retrieve.py
6. è¯­éŸ³åˆæˆå¤„ç† â†’ TTSå¼•æ“
7. éŸ³é¢‘æµè¿”å› â†’ WebSocket
```

#### 14.2.3 æœåŠ¡é›†æˆè°ƒç”¨é“¾

```text
ç¬¬ä¸‰æ–¹æœåŠ¡è°ƒç”¨é“¾:
1. æœåŠ¡æ³¨å†Œè¯·æ±‚ â†’ /api/v1/integrations/services
2. æœåŠ¡é…ç½®éªŒè¯ â†’ handler/integration.go
3. æœåŠ¡è°ƒç”¨è¯·æ±‚ â†’ /api/v1/integrations/services/{id}/call
4. MCPåè®®è½¬æ¢ â†’ pkg/integration
5. ç¬¬ä¸‰æ–¹APIè°ƒç”¨ â†’ å¤–éƒ¨æœåŠ¡
6. å“åº”æ•°æ®å¤„ç† â†’ ç»“æœè¿”å›
```

### 14.3 ç³»ç»Ÿäº¤äº’æ—¶åºå›¾

#### 14.3.1 ç”¨æˆ·å¯¹è¯å®Œæ•´æ—¶åºå›¾

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as å‰ç«¯åº”ç”¨
    participant G as APIç½‘å…³
    participant C as å¯¹è¯æœåŠ¡
    participant A as ç®—æ³•æœåŠ¡
    participant V as å‘é‡æ•°æ®åº“
    participant L as å¤§æ¨¡å‹API
    participant R as Redisç¼“å­˜

    U->>F: å‘é€æ¶ˆæ¯
    F->>G: POST /api/v1/chat/completions
    G->>G: èº«ä»½éªŒè¯
    G->>C: è½¬å‘è¯·æ±‚
    C->>R: æ£€æŸ¥ç¼“å­˜
    alt ç¼“å­˜å‘½ä¸­
        R-->>C: è¿”å›ç¼“å­˜ç»“æœ
        C-->>F: æµå¼å“åº”
    else ç¼“å­˜æœªå‘½ä¸­
        C->>A: POST /query
        A->>V: å‘é‡æ£€ç´¢
        V-->>A: ç›¸å…³æ–‡æ¡£
        A->>L: å¤§æ¨¡å‹æ¨ç†
        L-->>A: ç”Ÿæˆå›ç­”
        A-->>C: æµå¼å“åº”
        C->>R: æ›´æ–°ç¼“å­˜
        C-->>F: æµå¼å“åº”
    end
    F-->>U: æ˜¾ç¤ºå›ç­”
```

#### 14.3.2 è¯­éŸ³äº¤äº’æ—¶åºå›¾

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as å‰ç«¯åº”ç”¨
    participant G as APIç½‘å…³
    participant V as è¯­éŸ³æœåŠ¡
    participant A as ç®—æ³•æœåŠ¡
    participant T as TTSå¼•æ“

    U->>F: å¼€å§‹è¯­éŸ³è¾“å…¥
    F->>G: WebSocketè¿æ¥ /api/v1/voice/stream
    G->>V: å»ºç«‹è¯­éŸ³ä¼šè¯
    
    loop è¯­éŸ³æµå¤„ç†
        U->>F: è¯­éŸ³æ•°æ®
        F->>V: éŸ³é¢‘æµ
        V->>V: å®æ—¶è½¬å½•
        V-->>F: è½¬å½•æ–‡æœ¬
    end
    
    U->>F: ç»“æŸè¯­éŸ³è¾“å…¥
    V->>A: æ–‡æœ¬ç†è§£è¯·æ±‚
    A->>A: RAGå¤„ç†
    A-->>V: ç†è§£ç»“æœ
    V->>T: è¯­éŸ³åˆæˆè¯·æ±‚
    T-->>V: éŸ³é¢‘æ•°æ®
    V-->>F: éŸ³é¢‘æµ
    F-->>U: æ’­æ”¾è¯­éŸ³å›ç­”
```

#### 14.3.3 æœåŠ¡é›†æˆæ—¶åºå›¾

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as å‰ç«¯åº”ç”¨
    participant G as APIç½‘å…³
    participant I as é›†æˆæœåŠ¡
    participant M as MCPåè®®
    participant E as å¤–éƒ¨æœåŠ¡

    U->>F: è°ƒç”¨ç¬¬ä¸‰æ–¹æœåŠ¡
    F->>G: POST /api/v1/integrations/services/{id}/call
    G->>I: æœåŠ¡è°ƒç”¨è¯·æ±‚
    I->>I: å‚æ•°éªŒè¯
    I->>M: MCPåè®®è½¬æ¢
    M->>E: å¤–éƒ¨APIè°ƒç”¨
    E-->>M: æœåŠ¡å“åº”
    M-->>I: åè®®è½¬æ¢
    I-->>G: æ ‡å‡†åŒ–å“åº”
    G-->>F: è¿”å›ç»“æœ
    F-->>U: æ˜¾ç¤ºç»“æœ
```

#### 14.3.4 æ–‡æ¡£å…¥åº“æ—¶åºå›¾

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as å‰ç«¯åº”ç”¨
    participant G as APIç½‘å…³
    participant A as ç®—æ³•æœåŠ¡
    participant V as å‘é‡æ•°æ®åº“
    participant P as PostgreSQL
    participant Q as ä»»åŠ¡é˜Ÿåˆ—

    U->>F: ä¸Šä¼ æ–‡æ¡£
    F->>G: POST /api/ingest/upload
    G->>A: æ–‡æ¡£å…¥åº“è¯·æ±‚
    A->>Q: åˆ›å»ºåå°ä»»åŠ¡
    A-->>F: è¿”å›ä»»åŠ¡ID
    
    par åå°å¤„ç†
        Q->>A: å¤„ç†å…¥åº“ä»»åŠ¡
        A->>A: æ–‡æ¡£è§£æ
        A->>A: æ–‡æœ¬åˆ‡åˆ†
        A->>A: å‘é‡åŒ–
        A->>V: å­˜å‚¨å‘é‡
        A->>P: å­˜å‚¨å…ƒæ•°æ®
        A->>Q: æ›´æ–°ä»»åŠ¡çŠ¶æ€
    end
    
    F->>G: GET /tasks/{task_id}
    G->>A: æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
    A-->>F: è¿”å›å¤„ç†è¿›åº¦
```

### 14.4 å…³é”®APIæ€§èƒ½æŒ‡æ ‡

#### 14.4.1 å“åº”æ—¶é—´æŒ‡æ ‡

| APIç±»å‹ | å¹³å‡å“åº”æ—¶é—´ | P95å“åº”æ—¶é—´ | P99å“åº”æ—¶é—´ |
|---------|-------------|-------------|-------------|
| å¯¹è¯å®Œæˆ | 400ms | 800ms | 1.2s |
| è¯­éŸ³è½¬å½• | 150ms | 300ms | 500ms |
| è¯­éŸ³åˆæˆ | 200ms | 400ms | 600ms |
| æ–‡æ¡£æ£€ç´¢ | 50ms | 100ms | 200ms |
| æœåŠ¡è°ƒç”¨ | 300ms | 600ms | 1s |

#### 14.4.2 å¹¶å‘å¤„ç†èƒ½åŠ›

| æœåŠ¡æ¨¡å— | æœ€å¤§QPS | å¹¶å‘è¿æ¥æ•° | å†…å­˜ä½¿ç”¨ |
|---------|---------|-----------|----------|
| APIç½‘å…³ | 1000+ | 10000+ | 512MB |
| ç®—æ³•æœåŠ¡ | 500+ | 1000+ | 2GB |
| è¯­éŸ³æœåŠ¡ | 200+ | 500+ | 1GB |
| æ•°æ®åº“ | 2000+ | 200+ | 4GB |

---

**æœ€åæ›´æ–°**: 2024-12-21  
**ä½œè€…**: VoiceHelper Team  
**å½“å‰ç‰ˆæœ¬**: v1.9.0ï¼ˆå·²å®Œæˆï¼‰  
**ä¸‹ä¸€ç‰ˆæœ¬**: v2.0.0ä¼ä¸šå®Œå–„ç‰ˆï¼ˆé¢„è®¡2025-12-01ï¼‰
