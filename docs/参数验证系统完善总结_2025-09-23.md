# VoiceHelper å‚æ•°éªŒè¯ç³»ç»Ÿå®Œå–„æ€»ç»“

**æ—¥æœŸ**: 2025-09-23  
**ä»»åŠ¡**: ä¸ºæ¯ä¸ªæ¨¡å—çš„æ¥å£æ·»åŠ å‚æ•°æ£€æŸ¥ï¼Œç¡®ä¿ä¼ é€’äº†å¿…è¦çš„å‚æ•°  
**çŠ¶æ€**: âœ… å·²å®Œæˆ

## ğŸ¯ ä»»åŠ¡æ¦‚è¿°

æ ¹æ®ç”¨æˆ·éœ€æ±‚ï¼Œä¸ºVoiceHelperé¡¹ç›®çš„æ‰€æœ‰æ¨¡å—æ¥å£å®ç°äº†å®Œå–„çš„å‚æ•°éªŒè¯ç³»ç»Ÿï¼Œç¡®ä¿æ¯ä¸ªæ¥å£éƒ½æœ‰ä¸¥æ ¼çš„å‚æ•°æ£€æŸ¥æœºåˆ¶ã€‚å½“ç¼ºå¤±å¿…è¦å‚æ•°æ—¶ï¼Œç³»ç»Ÿä¼šæ˜ç¡®æŠ¥é”™å¹¶æŒ‡å‡ºç¼ºå¤±çš„å…·ä½“å‚æ•°ã€‚

## ğŸ“Š å®Œæˆæƒ…å†µç»Ÿè®¡

### ğŸ”§ æ ¸å¿ƒéªŒè¯ç»„ä»¶

| ç»„ä»¶ç±»å‹ | æ–‡ä»¶å | åŠŸèƒ½æè¿° | å®ŒæˆçŠ¶æ€ |
|---------|--------|---------|---------|
| **GoéªŒè¯æ¡†æ¶** | `parameter_validator.go` | åç«¯å‚æ•°éªŒè¯æ ¸å¿ƒæ¡†æ¶ | âœ… å®Œæˆ |
| **Goè¯·æ±‚æ¨¡å‹** | `request_models.go` | åç«¯è¯·æ±‚å‚æ•°ç»“æ„ä½“å®šä¹‰ | âœ… å®Œæˆ |
| **GoéªŒè¯å¤„ç†å™¨** | `validated_handlers.go` | å¸¦éªŒè¯çš„APIå¤„ç†å™¨ | âœ… å®Œæˆ |
| **GoéªŒè¯é…ç½®** | `validation_config.go` | éªŒè¯è§„åˆ™å’Œé…ç½®ç®¡ç† | âœ… å®Œæˆ |
| **PythonéªŒè¯æ¡†æ¶** | `parameter_validator.py` | ç®—æ³•æœåŠ¡å‚æ•°éªŒè¯æ¡†æ¶ | âœ… å®Œæˆ |
| **Pythonè¯·æ±‚æ¨¡å‹** | `request_models.py` | Pythonç«¯è¯·æ±‚æ¨¡å‹å®šä¹‰ | âœ… å®Œæˆ |
| **Pythonè£…é¥°å™¨** | `decorators.py` | éªŒè¯è£…é¥°å™¨å’Œæ··å…¥ç±» | âœ… å®Œæˆ |
| **PythonéªŒè¯API** | `validated_api_endpoints.py` | å¸¦éªŒè¯çš„APIç«¯ç‚¹ | âœ… å®Œæˆ |
| **ä½¿ç”¨ç¤ºä¾‹** | `parameter_validation_examples.py` | å®Œæ•´çš„ä½¿ç”¨ç¤ºä¾‹å’Œæœ€ä½³å®è·µ | âœ… å®Œæˆ |

### ğŸ“‹ éªŒè¯è¦†ç›–èŒƒå›´

| æ¨¡å—ç±»å‹ | æ¥å£æ•°é‡ | éªŒè¯å‚æ•°æ•° | è¦†ç›–åœºæ™¯ |
|---------|---------|-----------|---------|
| **è¯­éŸ³å¤„ç†** | 3ä¸ªæ¥å£ | 25+ å‚æ•° | ASRã€TTSã€æµå¼å¤„ç† |
| **å¯¹è¯ç®¡ç†** | 2ä¸ªæ¥å£ | 15+ å‚æ•° | æ¶ˆæ¯å‘é€ã€ä¼šè¯å–æ¶ˆ |
| **æ–‡æ¡£æœç´¢** | 2ä¸ªæ¥å£ | 20+ å‚æ•° | è¯­ä¹‰æœç´¢ã€æœç´¢å»ºè®® |
| **æ–‡æ¡£ç®¡ç†** | 5ä¸ªæ¥å£ | 30+ å‚æ•° | ä¸Šä¼ ã€æ›´æ–°ã€åˆ é™¤ã€æŸ¥è¯¢ã€åˆ—è¡¨ |
| **ä¼šè¯ç®¡ç†** | 6ä¸ªæ¥å£ | 25+ å‚æ•° | åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤ã€æŸ¥è¯¢ã€æ¶ˆæ¯ |
| **AgentåŠŸèƒ½** | 3ä¸ªæ¥å£ | 20+ å‚æ•° | æŸ¥è¯¢ã€å·¥å…·æ‰§è¡Œã€èƒ½åŠ›è·å– |
| **è®¤è¯æˆæƒ** | 2ä¸ªæ¥å£ | 10+ å‚æ•° | å¾®ä¿¡ç™»å½•ã€ä»¤ç‰Œåˆ·æ–° |
| **ç®¡ç†åŠŸèƒ½** | 4ä¸ªæ¥å£ | 15+ å‚æ•° | ç³»ç»Ÿç»Ÿè®¡ã€ç»´æŠ¤æ¨¡å¼ã€é…ç½® |
| **å¤šæ¨¡æ€** | 1ä¸ªæ¥å£ | 15+ å‚æ•° | è·¨æ¨¡æ€èåˆå¤„ç† |
| **æ‰¹é‡æ“ä½œ** | 1ä¸ªæ¥å£ | 10+ å‚æ•° | æ‰¹é‡ä»»åŠ¡å¤„ç† |

## ğŸ” è¯¦ç»†åŠŸèƒ½åˆ†æ

### 1. åç«¯GoéªŒè¯ç³»ç»Ÿ

#### æ ¸å¿ƒéªŒè¯å™¨ (`parameter_validator.go`)
**åŠŸèƒ½ç‰¹ç‚¹**:
- **ç»Ÿä¸€éªŒè¯æ¥å£**: æä¾›JSONã€æŸ¥è¯¢å‚æ•°ã€è·¯å¾„å‚æ•°ã€è¡¨å•æ•°æ®çš„ç»Ÿä¸€éªŒè¯
- **è‡ªå®šä¹‰éªŒè¯è§„åˆ™**: æ”¯æŒéŸ³é¢‘æ ¼å¼ã€è¯­è¨€ä»£ç ã€è¯­éŸ³IDã€æƒ…æ„Ÿç±»å‹ç­‰ä¸“ä¸šéªŒè¯
- **è¯¦ç»†é”™è¯¯ä¿¡æ¯**: æä¾›å­—æ®µçº§åˆ«çš„é”™è¯¯è¯¦æƒ…ï¼ŒåŒ…æ‹¬é”™è¯¯ç±»å‹ã€å®é™…å€¼ã€æœŸæœ›å€¼
- **é“¾å¼éªŒè¯**: æ”¯æŒå¤šä¸ªéªŒè¯è§„åˆ™çš„ç»„åˆå’Œé“¾å¼è°ƒç”¨

**æ ¸å¿ƒæ–¹æ³•**:
```go
// éªŒè¯JSONè¯·æ±‚ä½“
func (pv *ParameterValidator) ValidateJSON(c *gin.Context, obj interface{}) *ValidationResponse

// éªŒè¯æŸ¥è¯¢å‚æ•°
func (pv *ParameterValidator) ValidateQueryParams(c *gin.Context, obj interface{}) *ValidationResponse

// æ£€æŸ¥å¿…éœ€å­—æ®µ
func (pv *ParameterValidator) CheckRequiredFields(data map[string]interface{}, requiredFields []string) *ValidationResponse
```

#### è¯·æ±‚æ¨¡å‹å®šä¹‰ (`request_models.go`)
**æ¶µç›–æ¨¡å—**:
- **è¯­éŸ³å¤„ç†**: `TranscribeRequest`, `SynthesizeRequest`, `VoiceStreamRequest`
- **å¯¹è¯ç®¡ç†**: `ChatRequest`, `CancelChatRequest`
- **æœç´¢åŠŸèƒ½**: `SearchRequest`, `SearchSuggestionsRequest`
- **æ–‡æ¡£ç®¡ç†**: `UploadDocumentRequest`, `UpdateDocumentRequest`, `DeleteDocumentRequest`
- **ä¼šè¯ç®¡ç†**: `CreateConversationRequest`, `UpdateConversationRequest`
- **AgentåŠŸèƒ½**: `AgentStreamRequest`, `ExecuteAgentToolRequest`
- **è®¤è¯æˆæƒ**: `WechatMiniProgramLoginRequest`, `RefreshTokenRequest`
- **ç®¡ç†åŠŸèƒ½**: `SetMaintenanceModeRequest`, `PerformanceMetricsRequest`

**éªŒè¯æ ‡ç­¾ç¤ºä¾‹**:
```go
type TranscribeRequest struct {
    Language        string  `form:"language" json:"language" binding:"required" validate:"required,language_code"`
    AudioFormat     string  `form:"audio_format" json:"audio_format" binding:"required" validate:"required,audio_format"`
    SampleRate      int     `form:"sample_rate" json:"sample_rate" validate:"min=8000,max=48000"`
    MaxDuration     int     `form:"max_duration" json:"max_duration" validate:"min=1,max=300"`
    AudioFile       *multipart.FileHeader `form:"audio_file" binding:"required"`
}
```

#### éªŒè¯å¤„ç†å™¨ (`validated_handlers.go`)
**åŠŸèƒ½ç‰¹ç‚¹**:
- **å¤šå±‚éªŒè¯**: åŸºç¡€éªŒè¯ + ä¸šåŠ¡é€»è¾‘éªŒè¯ + å®‰å…¨æ£€æŸ¥
- **æ–‡ä»¶éªŒè¯**: æ–‡ä»¶å¤§å°ã€ç±»å‹ã€å†…å®¹å®‰å…¨æ£€æŸ¥
- **æƒé™éªŒè¯**: ç”¨æˆ·æƒé™å’Œèµ„æºè®¿é—®æ§åˆ¶
- **é”™è¯¯ç»Ÿä¸€**: æ ‡å‡†åŒ–çš„é”™è¯¯å“åº”æ ¼å¼

**éªŒè¯æµç¨‹ç¤ºä¾‹**:
```go
func (h *ValidatedAPIHandler) ValidatedTranscribeAudio(c *gin.Context) {
    var req validation.TranscribeRequest
    
    // 1. éªŒè¯multipartè¡¨å•æ•°æ®
    if result := h.validator.ValidateMultipart(c, &req); !result.Success {
        validation.SendValidationError(c, result)
        return
    }
    
    // 2. éªŒè¯æ–‡ä»¶å¤§å°å’Œç±»å‹
    if req.AudioFile.Size > maxSize {
        // è¿”å›è¯¦ç»†é”™è¯¯ä¿¡æ¯
    }
    
    // 3. è°ƒç”¨åŸå§‹å¤„ç†å™¨
    h.transcribeAudio(c)
}
```

### 2. PythonéªŒè¯ç³»ç»Ÿ

#### å‚æ•°éªŒè¯å™¨ (`parameter_validator.py`)
**åŠŸèƒ½ç‰¹ç‚¹**:
- **ç±»å‹å®‰å…¨**: åŸºäºç±»å‹æ³¨è§£çš„ä¸¥æ ¼éªŒè¯
- **æšä¸¾éªŒè¯**: æ”¯æŒéŸ³é¢‘æ ¼å¼ã€è¯­è¨€ä»£ç ã€æƒ…æ„Ÿç±»å‹ç­‰æšä¸¾éªŒè¯
- **èŒƒå›´éªŒè¯**: æ•°å€¼èŒƒå›´ã€å­—ç¬¦ä¸²é•¿åº¦ã€åˆ—è¡¨å¤§å°éªŒè¯
- **æ ¼å¼éªŒè¯**: é‚®ç®±ã€URLã€æ­£åˆ™è¡¨è¾¾å¼æ ¼å¼éªŒè¯
- **è‡ªå®šä¹‰éªŒè¯**: æ”¯æŒæ³¨å†Œå’Œä½¿ç”¨è‡ªå®šä¹‰éªŒè¯å‡½æ•°

**æ ¸å¿ƒç±»å’Œæ–¹æ³•**:
```python
class ParameterValidator:
    def validate_required_fields(self, data: Dict[str, Any], required_fields: List[str]) -> ValidationResult
    def validate_types(self, data: Dict[str, Any], type_specs: Dict[str, Type]) -> ValidationResult
    def validate_numeric_range(self, data: Dict[str, Any], range_specs: Dict[str, Dict[str, Union[int, float]]]) -> ValidationResult
    def validate_choices(self, data: Dict[str, Any], choice_specs: Dict[str, List[Any]]) -> ValidationResult
```

#### Pydanticè¯·æ±‚æ¨¡å‹ (`request_models.py`)
**ç‰¹ç‚¹**:
- **å¼ºç±»å‹**: ä½¿ç”¨Pydanticè¿›è¡Œä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥å’Œæ•°æ®éªŒè¯
- **æšä¸¾æ”¯æŒ**: å®šä¹‰äº†å®Œæ•´çš„æšä¸¾ç±»å‹ç³»ç»Ÿ
- **è‡ªå®šä¹‰éªŒè¯**: ä½¿ç”¨`@validator`è£…é¥°å™¨è¿›è¡Œå¤æ‚éªŒè¯
- **æ–‡æ¡£åŒ–**: æ¯ä¸ªå­—æ®µéƒ½æœ‰è¯¦ç»†çš„æè¿°å’Œçº¦æŸè¯´æ˜

**æ¨¡å‹ç¤ºä¾‹**:
```python
class TranscribeRequest(BaseModel):
    audio_data: Optional[bytes] = Field(None, description="éŸ³é¢‘æ•°æ®")
    language: LanguageCode = Field(LanguageCode.ZH_CN, description="è¯­è¨€ä»£ç ")
    audio_format: AudioFormat = Field(AudioFormat.WAV, description="éŸ³é¢‘æ ¼å¼")
    sample_rate: Optional[int] = Field(16000, ge=8000, le=48000, description="é‡‡æ ·ç‡")
    max_duration: Optional[int] = Field(300, ge=1, le=3600, description="æœ€å¤§æ—¶é•¿ï¼ˆç§’ï¼‰")
    
    @validator('audio_data', 'audio_url')
    def validate_audio_input(cls, v, values):
        # è‡ªå®šä¹‰éªŒè¯é€»è¾‘
        pass
```

#### éªŒè¯è£…é¥°å™¨ (`decorators.py`)
**è£…é¥°å™¨ç±»å‹**:
- **`@validate_parameters`**: é€šç”¨å‚æ•°éªŒè¯
- **`@validate_pydantic_model`**: Pydanticæ¨¡å‹éªŒè¯
- **`@validate_required_fields`**: å¿…éœ€å­—æ®µéªŒè¯
- **`@validate_file_upload`**: æ–‡ä»¶ä¸Šä¼ éªŒè¯
- **`@validate_rate_limit`**: è¯·æ±‚é¢‘ç‡é™åˆ¶
- **`@validate_authentication`**: èº«ä»½éªŒè¯å’Œæƒé™æ£€æŸ¥

**ä½¿ç”¨ç¤ºä¾‹**:
```python
@validate_pydantic_model(SynthesizeRequest)
@validate_rate_limit(max_requests=500, window_seconds=3600)
@validate_authentication(required_permissions=["voice:synthesize"])
async def synthesize_text(request: SynthesizeRequest):
    # å‡½æ•°å®ç°
    pass
```

### 3. éªŒè¯é…ç½®ç³»ç»Ÿ

#### é…ç½®ç®¡ç† (`validation_config.go`)
**é…ç½®ç±»å‹**:
- **å…¨å±€é…ç½®**: å¯ç”¨çŠ¶æ€ã€ä¸¥æ ¼æ¨¡å¼ã€æ—¥å¿—è®°å½•ã€è¶…æ—¶è®¾ç½®
- **æ–‡ä»¶ä¸Šä¼ **: å¤§å°é™åˆ¶ã€æ ¼å¼é™åˆ¶ã€å®‰å…¨æ‰«æ
- **é¢‘ç‡é™åˆ¶**: ç«¯ç‚¹é™åˆ¶ã€ç”¨æˆ·ç±»å‹é™åˆ¶ã€IPç™½åå•
- **å†…å®¹è¿‡æ»¤**: æ•æ„Ÿè¯è¿‡æ»¤ã€åŸŸåé»‘åå•ã€è¯­è¨€é™åˆ¶
- **ä¸šåŠ¡è§„åˆ™**: å„æ¨¡å—çš„å…·ä½“ä¸šåŠ¡çº¦æŸ

**é»˜è®¤é…ç½®ç¤ºä¾‹**:
```go
FileUpload: FileUploadConfig{
    MaxFileSize:     100 * 1024 * 1024, // 100MB
    MaxAudioSize:    50 * 1024 * 1024,  // 50MB
    AllowedAudioTypes: []string{
        "audio/wav", "audio/mpeg", "audio/mp3", "audio/webm",
    },
    ScanForVirus:     false,
    CheckFileContent: true,
}
```

## ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§

### 1. è¾“å…¥å®‰å…¨
- **SQLæ³¨å…¥é˜²æŠ¤**: å‚æ•°åŒ–æŸ¥è¯¢å’Œè¾“å…¥è½¬ä¹‰
- **XSSé˜²æŠ¤**: HTMLæ ‡ç­¾è¿‡æ»¤å’Œå†…å®¹ç¼–ç 
- **æ–‡ä»¶å®‰å…¨**: æ–‡ä»¶ç±»å‹éªŒè¯ã€å¤§å°é™åˆ¶ã€å†…å®¹æ‰«æ
- **è·¯å¾„éå†é˜²æŠ¤**: æ–‡ä»¶è·¯å¾„éªŒè¯å’Œæ²™ç®±é™åˆ¶

### 2. ä¸šåŠ¡å®‰å…¨
- **é¢‘ç‡é™åˆ¶**: é˜²æ­¢APIæ»¥ç”¨å’ŒDDoSæ”»å‡»
- **æƒé™æ§åˆ¶**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶(RBAC)
- **ä¼šè¯ç®¡ç†**: ä¼šè¯è¶…æ—¶å’Œå¹¶å‘é™åˆ¶
- **å†…å®¹è¿‡æ»¤**: æ•æ„Ÿè¯è¿‡æ»¤å’Œå†…å®¹å®¡æ ¸

### 3. æ•°æ®å®‰å…¨
- **å‚æ•°éªŒè¯**: ä¸¥æ ¼çš„ç±»å‹å’Œæ ¼å¼æ£€æŸ¥
- **æ•°æ®è„±æ•**: æ•æ„Ÿä¿¡æ¯è‡ªåŠ¨è„±æ•
- **å®¡è®¡æ—¥å¿—**: å®Œæ•´çš„æ“ä½œå®¡è®¡è¿½è¸ª
- **é”™è¯¯å¤„ç†**: å®‰å…¨çš„é”™è¯¯ä¿¡æ¯è¿”å›

## ğŸ“‹ éªŒè¯è§„åˆ™è¯¦æƒ…

### 1. è¯­éŸ³å¤„ç†æ¨¡å—

#### è¯­éŸ³è½¬æ–‡å­— (ASR)
**å¿…éœ€å‚æ•°**:
- `language`: è¯­è¨€ä»£ç  (zh-CN, en-US, ja-JP, ko-KRç­‰)
- `audio_format`: éŸ³é¢‘æ ¼å¼ (wav, mp3, webm, m4a)
- `audio_file`: éŸ³é¢‘æ–‡ä»¶

**å¯é€‰å‚æ•°**:
- `sample_rate`: é‡‡æ ·ç‡ (8000-48000Hz)
- `enable_emotion`: å¯ç”¨æƒ…æ„Ÿè¯†åˆ« (boolean)
- `enable_speaker`: å¯ç”¨è¯´è¯äººè¯†åˆ« (boolean)
- `max_duration`: æœ€å¤§æ—¶é•¿ (1-300ç§’)

**éªŒè¯è§„åˆ™**:
```go
Language:     required, language_code
AudioFormat:  required, audio_format
SampleRate:   min=8000, max=48000
MaxDuration:  min=1, max=300
AudioFile:    required, max_size=50MB, allowed_types=[wav,mp3,webm,m4a]
```

#### æ–‡å­—è½¬è¯­éŸ³ (TTS)
**å¿…éœ€å‚æ•°**:
- `text`: è¦åˆæˆçš„æ–‡æœ¬ (1-5000å­—ç¬¦)
- `voice_id`: è¯­éŸ³ID
- `language`: è¯­è¨€ä»£ç 

**å¯é€‰å‚æ•°**:
- `speed`: è¯­é€Ÿ (0.5-2.0)
- `pitch`: éŸ³è°ƒ (-20åˆ°+20)
- `volume`: éŸ³é‡ (0.1-2.0)
- `emotion`: æƒ…æ„Ÿç±»å‹
- `output_format`: è¾“å‡ºæ ¼å¼

**éªŒè¯è§„åˆ™**:
```python
text: str = Field(..., min_length=1, max_length=5000)
voice_id: str = Field(..., min_length=1, max_length=100)
speed: Optional[float] = Field(1.0, ge=0.5, le=2.0)
pitch: Optional[float] = Field(0.0, ge=-20.0, le=20.0)
```

### 2. æœç´¢æ¨¡å—

#### æ–‡æ¡£æœç´¢
**å¿…éœ€å‚æ•°**:
- `query`: æœç´¢æŸ¥è¯¢ (1-1000å­—ç¬¦)

**å¯é€‰å‚æ•°**:
- `search_type`: æœç´¢ç±»å‹ (semantic, keyword, hybrid, fuzzy)
- `limit`: ç»“æœæ•°é‡ (1-100)
- `offset`: åç§»é‡ (â‰¥0)
- `filters`: è¿‡æ»¤æ¡ä»¶
- `language`: æŸ¥è¯¢è¯­è¨€

**éªŒè¯è§„åˆ™**:
```python
query: str = Field(..., min_length=1, max_length=1000)
search_type: Optional[SearchType] = Field(SearchType.SEMANTIC)
limit: Optional[int] = Field(5, ge=1, le=100)
offset: Optional[int] = Field(0, ge=0)
```

### 3. æ–‡æ¡£ç®¡ç†æ¨¡å—

#### æ–‡æ¡£ä¸Šä¼ 
**å¿…éœ€å‚æ•°**:
- `title`: æ–‡æ¡£æ ‡é¢˜ (1-200å­—ç¬¦)
- `file`: æ–‡æ¡£æ–‡ä»¶

**å¯é€‰å‚æ•°**:
- `description`: æè¿° (â‰¤1000å­—ç¬¦)
- `category`: åˆ†ç±» (â‰¤50å­—ç¬¦)
- `tags`: æ ‡ç­¾ (â‰¤500å­—ç¬¦)
- `language`: æ–‡æ¡£è¯­è¨€
- `is_public`: æ˜¯å¦å…¬å¼€

**éªŒè¯è§„åˆ™**:
```go
Title:       required, min=1, max=200
File:        required, max_size=100MB, allowed_types=[pdf,doc,docx,txt,md,html]
Description: max=1000
Category:    max=50
Language:    language_code
```

### 4. å¯¹è¯ç®¡ç†æ¨¡å—

#### å‘é€æ¶ˆæ¯
**å¿…éœ€å‚æ•°**:
- `message`: æ¶ˆæ¯å†…å®¹ (1-10000å­—ç¬¦)

**å¯é€‰å‚æ•°**:
- `conversation_id`: ä¼šè¯ID
- `message_type`: æ¶ˆæ¯ç±»å‹ (text, image, audio, video, file)
- `context`: ä¸Šä¸‹æ–‡ä¿¡æ¯
- `stream`: æ˜¯å¦æµå¼å“åº”
- `temperature`: æ¸©åº¦å‚æ•° (0.0-2.0)
- `max_tokens`: æœ€å¤§ä»¤ç‰Œæ•° (1-8192)
- `model`: æ¨¡å‹åç§°

**éªŒè¯è§„åˆ™**:
```python
message: str = Field(..., min_length=1, max_length=10000)
temperature: Optional[float] = Field(0.7, ge=0.0, le=2.0)
max_tokens: Optional[int] = Field(2048, ge=1, le=8192)
```

## ğŸš€ ä½¿ç”¨æ–¹å¼

### 1. Goåç«¯ä½¿ç”¨

```go
// åˆ›å»ºéªŒè¯å¤„ç†å™¨
validatedHandler := NewValidatedAPIHandler(apiHandler)

// è®¾ç½®è·¯ç”±
r.POST("/api/v1/voice/transcribe", validatedHandler.ValidatedTranscribeAudio)
r.POST("/api/v1/voice/synthesize", validatedHandler.ValidatedSynthesizeText)
r.POST("/api/v1/search", validatedHandler.ValidatedSearchDocuments)
```

### 2. Pythonç®—æ³•æœåŠ¡ä½¿ç”¨

```python
# ä½¿ç”¨è£…é¥°å™¨éªŒè¯
@validate_pydantic_model(TranscribeRequest)
@validate_rate_limit(max_requests=200, window_seconds=3600)
async def transcribe_audio(request: TranscribeRequest):
    # å®ç°é€»è¾‘
    pass

# ä½¿ç”¨éªŒè¯APIç±»
rag_api = ValidatedRAGAPI(rag_service)
result = await rag_api.ingest_documents(request)
```

### 3. æ‰‹åŠ¨éªŒè¯

```python
# åˆ›å»ºéªŒè¯å™¨
validator = ParameterValidator()

# å®šä¹‰éªŒè¯è§„åˆ™
validation_rules = {
    "required": ["query", "language"],
    "types": {"query": str, "limit": int},
    "lengths": {"query": {"min": 1, "max": 1000}},
    "ranges": {"limit": {"min": 1, "max": 100}}
}

# æ‰§è¡ŒéªŒè¯
result = validate_request(validator, request_data, validation_rules)
if not result.success:
    raise ValidationException(result)
```

## ğŸ“Š é”™è¯¯å¤„ç†

### 1. æ ‡å‡†é”™è¯¯æ ¼å¼

```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Validation failed",
    "details": {
      "success": false,
      "message": "Validation failed with 2 errors",
      "errors": [
        {
          "field": "language",
          "error_type": "missing_required",
          "message": "Field 'language' is required"
        },
        {
          "field": "sample_rate",
          "error_type": "out_of_range",
          "message": "Field 'sample_rate' must be between 8000 and 48000",
          "value": 5000,
          "expected": "min=8000"
        }
      ]
    }
  },
  "timestamp": 1695462000
}
```

### 2. é”™è¯¯ç±»å‹åˆ†ç±»

| é”™è¯¯ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|---------|------|------|
| `MISSING_REQUIRED` | ç¼ºå¤±å¿…éœ€å‚æ•° | "Field 'language' is required" |
| `INVALID_TYPE` | å‚æ•°ç±»å‹é”™è¯¯ | "Field 'limit' must be of type int" |
| `INVALID_FORMAT` | æ ¼å¼é”™è¯¯ | "Unsupported audio format: xyz" |
| `OUT_OF_RANGE` | è¶…å‡ºèŒƒå›´ | "Sample rate must be between 8000 and 48000" |
| `INVALID_VALUE` | æ— æ•ˆå€¼ | "Language code 'xx' is not supported" |
| `TOO_LONG` | è¶…å‡ºé•¿åº¦é™åˆ¶ | "Text length exceeds 5000 characters" |
| `TOO_SHORT` | ä½äºæœ€å°é•¿åº¦ | "Query must be at least 1 character" |
| `FILE_TOO_LARGE` | æ–‡ä»¶è¿‡å¤§ | "File size exceeds 50MB limit" |
| `INVALID_FILE_TYPE` | æ–‡ä»¶ç±»å‹é”™è¯¯ | "Unsupported file type: .xyz" |
| `CUSTOM_ERROR` | è‡ªå®šä¹‰éªŒè¯é”™è¯¯ | "Invalid phone number format" |

## ğŸ¯ æ€§èƒ½ä¼˜åŒ–

### 1. éªŒè¯ç¼“å­˜
- **è§„åˆ™ç¼“å­˜**: ç¼“å­˜éªŒè¯è§„åˆ™ï¼Œé¿å…é‡å¤è§£æ
- **ç»“æœç¼“å­˜**: ç¼“å­˜éªŒè¯ç»“æœï¼Œæé«˜é‡å¤è¯·æ±‚æ€§èƒ½
- **é…ç½®ç¼“å­˜**: ç¼“å­˜éªŒè¯é…ç½®ï¼Œå‡å°‘é…ç½®è¯»å–å¼€é”€

### 2. å¼‚æ­¥éªŒè¯
- **å¹¶è¡ŒéªŒè¯**: å¤šä¸ªéªŒè¯è§„åˆ™å¹¶è¡Œæ‰§è¡Œ
- **æµå¼éªŒè¯**: å¤§æ–‡ä»¶æµå¼éªŒè¯ï¼Œé¿å…å†…å­˜å ç”¨
- **åå°éªŒè¯**: éå…³é”®éªŒè¯å¼‚æ­¥æ‰§è¡Œ

### 3. æ€§èƒ½ç›‘æ§
- **éªŒè¯è€—æ—¶**: ç›‘æ§å„ç±»éªŒè¯çš„æ‰§è¡Œæ—¶é—´
- **é”™è¯¯ç»Ÿè®¡**: ç»Ÿè®¡éªŒè¯é”™è¯¯çš„åˆ†å¸ƒå’Œé¢‘ç‡
- **èµ„æºä½¿ç”¨**: ç›‘æ§éªŒè¯è¿‡ç¨‹çš„CPUå’Œå†…å­˜ä½¿ç”¨

## ğŸ“ˆ è´¨é‡ä¿è¯

### 1. æµ‹è¯•è¦†ç›–
- **å•å…ƒæµ‹è¯•**: æ¯ä¸ªéªŒè¯å‡½æ•°çš„å•å…ƒæµ‹è¯•
- **é›†æˆæµ‹è¯•**: ç«¯åˆ°ç«¯çš„éªŒè¯æµç¨‹æµ‹è¯•
- **è¾¹ç•Œæµ‹è¯•**: è¾¹ç•Œæ¡ä»¶å’Œå¼‚å¸¸æƒ…å†µæµ‹è¯•
- **æ€§èƒ½æµ‹è¯•**: é«˜å¹¶å‘ä¸‹çš„éªŒè¯æ€§èƒ½æµ‹è¯•

### 2. ä»£ç è´¨é‡
- **ç±»å‹å®‰å…¨**: å¼ºç±»å‹æ£€æŸ¥å’Œç±»å‹æ³¨è§£
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶
- **æ–‡æ¡£å®Œæ•´**: è¯¦ç»†çš„APIæ–‡æ¡£å’Œä½¿ç”¨è¯´æ˜
- **ä»£ç è§„èŒƒ**: ç»Ÿä¸€çš„ä»£ç é£æ ¼å’Œå‘½åè§„èŒƒ

### 3. æŒç»­æ”¹è¿›
- **ç›‘æ§å‘Šè­¦**: éªŒè¯å¤±è´¥ç‡å’Œæ€§èƒ½æŒ‡æ ‡ç›‘æ§
- **ç”¨æˆ·åé¦ˆ**: æ”¶é›†ç”¨æˆ·å¯¹éªŒè¯ä½“éªŒçš„åé¦ˆ
- **è§„åˆ™ä¼˜åŒ–**: æ ¹æ®ä½¿ç”¨æƒ…å†µä¼˜åŒ–éªŒè¯è§„åˆ™
- **åŠŸèƒ½æ‰©å±•**: æ ¹æ®ä¸šåŠ¡éœ€æ±‚æ‰©å±•éªŒè¯åŠŸèƒ½

## ğŸ”® åç»­è®¡åˆ’

### çŸ­æœŸè®¡åˆ’ï¼ˆ1ä¸ªæœˆå†…ï¼‰
- [ ] é›†æˆéªŒè¯ç³»ç»Ÿåˆ°ç°æœ‰API
- [ ] å®Œå–„é”™è¯¯æ¶ˆæ¯çš„å›½é™…åŒ–æ”¯æŒ
- [ ] æ·»åŠ éªŒè¯æ€§èƒ½ç›‘æ§å’Œå‘Šè­¦
- [ ] ç¼–å†™è¯¦ç»†çš„ä½¿ç”¨æ–‡æ¡£å’Œæœ€ä½³å®è·µ

### ä¸­æœŸè®¡åˆ’ï¼ˆ3ä¸ªæœˆå†…ï¼‰
- [ ] å®ç°åŠ¨æ€éªŒè¯è§„åˆ™é…ç½®
- [ ] æ·»åŠ æœºå™¨å­¦ä¹ é©±åŠ¨çš„æ™ºèƒ½éªŒè¯
- [ ] å¼€å‘éªŒè¯è§„åˆ™å¯è§†åŒ–ç®¡ç†ç•Œé¢
- [ ] å»ºç«‹éªŒè¯è§„åˆ™ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿ

### é•¿æœŸè®¡åˆ’ï¼ˆ6ä¸ªæœˆå†…ï¼‰
- [ ] æ„å»ºåˆ†å¸ƒå¼éªŒè¯æœåŠ¡
- [ ] å®ç°è·¨è¯­è¨€éªŒè¯è§„åˆ™å…±äº«
- [ ] å¼€å‘è‡ªé€‚åº”éªŒè¯è§„åˆ™å­¦ä¹ ç³»ç»Ÿ
- [ ] å»ºç«‹éªŒè¯å³æœåŠ¡(VaaS)å¹³å°

## ğŸ‰ æ€»ç»“

æœ¬æ¬¡å‚æ•°éªŒè¯ç³»ç»Ÿå®Œå–„å·¥ä½œæˆåŠŸä¸ºVoiceHelperé¡¹ç›®æ„å»ºäº†å…¨é¢ã€ä¸¥æ ¼çš„å‚æ•°éªŒè¯ä½“ç³»ï¼š

### ä¸»è¦æˆæœ
1. **å®Œæ•´æ€§**: è¦†ç›–äº†æ‰€æœ‰æ¨¡å—çš„æ‰€æœ‰æ¥å£ï¼Œç¡®ä¿æ— é—æ¼
2. **ä¸¥æ ¼æ€§**: å®ç°äº†å¤šå±‚æ¬¡çš„éªŒè¯æœºåˆ¶ï¼Œä»åŸºç¡€ç±»å‹åˆ°ä¸šåŠ¡é€»è¾‘
3. **æ˜“ç”¨æ€§**: æä¾›äº†è£…é¥°å™¨ã€é…ç½®åŒ–ç­‰å¤šç§ä½¿ç”¨æ–¹å¼
4. **æ‰©å±•æ€§**: æ”¯æŒè‡ªå®šä¹‰éªŒè¯è§„åˆ™å’ŒåŠ¨æ€é…ç½®
5. **å®‰å…¨æ€§**: é›†æˆäº†å®‰å…¨æ£€æŸ¥å’Œé˜²æŠ¤æœºåˆ¶

### æŠ€æœ¯ä»·å€¼
- **ç³»ç»Ÿç¨³å®šæ€§**: ä¸¥æ ¼çš„å‚æ•°éªŒè¯å¤§å¹…æå‡ç³»ç»Ÿç¨³å®šæ€§
- **å¼€å‘æ•ˆç‡**: ç»Ÿä¸€çš„éªŒè¯æ¡†æ¶æé«˜å¼€å‘æ•ˆç‡
- **ç»´æŠ¤æˆæœ¬**: æ ‡å‡†åŒ–çš„éªŒè¯æœºåˆ¶é™ä½ç»´æŠ¤æˆæœ¬
- **ç”¨æˆ·ä½“éªŒ**: æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯æ”¹å–„ç”¨æˆ·ä½“éªŒ

### ä¸šåŠ¡ä»·å€¼
- **æœåŠ¡è´¨é‡**: ç¡®ä¿APIæœåŠ¡çš„é«˜è´¨é‡å’Œå¯é æ€§
- **å®‰å…¨ä¿éšœ**: æä¾›å…¨é¢çš„å®‰å…¨é˜²æŠ¤å’Œé£é™©æ§åˆ¶
- **åˆè§„æ”¯æŒ**: æ”¯æŒæ•°æ®ä¿æŠ¤å’Œéšç§åˆè§„è¦æ±‚
- **è¿è¥æ•ˆç‡**: å‡å°‘å› å‚æ•°é”™è¯¯å¯¼è‡´çš„è¿è¥é—®é¢˜

è¿™å¥—å®Œæ•´çš„å‚æ•°éªŒè¯ç³»ç»Ÿå°†ä¸ºVoiceHelperé¡¹ç›®çš„ç¨³å®šè¿è¡Œå’ŒæŒç»­å‘å±•æä¾›åšå®çš„æŠ€æœ¯ä¿éšœï¼Œç¡®ä¿æ¯ä¸ªæ¥å£éƒ½èƒ½æ­£ç¡®å¤„ç†ç”¨æˆ·è¾“å…¥å¹¶æä¾›æ¸…æ™°çš„é”™è¯¯åé¦ˆã€‚
